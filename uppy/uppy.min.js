!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Uppy=t()}}(function(){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},r={limit:1,onStart:function(){},onProgress:function(){},onPartComplete:function(){},onSuccess:function(){},onError:function(t){throw t}};function n(t,e){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}var o=function(){function o(t,n){!function(t,e){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this.options=e({},r,n),this.file=t,this.key=this.options.key||null,this.uploadId=this.options.uploadId||null,this.parts=this.options.parts||[],this.isPaused=!1,this.chunks=null,this.chunkState=null,this.uploading=[],this._initChunks()}return o.prototype._initChunks=function(){for(var t=[],e=Math.max(Math.ceil(this.file.size/1e4),5242880),r=0;r<this.file.size;r+=e){var n=Math.min(this.file.size,r+e);t.push(this.file.slice(r,n))}this.chunks=t,this.chunkState=t.map(function(){return{uploaded:0,busy:!1,done:!1}})},o.prototype._createUpload=function(){var e=this;return Promise.resolve().then(function(){return e.options.createMultipartUpload()}).then(function(e){if("object"!==(void 0===e?"undefined":t(e))||!e||"string"!=typeof e.uploadId||"string"!=typeof e.key)throw new TypeError("AwsS3/Multipart: Got incorrect result from 'createMultipartUpload()', expected an object '{ uploadId, key }'.");return e}).then(function(t){e.key=t.key,e.uploadId=t.uploadId,e.options.onStart(t)}).then(function(){e._uploadParts()}).catch(function(t){e._onError(t)})},o.prototype._resumeUpload=function(){var t=this;return Promise.resolve().then(function(){return t.options.listParts({uploadId:t.uploadId,key:t.key})}).then(function(e){e.forEach(function(e){var r=e.PartNumber-1;t.chunkState[r]={uploaded:e.Size,etag:e.ETag,done:!0},t.parts.some(function(t){return t.PartNumber===e.PartNumber})||t.parts.push({PartNumber:e.PartNumber,ETag:e.ETag})}),t._uploadParts()}).catch(function(e){t._onError(e)})},o.prototype._uploadParts=function(){var t=this;if(!this.isPaused){var e=this.options.limit-this.uploading.length;if(0!==e)if(this.chunkState.every(function(t){return t.done}))this._completeUpload();else{for(var r=[],n=0;n<this.chunkState.length;n++){var o=this.chunkState[n];if(!o.done&&!o.busy&&(r.push(n),r.length>=e))break}r.forEach(function(e){t._uploadPart(e)})}}},o.prototype._uploadPart=function(e){var r=this,n=this.chunks[e];return this.chunkState[e].busy=!0,Promise.resolve().then(function(){return r.options.prepareUploadPart({key:r.key,uploadId:r.uploadId,body:n,number:e+1})}).then(function(e){if("object"!==(void 0===e?"undefined":t(e))||!e||"string"!=typeof e.url)throw new TypeError("AwsS3/Multipart: Got incorrect result from 'prepareUploadPart()', expected an object '{ url }'.");return e}).then(function(t){var n=t.url;r._uploadPartBytes(e,n)})},o.prototype._onPartProgress=function(t,e,r){this.chunkState[t].uploaded=e;var n=this.chunkState.reduce(function(t,e){return t+e.uploaded},0);this.options.onProgress(n,this.file.size)},o.prototype._onPartComplete=function(t,e){this.chunkState[t].etag=e,this.chunkState[t].done=!0;var r={PartNumber:t+1,ETag:e};this.parts.push(r),this.options.onPartComplete(r),this._uploadParts()},o.prototype._uploadPartBytes=function(t,e){var r=this,o=this.chunks[t],i=new XMLHttpRequest;i.open("PUT",e,!0),i.responseType="text",this.uploading.push(i),i.upload.addEventListener("progress",function(e){e.lengthComputable&&r._onPartProgress(t,e.loaded,e.total)}),i.addEventListener("abort",function(e){n(r.uploading,e.target),r.chunkState[t].busy=!1}),i.addEventListener("load",function(e){if(n(r.uploading,e.target),r.chunkState[t].busy=!1,e.target.status<200||e.target.status>=300)r._onError(new Error("Non 2xx"));else{r._onPartProgress(t,o.size,o.size);var i=e.target.getResponseHeader("ETag");null!==i?r._onPartComplete(t,i):r._onError(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. Seee https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))}}),i.addEventListener("error",function(e){n(r.uploading,e.target),r.chunkState[t].busy=!1;var o=new Error("Unknown error");o.source=e.target,r._onError(o)}),i.send(o)},o.prototype._completeUpload=function(){var t=this;return this.parts.sort(function(t,e){return t.PartNumber-e.PartNumber}),Promise.resolve().then(function(){return t.options.completeMultipartUpload({key:t.key,uploadId:t.uploadId,parts:t.parts})}).then(function(e){t.options.onSuccess(e)},function(e){t._onError(e)})},o.prototype._abortUpload=function(){this.options.abortMultipartUpload({key:this.key,uploadId:this.uploadId})},o.prototype._onError=function(t){this.options.onError(t)},o.prototype.start=function(){this.isPaused=!1,this.uploadId?this._resumeUpload():this._createUpload()},o.prototype.pause=function(){this.uploading.slice().forEach(function(t){t.abort()}),this.isPaused=!0},o.prototype.abort=function(){if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).really)return this.pause();this._abortUpload()},o}(),i=function(t,e){var r="000000000"+t;return r.substr(r.length-e)},s="object"==typeof window?window:self,a=Object.keys(s).length,l=i(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+a.toString(36),4),u=function(){return l},p={},c=0,h=4,d=36,f=Math.pow(d,h);function y(){return i((Math.random()*f<<0).toString(d),h)}function g(){return c=c<f?c:0,++c-1}function m(){return"c"+(new Date).getTime().toString(d)+i(g().toString(d),h)+u()+(y()+y())}m.slug=function(){var t=(new Date).getTime().toString(36),e=g().toString(36).slice(-4),r=u().slice(0,1)+u().slice(-1),n=y().slice(-2);return t.slice(-2)+e+r+n},m.fingerprint=u,p=m;var v={};function b(t,e){this.text=t=t||"",this.hasWild=~t.indexOf("*"),this.separator=e,this.parts=t.split(e)}b.prototype.match=function(t){var e,r,n=!0,o=this.parts,i=o.length;if("string"==typeof t||t instanceof String)if(this.hasWild||this.text==t){for(r=(t||"").split(this.separator),e=0;n&&e<i;e++)"*"!==o[e]&&(n=e<r.length&&o[e]===r[e]);n=n&&r}else n=!1;else if("function"==typeof t.splice)for(n=[],e=t.length;e--;)this.match(t[e])&&(n[n.length]=t[e]);else if("object"==typeof t)for(var s in n={},t)this.match(s)&&(n[s]=t[s]);return n},v=function(t,e,r){var n=new b(t,r||/[\/\.]/);return void 0!==e?n.match(e):n};var w=/[\/\+\.]/,S=function(){var t={},e=t._fns={};return t.emit=function(t,r,n,o,i,s,a){var l=function(t){for(var r=e[t]?e[t]:[],n=t.indexOf(":"),o=-1===n?[t]:[t.substring(0,n),t.substring(n+1)],i=Object.keys(e),s=0,a=i.length;s<a;s++){var l=i[s];if("*"===l&&(r=r.concat(e[l])),2===o.length&&o[0]===l){r=r.concat(e[l]);break}}return r}(t);l.length&&function(t,e,r){for(var n=0,o=e.length;n<o&&e[n];n++)e[n].event=t,e[n].apply(e[n],r)}(t,l,[r,n,o,i,s,a])},t.on=function(t,r){e[t]||(e[t]=[]),e[t].push(r)},t.once=function(e,r){this.on(e,function n(){r.apply(this,arguments),t.off(e,n)})},t.off=function(t,e){var r=[];if(t&&e)for(var n=this._fns[t],o=0,i=n?n.length:0;o<i;o++)n[o]!==e&&r.push(n[o]);r.length?this._fns[t]=r:delete this._fns[t]},t},P=function(t){if("number"!=typeof t||isNaN(t))throw new TypeError("Expected a number, got "+typeof t);var e=t<0,r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(e&&(t=-t),t<1)return(e?"-":"")+t+" B";var n=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),r.length-1);t=Number(t/Math.pow(1e3,n));var o=r[n];return t>=10||t%1==0?(e?"-":"")+t.toFixed(0)+" "+o:(e?"-":"")+t.toFixed(1)+" "+o},k={exports:{}};!function(){"use strict";function t(){}function e(e,r){var n,o,i,s,a=P;for(s=arguments.length;s-- >2;)S.push(arguments[s]);for(r&&null!=r.children&&(S.length||S.push(r.children),delete r.children);S.length;)if((o=S.pop())&&void 0!==o.pop)for(s=o.length;s--;)S.push(o[s]);else"boolean"==typeof o&&(o=null),(i="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(i=!1)),i&&n?a[a.length-1]+=o:a===P?a=[o]:a.push(o),n=i;var l=new t;return l.nodeName=e,l.children=a,l.attributes=null==r?void 0:r,l.key=null==r?void 0:r.key,void 0!==w.vnode&&w.vnode(l),l}function r(t,e){for(var r in e)t[r]=e[r];return t}function n(t){!t.__d&&(t.__d=!0)&&1==C.push(t)&&(w.debounceRendering||_)(o)}function o(){var t,e=C;for(C=[];t=e.pop();)t.__d&&m(t)}function i(t,e){return t.__n===e||t.nodeName.toLowerCase()===e.toLowerCase()}function s(t){var e=r({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===e[o]&&(e[o]=n[o]);return e}function a(t){var e=t.parentNode;e&&e.removeChild(t)}function l(t,e,r,n,o){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)r&&r(null),n&&n(t);else if("class"!==e||o)if("style"===e){if(n&&"string"!=typeof n&&"string"!=typeof r||(t.style.cssText=n||""),n&&"object"==typeof n){if("string"!=typeof r)for(var i in r)i in n||(t.style[i]="");for(var i in n)t.style[i]="number"==typeof n[i]&&!1===E.test(i)?n[i]+"px":n[i]}}else if("dangerouslySetInnerHTML"===e)n&&(t.innerHTML=n.__html||"");else if("o"==e[0]&&"n"==e[1]){var s=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),n?r||t.addEventListener(e,u,s):t.removeEventListener(e,u,s),(t.__l||(t.__l={}))[e]=n}else if("list"!==e&&"type"!==e&&!o&&e in t)!function(t,e,r){try{t[e]=r}catch(t){}}(t,e,null==n?"":n),null!=n&&!1!==n||t.removeAttribute(e);else{var a=o&&e!==(e=e.replace(/^xlink:?/,""));null==n||!1===n?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof n&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n))}else t.className=n||""}function u(t){return this.__l[t.type](w.event&&w.event(t)||t)}function p(){for(var t;t=U.pop();)w.afterMount&&w.afterMount(t),t.componentDidMount&&t.componentDidMount()}function c(t,e,r,n,o,u){T++||(F=null!=o&&void 0!==o.ownerSVGElement,O=null!=t&&!("__preactattr_"in t));var c=function t(e,r,n,o,u){var p=e,c=F;if(null!=r&&"boolean"!=typeof r||(r=""),"string"==typeof r||"number"==typeof r)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||u)?e.nodeValue!=r&&(e.nodeValue=r):(p=document.createTextNode(r),e&&(e.parentNode&&e.parentNode.replaceChild(p,e),h(e,!0))),p.__preactattr_=!0,p;var d,y,m=r.nodeName;if("function"==typeof m)return function(t,e,r,n){for(var o=t&&t._component,i=o,a=t,l=o&&t._componentConstructor===e.nodeName,u=l,p=s(e);o&&!u&&(o=o.__u);)u=o.constructor===e.nodeName;return o&&u&&(!n||o._component)?(g(o,p,3,r,n),t=o.base):(i&&!l&&(v(i),t=a=null),o=f(e.nodeName,p,r),t&&!o.__b&&(o.__b=t,a=null),g(o,p,1,r,n),t=o.base,a&&t!==a&&(a._component=null,h(a,!1))),t}(e,r,n,o);if(F="svg"===m||"foreignObject"!==m&&F,m=String(m),(!e||!i(e,m))&&(d=m,(y=F?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d)).__n=d,p=y,e)){for(;e.firstChild;)p.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(p,e),h(e,!0)}var b=p.firstChild,w=p.__preactattr_,S=r.children;if(null==w){w=p.__preactattr_={};for(var P=p.attributes,k=P.length;k--;)w[P[k].name]=P[k].value}return!O&&S&&1===S.length&&"string"==typeof S[0]&&null!=b&&void 0!==b.splitText&&null==b.nextSibling?b.nodeValue!=S[0]&&(b.nodeValue=S[0]):(S&&S.length||null!=b)&&function(e,r,n,o,s){var l,u,p,c,d,f,y,g,m=e.childNodes,v=[],b={},w=0,S=0,P=m.length,k=0,_=r?r.length:0;if(0!==P)for(var E=0;E<P;E++){var C=m[E],U=C.__preactattr_,T=_&&U?C._component?C._component.__k:U.key:null;null!=T?(w++,b[T]=C):(U||(void 0!==C.splitText?!s||C.nodeValue.trim():s))&&(v[k++]=C)}if(0!==_)for(var E=0;E<_;E++){c=r[E],d=null;var T=c.key;if(null!=T)w&&void 0!==b[T]&&(d=b[T],b[T]=void 0,w--);else if(!d&&S<k)for(l=S;l<k;l++)if(void 0!==v[l]&&(f=u=v[l],g=s,"string"==typeof(y=c)||"number"==typeof y?void 0!==f.splitText:"string"==typeof y.nodeName?!f._componentConstructor&&i(f,y.nodeName):g||f._componentConstructor===y.nodeName)){d=u,v[l]=void 0,l===k-1&&k--,l===S&&S++;break}d=t(d,c,n,o),p=m[E],d&&d!==e&&d!==p&&(null==p?e.appendChild(d):d===p.nextSibling?a(p):e.insertBefore(d,p))}if(w)for(var E in b)void 0!==b[E]&&h(b[E],!1);for(;S<=k;)void 0!==(d=v[k--])&&h(d,!1)}(p,S,n,o,O||null!=w.dangerouslySetInnerHTML),function(t,e,r){var n;for(n in r)e&&null!=e[n]||null==r[n]||l(t,n,r[n],r[n]=void 0,F);for(n in e)"children"===n||"innerHTML"===n||n in r&&e[n]===("value"===n||"checked"===n?t[n]:r[n])||l(t,n,r[n],r[n]=e[n],F)}(p,r.attributes,w),F=c,p}(t,e,r,n,u);return o&&c.parentNode!==o&&o.appendChild(c),--T||(O=!1,u||p()),c}function h(t,e){var r=t._component;r?v(r):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||a(t),d(t))}function d(t){for(t=t.lastChild;t;){var e=t.previousSibling;h(t,!0),t=e}}function f(t,e,r){var n,o=A[t.name];if(t.prototype&&t.prototype.render?(n=new t(e,r),b.call(n,e,r)):((n=new b(e,r)).constructor=t,n.render=y),o)for(var i=o.length;i--;)if(o[i].constructor===t){n.__b=o[i].__b,o.splice(i,1);break}return n}function y(t,e,r){return this.constructor(t,r)}function g(t,e,r,o,i){t.__x||(t.__x=!0,(t.__r=e.ref)&&delete e.ref,(t.__k=e.key)&&delete e.key,!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,o),o&&o!==t.context&&(t.__c||(t.__c=t.context),t.context=o),t.__p||(t.__p=t.props),t.props=e,t.__x=!1,0!==r&&(1!==r&&!1===w.syncComponentUpdates&&t.base?n(t):m(t,1,i)),t.__r&&t.__r(t))}function m(t,e,n,o){if(!t.__x){var i,a,l,u=t.props,d=t.state,y=t.context,b=t.__p||u,S=t.__s||d,P=t.__c||y,k=t.base,_=t.__b,E=k||_,C=t._component,F=!1;if(k&&(t.props=b,t.state=S,t.context=P,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,d,y)?F=!0:t.componentWillUpdate&&t.componentWillUpdate(u,d,y),t.props=u,t.state=d,t.context=y),t.__p=t.__s=t.__c=t.__b=null,t.__d=!1,!F){i=t.render(u,d,y),t.getChildContext&&(y=r(r({},y),t.getChildContext()));var O,A,x=i&&i.nodeName;if("function"==typeof x){var R=s(i);(a=C)&&a.constructor===x&&R.key==a.__k?g(a,R,1,y,!1):(O=a,t._component=a=f(x,R,y),a.__b=a.__b||_,a.__u=t,g(a,R,0,y,!1),m(a,1,n,!0)),A=a.base}else l=E,(O=C)&&(l=t._component=null),(E||1===e)&&(l&&(l._component=null),A=c(l,i,y,n||!k,E&&E.parentNode,!0));if(E&&A!==E&&a!==C){var D=E.parentNode;D&&A!==D&&(D.replaceChild(A,E),O||(E._component=null,h(E,!1)))}if(O&&v(O),t.base=A,A&&!o){for(var I=t,B=t;B=B.__u;)(I=B).base=A;A._component=I,A._componentConstructor=I.constructor}}if(!k||n?U.unshift(t):F||(t.componentDidUpdate&&t.componentDidUpdate(b,S,P),w.afterUpdate&&w.afterUpdate(t)),null!=t.__h)for(;t.__h.length;)t.__h.pop().call(t);T||o||p()}}function v(t){w.beforeUnmount&&w.beforeUnmount(t);var e=t.base;t.__x=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var r=t._component;r?v(r):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.__b=e,a(e),function(t){var e=t.constructor.name;(A[e]||(A[e]=[])).push(t)}(t),d(e)),t.__r&&t.__r(null)}function b(t,e){this.__d=!0,this.context=e,this.props=t,this.state=this.state||{}}var w={},S=[],P=[],_="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,E=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,C=[],U=[],T=0,F=!1,O=!1,A={};r(b.prototype,{setState:function(t,e){var o=this.state;this.__s||(this.__s=r({},o)),r(o,"function"==typeof t?t(o,this.props):t),e&&(this.__h=this.__h||[]).push(e),n(this)},forceUpdate:function(t){t&&(this.__h=this.__h||[]).push(t),m(this,2)},render:function(){}});var x={h:e,createElement:e,cloneElement:function(t,n){return e(t.nodeName,r(r({},t.attributes),n),arguments.length>2?[].slice.call(arguments,2):t.children)},Component:b,render:function(t,e,r){return c(r,t,{},!1,e,!1)},rerender:o,options:w};k.exports=x}(),k=k.exports;var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E=function(t){return t&&"object"===(void 0===t?"undefined":_(t))&&t.nodeType===Node.ELEMENT_NODE},C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U=function(t){return"string"==typeof t?document.querySelector(t):"object"===(void 0===t?"undefined":C(t))&&E(t)?t:void 0},T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O=function(){function t(e,r){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.uppy=e,this.opts=r||{},this.update=this.update.bind(this),this.mount=this.mount.bind(this),this.install=this.install.bind(this),this.uninstall=this.uninstall.bind(this)}return t.prototype.getPluginState=function(){return this.uppy.getState().plugins[this.id]},t.prototype.setPluginState=function(t){var e=F({},this.uppy.getState().plugins);e[this.id]=F({},e[this.id],t),this.uppy.setState({plugins:e})},t.prototype.update=function(t){void 0!==this.el&&this._updateUI&&this._updateUI(t)},t.prototype.mount=function(e,r){var n,o,i,s=this,a=r.id,l=U(e);if(l)return this.isTargetDOMEl=!0,this.rerender=function(t){s.uppy.getPlugin(s.id)&&(s.el=k.render(s.render(t),l,s.el))},this._updateUI=(n=this.rerender,o=null,i=null,function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i=e,o||(o=Promise.resolve().then(function(){return o=null,n.apply(void 0,i)})),o}),this.uppy.log("Installing "+a+" to a DOM element"),this.opts.replaceTargetContent&&(l.innerHTML=""),this.el=k.render(this.render(this.uppy.getState()),l),this.el;var u=void 0;if("object"===(void 0===e?"undefined":T(e))&&e instanceof t)u=e;else if("function"==typeof e){var p=e;this.uppy.iteratePlugins(function(t){if(t instanceof p)return u=t,!1})}if(u){var c=u.id;return this.uppy.log("Installing "+a+" to "+c),this.el=u.addTarget(r),this.el}throw this.uppy.log("Not installing "+a),new Error("Invalid target option given to "+a)},t.prototype.render=function(t){throw new Error("Extend the render method to add your plugin to a DOM element")},t.prototype.addTarget=function(t){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")},t.prototype.unmount=function(){this.isTargetDOMEl&&this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.prototype.install=function(){},t.prototype.uninstall=function(){this.unmount()},t}(),A=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x=function(){function t(){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.state={},this.callbacks=[]}return t.prototype.getState=function(){return this.state},t.prototype.setState=function(t){var e=A({},this.state),r=A({},this.state,t);this.state=r,this._publish(e,r,t)},t.prototype.subscribe=function(t){var e=this;return this.callbacks.push(t),function(){e.callbacks.splice(e.callbacks.indexOf(t),1)}},t.prototype._publish=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.callbacks.forEach(function(t){t.apply(void 0,e)})},t}(),R=function(){return new x},D=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},I=function(){function t(e){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var r={locale:{strings:{},pluralize:function(t){return 1===t?0:1}}};this.opts=D({},r,e),this.locale=D({},r.locale,e.locale)}return t.prototype.interpolate=function(t,e){var r=String.prototype,n=r.split,o=r.replace,i=/\$/g,s=[t];for(var a in e)if("_"!==a&&e.hasOwnProperty(a)){var l=e[a];"string"==typeof l&&(l=o.call(e[a],i,"$$$$")),s=u(s,new RegExp("%\\{"+a+"\\}","g"),l)}return s;function u(t,e,r){var o=[];return t.forEach(function(t){n.call(t,e).forEach(function(t,e,n){""!==t&&o.push(t),e<n.length-1&&o.push(r)})}),o}},t.prototype.translate=function(t,e){return this.translateArray(t,e).join("")},t.prototype.translateArray=function(t,e){if(e&&void 0!==e.smart_count){var r=this.locale.pluralize(e.smart_count);return this.interpolate(this.opts.locale.strings[t][r],e)}return this.interpolate(this.opts.locale.strings[t],e)},t}(),B=function(t){return["uppy",t.name?t.name.toLowerCase().replace(/[^A-Z0-9]/gi,""):"",t.type,t.data.size,t.data.lastModified].filter(function(t){return t}).join("-")},j=function(t){var e=/(?:\.([^.]+))?$/.exec(t)[1];return{name:t.replace("."+e,""),extension:e}},M={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",gif:"image/gif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel"},L=function(t){var e=t.name?j(t.name).extension:null;return t.isRemote?t.type?t.type:M[e]:t.type?t.type:e&&M[e]?M[e]:null};function N(t){return 2!==t.length?0+t:t}var z,q=function(){var t=new Date;return N(t.getHours().toString())+":"+N(t.getMinutes().toString())+":"+N(t.getSeconds().toString())},H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},X=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),V=function(){function t(e){var r=this;!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var n={strings:{youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"This file exceeds maximum allowed size of",youCanOnlyUploadFileTypes:"You can only upload:",uppyServerError:"Connection with Uppy Server failed",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectXFiles:{0:"Select %{smart_count} file",1:"Select %{smart_count} files"},cancel:"Cancel",logOut:"Log out"}},o={id:"uppy",autoProceed:!0,debug:!1,restrictions:{maxFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null},meta:{},onBeforeFileAdded:function(t,e){return t},onBeforeUpload:function(t){return t},locale:n,store:R()};this.opts=W({},o,e),this.opts.restrictions=W({},o.restrictions,this.opts.restrictions),this.locale=W({},n,this.opts.locale),this.locale.strings=W({},n.strings,this.opts.locale.strings),this.translator=new I({locale:this.locale}),this.i18n=this.translator.translate.bind(this.translator),this.plugins={},this.getState=this.getState.bind(this),this.getPlugin=this.getPlugin.bind(this),this.setFileMeta=this.setFileMeta.bind(this),this.setFileState=this.setFileState.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.hideInfo=this.hideInfo.bind(this),this.addFile=this.addFile.bind(this),this.removeFile=this.removeFile.bind(this),this.pauseResume=this.pauseResume.bind(this),this._calculateProgress=this._calculateProgress.bind(this),this.updateOnlineStatus=this.updateOnlineStatus.bind(this),this.resetProgress=this.resetProgress.bind(this),this.pauseAll=this.pauseAll.bind(this),this.resumeAll=this.resumeAll.bind(this),this.retryAll=this.retryAll.bind(this),this.cancelAll=this.cancelAll.bind(this),this.retryUpload=this.retryUpload.bind(this),this.upload=this.upload.bind(this),this.emitter=S(),this.on=this.on.bind(this),this.off=this.off.bind(this),this.once=this.emitter.once.bind(this.emitter),this.emit=this.emitter.emit.bind(this.emitter),this.preProcessors=[],this.uploaders=[],this.postProcessors=[],this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},capabilities:{resumableUploads:!1},totalProgress:0,meta:W({},this.opts.meta),info:{isHidden:!0,type:"info",message:""}}),this._storeUnsubscribe=this.store.subscribe(function(t,e,n){r.emit("state-update",t,e,n),r.updateAll(e)}),this.opts.debug&&"undefined"!=typeof window&&(window.uppyLog="",window[this.opts.id]=this),this._addListeners()}return t.prototype.on=function(t,e){return this.emitter.on(t,e),this},t.prototype.off=function(t,e){return this.emitter.off(t,e),this},t.prototype.updateAll=function(t){this.iteratePlugins(function(e){e.update(t)})},t.prototype.setState=function(t){this.store.setState(t)},t.prototype.getState=function(){return this.store.getState()},t.prototype.setFileState=function(t,e){var r;if(!this.getState().files[t])throw new Error("Can\u2019t set state for "+t+" (the file could have been removed)");this.setState({files:W({},this.getState().files,(r={},r[t]=W({},this.getState().files[t],e),r))})},t.prototype.resetProgress=function(){var t={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:!1},e=W({},this.getState().files),r={};Object.keys(e).forEach(function(n){var o=W({},e[n]);o.progress=W({},o.progress,t),r[n]=o}),this.setState({files:r,totalProgress:0}),this.emit("reset-progress")},t.prototype.addPreProcessor=function(t){this.preProcessors.push(t)},t.prototype.removePreProcessor=function(t){var e=this.preProcessors.indexOf(t);-1!==e&&this.preProcessors.splice(e,1)},t.prototype.addPostProcessor=function(t){this.postProcessors.push(t)},t.prototype.removePostProcessor=function(t){var e=this.postProcessors.indexOf(t);-1!==e&&this.postProcessors.splice(e,1)},t.prototype.addUploader=function(t){this.uploaders.push(t)},t.prototype.removeUploader=function(t){var e=this.uploaders.indexOf(t);-1!==e&&this.uploaders.splice(e,1)},t.prototype.setMeta=function(t){var e=W({},this.getState().meta,t),r=W({},this.getState().files);Object.keys(r).forEach(function(e){r[e]=W({},r[e],{meta:W({},r[e].meta,t)})}),this.log("Adding metadata:"),this.log(t),this.setState({meta:e,files:r})},t.prototype.setFileMeta=function(t,e){var r=W({},this.getState().files);if(r[t]){var n=W({},r[t].meta,e);r[t]=W({},r[t],{meta:n}),this.setState({files:r})}else this.log("Was trying to set metadata for a file that\u2019s not with us anymore: ",t)},t.prototype.getFile=function(t){return this.getState().files[t]},t.prototype.getFiles=function(){var t=this.getState().files;return Object.keys(t).map(function(e){return t[e]})},t.prototype._checkMinNumberOfFiles=function(t){var e=this.opts.restrictions.minNumberOfFiles;if(Object.keys(t).length<e)throw new Error(""+this.i18n("youHaveToAtLeastSelectX",{smart_count:e}))},t.prototype._checkRestrictions=function(t){var e=this.opts.restrictions,r=e.maxFileSize,n=e.maxNumberOfFiles,o=e.allowedFileTypes;if(n&&Object.keys(this.getState().files).length+1>n)throw new Error(""+this.i18n("youCanOnlyUploadX",{smart_count:n}));if(o&&!(o.filter(function(e){return e.indexOf("/")>-1?!!t.type&&function(t,e){function r(e){var r=v(e,t,w);return r&&r.length>=2}return e?r(e.split(";")[0]):r}(t.type,e):"."===e[0]&&t.extension===e.substr(1)?t.extension:void 0}).length>0)){var i=o.join(", ");throw new Error(this.i18n("youCanOnlyUploadFileTypes")+" "+i)}if(r&&t.data.size>r)throw new Error(this.i18n("exceedsSize")+" "+P(r))},t.prototype.addFile=function(t){var e,r=this,n=this.getState().files,o=this.opts.onBeforeFileAdded(t,n);if(!1!==o){if("object"===(void 0===o?"undefined":H(o))&&o){if(o.then)throw new TypeError("onBeforeFileAdded() returned a Promise, but this is no longer supported. It must be synchronous.");t=o}var i,s=L(t);i=t.name?t.name:"image"===s.split("/")[0]?s.split("/")[0]+"."+s.split("/")[1]:"noname";var a=j(i).extension,l=t.isRemote||!1,u=B(t),p=t.meta||{};p.name=i,p.type=s;var c={source:t.source||"",id:u,name:i,extension:a||"",meta:W({},this.getState().meta,p),type:s,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:t.data.size||0,uploadComplete:!1,uploadStarted:!1},size:t.data.size||0,isRemote:l,remote:t.remote||"",preview:t.preview};try{this._checkRestrictions(c)}catch(t){!function(t){var e="object"===(void 0===t?"undefined":H(t))?t:new Error(t);throw r.log(e.message),r.info(e.message,"error",5e3),e}(t)}this.setState({files:W({},n,(e={},e[u]=c,e))}),this.emit("file-added",c),this.log("Added file: "+i+", "+u+", mime type: "+s),this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(function(){r.scheduledAutoProceed=null,r.upload().catch(function(t){console.error(t.stack||t.message||t)})},4))}else this.log("Not adding file because onBeforeFileAdded returned false")},t.prototype.removeFile=function(t){var e=this,r=this.getState(),n=r.files,o=r.currentUploads,i=W({},n),s=i[t];delete i[t];var a=W({},o),l=[];Object.keys(a).forEach(function(e){var r=o[e].fileIDs.filter(function(e){return e!==t});0!==r.length?a[e]=W({},o[e],{fileIDs:r}):l.push(e)}),this.setState({currentUploads:a,files:i}),l.forEach(function(t){e._removeUpload(t)}),this._calculateTotalProgress(),this.emit("file-removed",s),this.log("File removed: "+s.id),s.preview&&0===s.preview.indexOf("blob:")&&URL.revokeObjectURL(s.preview),this.log("Removed file: "+t)},t.prototype.pauseResume=function(t){if(!this.getFile(t).uploadComplete){var e=!this.getFile(t).isPaused;return this.setFileState(t,{isPaused:e}),this.emit("upload-pause",t,e),e}},t.prototype.pauseAll=function(){var t=W({},this.getState().files);Object.keys(t).filter(function(e){return!t[e].progress.uploadComplete&&t[e].progress.uploadStarted}).forEach(function(e){var r=W({},t[e],{isPaused:!0});t[e]=r}),this.setState({files:t}),this.emit("pause-all")},t.prototype.resumeAll=function(){var t=W({},this.getState().files);Object.keys(t).filter(function(e){return!t[e].progress.uploadComplete&&t[e].progress.uploadStarted}).forEach(function(e){var r=W({},t[e],{isPaused:!1,error:null});t[e]=r}),this.setState({files:t}),this.emit("resume-all")},t.prototype.retryAll=function(){var t=W({},this.getState().files),e=Object.keys(t).filter(function(e){return t[e].error});e.forEach(function(e){var r=W({},t[e],{isPaused:!1,error:null});t[e]=r}),this.setState({files:t,error:null}),this.emit("retry-all",e);var r=this._createUpload(e);return this._runUpload(r)},t.prototype.cancelAll=function(){var t=this;this.emit("cancel-all");var e=this.getState().currentUploads;Object.keys(e).forEach(function(e){t._removeUpload(e)}),this.setState({files:{},totalProgress:0,error:null})},t.prototype.retryUpload=function(t){var e=W({},this.getState().files),r=W({},e[t],{error:null,isPaused:!1});e[t]=r,this.setState({files:e}),this.emit("upload-retry",t);var n=this._createUpload([t]);return this._runUpload(n)},t.prototype.reset=function(){this.cancelAll()},t.prototype._calculateProgress=function(t,e){this.getFile(t.id)?(this.setFileState(t.id,{progress:W({},this.getFile(t.id).progress,{bytesUploaded:e.bytesUploaded,bytesTotal:e.bytesTotal,percentage:Math.floor((e.bytesUploaded/e.bytesTotal*100).toFixed(2))})}),this._calculateTotalProgress()):this.log("Not setting progress for a file that has been removed: "+t.id)},t.prototype._calculateTotalProgress=function(){var t=W({},this.getState().files),e=Object.keys(t).filter(function(e){return t[e].progress.uploadStarted}),r=100*e.length,n=0;e.forEach(function(e){n+=t[e].progress.percentage});var o=0===r?0:Math.floor((100*n/r).toFixed(2));this.setState({totalProgress:o})},t.prototype._addListeners=function(){var t=this;this.on("error",function(e){t.setState({error:e.message})}),this.on("upload-error",function(e,r){t.setFileState(e.id,{error:r.message}),t.setState({error:r.message});var n=t.i18n("failedToUpload",{file:e.name});"object"===(void 0===r?"undefined":H(r))&&r.message&&(n={message:n,details:r.message}),t.info(n,"error",5e3)}),this.on("upload",function(){t.setState({error:null})}),this.on("upload-started",function(e,r){t.getFile(e.id)?t.setFileState(e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("upload-progress",this._calculateProgress),this.on("upload-success",function(e,r,n){var o=t.getFile(e.id).progress;t.setFileState(e.id,{progress:W({},o,{uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal}),uploadURL:n,isPaused:!1}),t._calculateTotalProgress()}),this.on("preprocess-progress",function(e,r){t.getFile(e.id)?t.setFileState(e.id,{progress:W({},t.getFile(e.id).progress,{preprocess:r})}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("preprocess-complete",function(e){if(t.getFile(e.id)){var r=W({},t.getState().files);r[e.id]=W({},r[e.id],{progress:W({},r[e.id].progress)}),delete r[e.id].progress.preprocess,t.setState({files:r})}else t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-progress",function(e,r){t.getFile(e.id)?t.setFileState(e.id,{progress:W({},t.getState().files[e.id].progress,{postprocess:r})}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-complete",function(e){if(t.getFile(e.id)){var r=W({},t.getState().files);r[e.id]=W({},r[e.id],{progress:W({},r[e.id].progress)}),delete r[e.id].progress.postprocess,t.setState({files:r})}else t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("restored",function(){t._calculateTotalProgress()}),"undefined"!=typeof window&&(window.addEventListener("online",function(){return t.updateOnlineStatus()}),window.addEventListener("offline",function(){return t.updateOnlineStatus()}),setTimeout(function(){return t.updateOnlineStatus()},3e3))},t.prototype.updateOnlineStatus=function(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)},t.prototype.getID=function(){return this.opts.id},t.prototype.use=function(t,e){if("function"!=typeof t){var r="Expected a plugin class, but got "+(null===t?"null":void 0===t?"undefined":H(t))+". Please verify that the plugin was imported and spelled correctly.";throw new TypeError(r)}var n=new t(this,e),o=n.id;if(this.plugins[n.type]=this.plugins[n.type]||[],!o)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");var i=this.getPlugin(o);if(i){var s="Already found a plugin named '"+i.id+"'. Tried to use: '"+o+"'.\nUppy plugins must have unique 'id' options. See https://uppy.io/docs/plugins/#id.";throw new Error(s)}return this.plugins[n.type].push(n),n.install(),this},t.prototype.getPlugin=function(t){var e=null;return this.iteratePlugins(function(r){if(r.id===t)return e=r,!1}),e},t.prototype.iteratePlugins=function(t){var e=this;Object.keys(this.plugins).forEach(function(r){e.plugins[r].forEach(t)})},t.prototype.removePlugin=function(t){this.log("Removing plugin "+t.id),this.emit("plugin-remove",t),t.uninstall&&t.uninstall();var e=this.plugins[t.type].slice(),r=e.indexOf(t);-1!==r&&(e.splice(r,1),this.plugins[t.type]=e);var n=this.getState();delete n.plugins[t.id],this.setState(n)},t.prototype.close=function(){var t=this;this.log("Closing Uppy instance "+this.opts.id+": removing all files and uninstalling plugins"),this.reset(),this._storeUnsubscribe(),this.iteratePlugins(function(e){t.removePlugin(e)})},t.prototype.info=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,n="object"===(void 0===t?"undefined":H(t));this.setState({info:{isHidden:!1,type:e,message:n?t.message:t,details:n?t.details:null}}),this.emit("info-visible"),clearTimeout(this.infoTimeoutID),this.infoTimeoutID=0!==r?setTimeout(this.hideInfo,r):void 0},t.prototype.hideInfo=function(){var t=W({},this.getState().info,{isHidden:!0});this.setState({info:t}),this.emit("info-hidden")},t.prototype.log=function(t,e){if(this.opts.debug){var r="[Uppy] ["+q()+"] "+t;window.uppyLog=window.uppyLog+"\nDEBUG LOG: "+t,"error"!==e?"warning"!==e?t===""+t?console.log(r):(r="[Uppy] ["+q()+"]",console.log(r),console.dir(t)):console.warn(r):console.error(r)}},t.prototype.run=function(){return this.log("Calling run() is no longer necessary.","warning"),this},t.prototype.restore=function(t){return this.log('Core: attempting to restore upload "'+t+'"'),this.getState().currentUploads[t]?this._runUpload(t):(this._removeUpload(t),Promise.reject(new Error("Nonexistent upload")))},t.prototype._createUpload=function(t){var e,r=p();return this.emit("upload",{id:r,fileIDs:t}),this.setState({currentUploads:W({},this.getState().currentUploads,(e={},e[r]={fileIDs:t,step:0,result:{}},e))}),r},t.prototype._getUpload=function(t){return this.getState().currentUploads[t]},t.prototype.addResultData=function(t,e){var r;if(this._getUpload(t)){var n=this.getState().currentUploads,o=W({},n[t],{result:W({},n[t].result,e)});this.setState({currentUploads:W({},n,(r={},r[t]=o,r))})}else this.log("Not setting result for an upload that has been removed: "+t)},t.prototype._removeUpload=function(t){var e=W({},this.getState().currentUploads);delete e[t],this.setState({currentUploads:e})},t.prototype._runUpload=function(t){var e=this,r=this.getState().currentUploads[t],n=r.fileIDs,o=r.step,i=[].concat(this.preProcessors,this.uploaders,this.postProcessors),s=Promise.resolve();return i.forEach(function(r,i){i<o||(s=s.then(function(){var o,s=e.getState().currentUploads,a=W({},s[t],{step:i});return e.setState({currentUploads:W({},s,(o={},o[t]=a,o))}),r(n,t)}).then(function(t){return null}))}),s.catch(function(r){e.emit("error",r,t),e._removeUpload(t)}),s.then(function(){var r=n.map(function(t){return e.getFile(t)}),o=r.filter(function(t){return t&&!t.error}),i=r.filter(function(t){return t&&t.error});e.addResultData(t,{successful:o,failed:i,uploadID:t});var s=e.getState().currentUploads;if(s[t]){var a=s[t].result;return e.emit("complete",a),e._removeUpload(t),a}e.log("Not setting result for an upload that has been removed: "+t)})},t.prototype.upload=function(){var t=this;this.plugins.uploader||this.log("No uploader type plugins are used","warning");var e=this.getState().files,r=this.opts.onBeforeUpload(e);if(!1===r)return Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false"));if(r&&"object"===(void 0===r?"undefined":H(r))){if(r.then)throw new TypeError("onBeforeUpload() returned a Promise, but this is no longer supported. It must be synchronous.");e=r}return Promise.resolve().then(function(){return t._checkMinNumberOfFiles(e)}).then(function(){var r=t.getState().currentUploads,n=Object.keys(r).reduce(function(t,e){return t.concat(r[e].fileIDs)},[]),o=[];Object.keys(e).forEach(function(e){var r=t.getFile(e);r.progress.uploadStarted||-1!==n.indexOf(e)||o.push(r.id)});var i=t._createUpload(o);return t._runUpload(i)}).catch(function(e){var r="object"===(void 0===e?"undefined":H(e))?e.message:e,n="object"===(void 0===e?"undefined":H(e))?e.details:null;return t.log(r+" "+n),t.info({message:r,details:n},"error",4e3),Promise.reject("object"===(void 0===e?"undefined":H(e))?e:new Error(e))})},X(t,[{key:"state",get:function(){return this.getState()}}]),t}();(z=function(t){return new V(t)}).Uppy=V,z.Plugin=O;var G=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},K=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Y=function(){function t(e,r){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.uppy=e,this.opts=r,this.onReceiveResponse=this.onReceiveResponse.bind(this)}return t.prototype.onReceiveResponse=function(t){var e,r=this.uppy.getState().uppyServer||{},n=this.opts.serverUrl,o=t.headers;return o.has("i-am")&&o.get("i-am")!==r[n]&&this.uppy.setState({uppyServer:G({},r,(e={},e[n]=o.get("i-am"),e))}),t},t.prototype._getUrl=function(t){return/^(https?:|)\/\//.test(t)?t:this.hostname+"/"+t},t.prototype.get=function(t){var e=this;return fetch(this._getUrl(t),{method:"get",headers:this.headers}).then(this.onReceiveResponse).then(function(t){return t.json()}).catch(function(r){throw new Error("Could not get "+e._getUrl(t)+". "+r)})},t.prototype.post=function(t,e){var r=this;return fetch(this._getUrl(t),{method:"post",headers:this.headers,body:JSON.stringify(e)}).then(this.onReceiveResponse).then(function(e){if(e.status<200||e.status>300)throw new Error("Could not post "+r._getUrl(t)+". "+e.statusText);return e.json()}).catch(function(e){throw new Error("Could not post "+r._getUrl(t)+". "+e)})},t.prototype.delete=function(t,e){var r=this;return fetch(this.hostname+"/"+t,{method:"delete",headers:this.headers,body:e?JSON.stringify(e):null}).then(this.onReceiveResponse).then(function(t){return t.json()}).catch(function(e){throw new Error("Could not delete "+r._getUrl(t)+". "+e)})},K(t,[{key:"hostname",get:function(){var t=this.uppy.getState().uppyServer,e=this.opts.serverUrl;return(t&&t[e]?t[e]:e).replace(/\/$/,"")}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json"}}},{key:"headers",get:function(){return G({},this.defaultHeaders,this.opts.serverHeaders||{})}}]),t}(),J=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Q=function(t){return t.split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join(" ")},Z={RequestClient:Y,Provider:function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.provider=n.provider,o.id=o.provider,o.authProvider=n.authProvider||o.provider,o.name=o.opts.name||Q(o.id),o.tokenKey="uppy-server-"+o.id+"-auth-token",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setAuthToken=function(t){localStorage.setItem(this.tokenKey,t)},e.prototype.checkAuth=function(){return this.get(this.id+"/authorized").then(function(t){return t.authenticated})},e.prototype.authUrl=function(){return this.hostname+"/"+this.id+"/connect"},e.prototype.fileUrl=function(t){return this.hostname+"/"+this.id+"/get/"+t},e.prototype.list=function(t){return this.get(this.id+"/list/"+(t||""))},e.prototype.logout=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.href;return this.get(this.id+"/logout?redirect="+e).then(function(e){return localStorage.removeItem(t.tokenKey),e})},$(e,[{key:"defaultHeaders",get:function(){return J({},t.prototype.defaultHeaders,{"uppy-auth-token":localStorage.getItem(this.tokenKey)})}}]),e}(Y),Socket:function(){function t(e){var r=this;!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.queued=[],this.isOpen=!1,this.socket=new WebSocket(e.target),this.emitter=S(),this.socket.onopen=function(t){for(r.isOpen=!0;r.queued.length>0&&r.isOpen;){var e=r.queued[0];r.send(e.action,e.payload),r.queued=r.queued.slice(1)}},this.socket.onclose=function(t){r.isOpen=!1},this._handleMessage=this._handleMessage.bind(this),this.socket.onmessage=this._handleMessage,this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this)}return t.prototype.close=function(){return this.socket.close()},t.prototype.send=function(t,e){this.isOpen?this.socket.send(JSON.stringify({action:t,payload:e})):this.queued.push({action:t,payload:e})},t.prototype.on=function(t,e){this.emitter.on(t,e)},t.prototype.emit=function(t,e){this.emitter.emit(t,e)},t.prototype.once=function(t,e){this.emitter.once(t,e)},t.prototype._handleMessage=function(t){try{var e=JSON.parse(t.data);this.emit(e.action,e.payload)}catch(t){console.log(t)}},t}()},tt={};(function(t){var e="Expected a function",r=NaN,n="[object Symbol]",o=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,c=u||p||Function("return this")(),h=Object.prototype.toString,d=Math.max,f=Math.min,y=function(){return c.Date.now()};function g(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&h.call(t)==n}(t))return r;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var u=s.test(t);return u||a.test(t)?l(t.slice(2),u?2:8):i.test(t)?r:+t}tt=function(t,r,n){var o=!0,i=!0;if("function"!=typeof t)throw new TypeError(e);return g(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),function(t,r,n){var o,i,s,a,l,u,p=0,c=!1,h=!1,v=!0;if("function"!=typeof t)throw new TypeError(e);function b(e){var r=o,n=i;return o=i=void 0,p=e,a=t.apply(n,r)}function w(t){var e=t-u;return void 0===u||e>=r||e<0||h&&t-p>=s}function S(){var t=y();if(w(t))return P(t);l=setTimeout(S,function(t){var e=r-(t-u);return h?f(e,s-(t-p)):e}(t))}function P(t){return l=void 0,v&&o?b(t):(o=i=void 0,a)}function k(){var t=y(),e=w(t);if(o=arguments,i=this,u=t,e){if(void 0===l)return function(t){return p=t,l=setTimeout(S,r),c?b(t):a}(u);if(h)return l=setTimeout(S,r),b(u)}return void 0===l&&(l=setTimeout(S,r)),a}return r=m(r)||0,g(n)&&(c=!!n.leading,s=(h="maxWait"in n)?d(m(n.maxWait)||0,r):s,v="trailing"in n?!!n.trailing:v),k.cancel=function(){void 0!==l&&clearTimeout(l),p=0,o=u=i=l=void 0},k.flush=function(){return void 0===l?a:P(y())},k}(t,r,{leading:o,maxWait:r,trailing:i})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var et=tt(function(t,e,r){var n=e.progress,o=e.bytesUploaded,i=e.bytesTotal;n&&(t.uppy.log("Upload progress: "+n),t.uppy.emit("upload-progress",r,{uploader:t,bytesUploaded:o,bytesTotal:i}))},300,{leading:!0,trailing:!0}),rt=function(t){var e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/.exec(t)[1];return("https:"===location.protocol?"wss":"ws")+"://"+e},nt=function(t){var e=0,r=[];return function(o){return function(){for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];var l=function(){e++;var t=o.apply(void 0,s);return t.then(n,n),t};return e>=t?new Promise(function(t,e){r.push(function(){l().then(t,e)})}):l()}};function n(){e--;var t=r.shift();t&&t()}},ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},it=Z.Socket,st=Z.RequestClient;function at(t){var e=[];return{on:function(r,n){return e.push([r,n]),t.on(r,n)},remove:function(){e.forEach(function(e){var r=e[0],n=e[1];t.off(r,n)})}}}function lt(t){if(t&&t.error){var e=new Error(t.message);throw ot(e,t.error),e}return t}var ut,pt=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.type="uploader",o.id="AwsS3Multipart",o.title="AWS S3 Multipart",o.client=new st(r,n);var i={timeout:3e4,limit:0,createMultipartUpload:o.createMultipartUpload.bind(o),listParts:o.listParts.bind(o),prepareUploadPart:o.prepareUploadPart.bind(o),abortMultipartUpload:o.abortMultipartUpload.bind(o),completeMultipartUpload:o.completeMultipartUpload.bind(o)};return o.opts=ot({},i,n),o.upload=o.upload.bind(o),"number"==typeof o.opts.limit&&0!==o.opts.limit?o.limitRequests=nt(o.opts.limit):o.limitRequests=function(t){return t},o.uploaders=Object.create(null),o.uploaderEvents=Object.create(null),o.uploaderSockets=Object.create(null),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resetUploaderReferences=function(t){this.uploaders[t]&&(this.uploaders[t].abort(),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null),this.uploaderSockets[t]&&(this.uploaderSockets[t].close(),this.uploaderSockets[t]=null)},e.prototype.assertHost=function(){if(!this.opts.serverUrl)throw new Error("Expected a `serverUrl` option containing an uppy-server address.")},e.prototype.createMultipartUpload=function(t){return this.assertHost(),this.client.post("s3/multipart",{filename:t.name,type:t.type}).then(lt)},e.prototype.listParts=function(t,e){var r=e.key,n=e.uploadId;this.assertHost();var o=encodeURIComponent(r);return this.client.get("s3/multipart/"+n+"?key="+o).then(lt)},e.prototype.prepareUploadPart=function(t,e){var r=e.key,n=e.uploadId,o=e.number;this.assertHost();var i=encodeURIComponent(r);return this.client.get("s3/multipart/"+n+"/"+o+"?key="+i).then(lt)},e.prototype.completeMultipartUpload=function(t,e){var r=e.key,n=e.uploadId,o=e.parts;this.assertHost();var i=encodeURIComponent(r),s=encodeURIComponent(n);return this.client.post("s3/multipart/"+s+"/complete?key="+i,{parts:o}).then(lt)},e.prototype.abortMultipartUpload=function(t,e){var r=e.key,n=e.uploadId;this.assertHost();var o=encodeURIComponent(r),i=encodeURIComponent(n);return this.client.delete("s3/multipart/"+i+"?key="+o).then(lt)},e.prototype.uploadFile=function(t){var e=this;return new Promise(function(r,n){var i=new o(t.data,ot({createMultipartUpload:e.limitRequests(e.opts.createMultipartUpload.bind(e,t)),listParts:e.limitRequests(e.opts.listParts.bind(e,t)),prepareUploadPart:e.opts.prepareUploadPart.bind(e,t),completeMultipartUpload:e.limitRequests(e.opts.completeMultipartUpload.bind(e,t)),abortMultipartUpload:e.limitRequests(e.opts.abortMultipartUpload.bind(e,t)),limit:e.opts.limit||5,onStart:function(r){var n=e.uppy.getFile(t.id);e.uppy.setFileState(t.id,{s3Multipart:ot({},n.s3Multipart,{key:r.key,uploadId:r.uploadId,parts:[]})})},onProgress:function(r,n){e.uppy.emit("upload-progress",t,{uploader:e,bytesUploaded:r,bytesTotal:n})},onError:function(r){e.uppy.log(r),e.uppy.emit("upload-error",t,r),r.message="Failed because: "+r.message,e.resetUploaderReferences(t.id),n(r)},onSuccess:function(n){e.uppy.emit("upload-success",t,i,n.location),n.location&&e.uppy.log("Download "+i.file.name+" from "+n.location),e.resetUploaderReferences(t.id),r(i)},onPartComplete:function(r){var n=e.uppy.getFile(t.id);e.uppy.setFileState(t.id,{s3Multipart:ot({},n.s3Multipart,{parts:[].concat(n.s3Multipart.parts,[r])})}),e.uppy.emit("s3-multipart:part-uploaded",n,r)}},t.s3Multipart));e.uploaders[t.id]=i,e.uploaderEvents[t.id]=at(e.uppy),e.onFileRemove(t.id,function(n){e.resetUploaderReferences(t.id),r("upload "+n.id+" was removed")}),e.onFilePause(t.id,function(t){t?i.pause():i.start()}),e.onPauseAll(t.id,function(){i.pause()}),e.onCancelAll(t.id,function(){i.abort({really:!0})}),e.onResumeAll(t.id,function(){i.start()}),t.isPaused||i.start(),t.isRestored||e.uppy.emit("upload-started",t,i)})},e.prototype.uploadRemote=function(t){var e=this;return this.resetUploaderReferences(t.id),new Promise(function(r,n){if(t.serverToken)return e.connectToServerSocket(t).then(function(){return r()}).catch(n);e.uppy.emit("upload-started",t),fetch(t.remote.url,{method:"post",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(ot({},t.remote.body,{protocol:"s3-multipart",size:t.data.size,metadata:t.meta}))}).then(function(r){return r.status<200||r.status>300?n(r.statusText):r.json().then(function(r){return e.uppy.setFileState(t.id,{serverToken:r.token}),e.uppy.getFile(t.id)})}).then(function(t){return e.connectToServerSocket(t)}).then(function(){r()}).catch(function(t){n(new Error(t))})})},e.prototype.connectToServerSocket=function(t){var e=this;return new Promise(function(r,n){var o=t.serverToken,i=rt(t.remote.serverUrl),s=new it({target:i+"/api/"+o});e.uploaderSockets[s]=s,e.uploaderEvents[t.id]=at(e.uppy),e.onFileRemove(t.id,function(e){s.send("pause",{}),r("upload "+t.id+" was removed")}),e.onFilePause(t.id,function(t){s.send(t?"pause":"resume",{})}),e.onPauseAll(t.id,function(){return s.send("pause",{})}),e.onCancelAll(t.id,function(){return s.send("pause",{})}),e.onResumeAll(t.id,function(){t.error&&s.send("pause",{}),s.send("resume",{})}),e.onRetry(t.id,function(){s.send("pause",{}),s.send("resume",{})}),e.onRetryAll(t.id,function(){s.send("pause",{}),s.send("resume",{})}),t.isPaused&&s.send("pause",{}),s.on("progress",function(r){return et(e,r,t)}),s.on("error",function(r){e.uppy.emit("upload-error",t,new Error(r.error)),n(new Error(r.error))}),s.on("success",function(n){e.uppy.emit("upload-success",t,n,n.url),r()})})},e.prototype.upload=function(t){var e=this;if(0===t.length)return Promise.resolve();var r=t.map(function(t){var r=e.uppy.getFile(t);return r.isRemote?e.uploadRemote(r):e.uploadFile(r)});return Promise.all(r)},e.prototype.onFileRemove=function(t,e){this.uploaderEvents[t].on("file-removed",function(r){t===r.id&&e(r.id)})},e.prototype.onFilePause=function(t,e){this.uploaderEvents[t].on("upload-pause",function(r,n){t===r&&e(n)})},e.prototype.onRetry=function(t,e){this.uploaderEvents[t].on("upload-retry",function(r){t===r&&e()})},e.prototype.onRetryAll=function(t,e){var r=this;this.uploaderEvents[t].on("retry-all",function(n){r.uppy.getFile(t)&&e()})},e.prototype.onPauseAll=function(t,e){var r=this;this.uploaderEvents[t].on("pause-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.onCancelAll=function(t,e){var r=this;this.uploaderEvents[t].on("cancel-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.onResumeAll=function(t,e){var r=this;this.uploaderEvents[t].on("resume-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.install=function(){this.uppy.setState({capabilities:ot({},this.uppy.getState().capabilities,{resumableUploads:!0})}),this.uppy.addUploader(this.upload)},e.prototype.uninstall=function(){this.uppy.setState({capabilities:ot({},this.uppy.getState().capabilities,{resumableUploads:!1})}),this.uppy.removeUploader(this.upload)},e}(z.Plugin),ct={};ut=function(){return function(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(e,r.firstChild);for(var n,o=document.createElement("a"),i=1;i<t;i++)o.href=arguments[i],n=o.href,e.href=n;return r.removeChild(e),n}},"object"==typeof ct?ct=ut():this.resolveUrl=ut();var ht=function(t){var e=[],r=[];function n(t){e.push(t)}function o(t){r.push(t)}return Promise.all(t.map(function(t){return t.then(n,o)})).then(function(){return{successful:e,failed:r}})},dt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ft=Z.Provider,yt=Z.Socket;function gt(t,e){return e||(e=new Error("Upload error")),"string"==typeof e&&(e=new Error(e)),e instanceof Error||(e=dt(new Error("Upload error"),{data:e})),e.request=t,e}var mt=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.type="uploader",o.id="XHRUpload",o.title="XHRUpload";var i={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}},s={formData:!0,fieldName:"files[]",method:"post",metaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},locale:i,timeout:3e4,limit:0,withCredentials:!1,getResponseData:function(t,e){var r={};try{r=JSON.parse(t)}catch(t){console.log(t)}return r},getResponseError:function(t,e){return new Error("Upload error")}};if(o.opts=dt({},s,n),o.locale=dt({},i,o.opts.locale),o.locale.strings=dt({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.handleUpload=o.handleUpload.bind(o),"number"==typeof o.opts.limit&&0!==o.opts.limit?o.limitUploads=nt(o.opts.limit):o.limitUploads=function(t){return t},o.opts.bundle&&!o.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");return o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getOptions=function(t){var e=this.uppy.getState().xhrUpload,r=dt({},this.opts,e||{},t.xhrUpload||{});return r.headers={},dt(r.headers,this.opts.headers),e&&dt(r.headers,e.headers),t.xhrUpload&&dt(r.headers,t.xhrUpload.headers),r},e.prototype.createProgressTimeout=function(t,e){var r=this.uppy,n=this,o=!1;function i(){r.log("[XHRUpload] timed out");var o=new Error(n.i18n("timedOut",{seconds:Math.ceil(t/1e3)}));e(o)}var s=null;return{progress:function(){o||t>0&&(s&&clearTimeout(s),s=setTimeout(i,t))},done:function(){r.log("[XHRUpload] timer done"),s&&(clearTimeout(s),s=null),o=!0}}},e.prototype.createFormDataUpload=function(t,e){var r=new FormData;return(Array.isArray(e.metaFields)?e.metaFields:Object.keys(t.meta)).forEach(function(e){r.append(e,t.meta[e])}),r.append(e.fieldName,t.data),r},e.prototype.createBareUpload=function(t,e){return t.data},e.prototype.upload=function(t,e,r){var n=this,o=this.getOptions(t);return this.uppy.log("uploading "+e+" of "+r),new Promise(function(e,r){var i=o.formData?n.createFormDataUpload(t,o):n.createBareUpload(t,o),s=n.createProgressTimeout(o.timeout,function(e){a.abort(),n.uppy.emit("upload-error",t,e),r(e)}),a=new XMLHttpRequest,l=p();a.upload.addEventListener("loadstart",function(t){n.uppy.log("[XHRUpload] "+l+" started"),s.progress()}),a.upload.addEventListener("progress",function(e){n.uppy.log("[XHRUpload] "+l+" progress: "+e.loaded+" / "+e.total),s.progress(),e.lengthComputable&&n.uppy.emit("upload-progress",t,{uploader:n,bytesUploaded:e.loaded,bytesTotal:e.total})}),a.addEventListener("load",function(i){if(n.uppy.log("[XHRUpload] "+l+" finished"),s.done(),i.target.status>=200&&i.target.status<300){var u=o.getResponseData(a.responseText,a),p=u[o.responseUrlFieldName],c={status:i.target.status,body:u,uploadURL:p};return n.uppy.setFileState(t.id,{response:c}),n.uppy.emit("upload-success",t,u,p),p&&n.uppy.log("Download "+t.name+" from "+t.uploadURL),e(t)}var h=o.getResponseData(a.responseText,a),d=gt(a,o.getResponseError(a.responseText,a)),f={status:i.target.status,body:h};return n.uppy.setFileState(t.id,{response:f}),n.uppy.emit("upload-error",t,d),r(d)}),a.addEventListener("error",function(e){n.uppy.log("[XHRUpload] "+l+" errored"),s.done();var i=gt(a,o.getResponseError(a.responseText,a));return n.uppy.emit("upload-error",t,i),r(i)}),a.open(o.method.toUpperCase(),o.endpoint,!0),a.withCredentials=o.withCredentials,Object.keys(o.headers).forEach(function(t){a.setRequestHeader(t,o.headers[t])}),a.send(i),n.uppy.on("file-removed",function(e){e.id===t.id&&(s.done(),a.abort())}),n.uppy.on("upload-cancel",function(e){e===t.id&&(s.done(),a.abort())}),n.uppy.on("cancel-all",function(){s.done(),a.abort()})})},e.prototype.uploadRemote=function(t,e,r){var n=this,o=this.getOptions(t);return new Promise(function(e,r){var i={};(Array.isArray(o.metaFields)?o.metaFields:Object.keys(t.meta)).forEach(function(e){i[e]=t.meta[e]}),new ft(n.uppy,t.remote.providerOptions).post(t.remote.url,dt({},t.remote.body,{endpoint:o.endpoint,size:t.data.size,fieldname:o.fieldName,metadata:i,headers:o.headers})).then(function(i){var s=i.token,a=rt(t.remote.serverUrl),l=new yt({target:a+"/api/"+s});l.on("progress",function(e){return et(n,e,t)}),l.on("success",function(r){var i=o.getResponseData(r.response.responseText,r.response),s=i[o.responseUrlFieldName];return n.uppy.emit("upload-success",t,i,s),l.close(),e()}),l.on("error",function(e){var i=e.response,s=i?o.getResponseError(i.responseText,i):dt(new Error(e.error.message),{cause:e.error});n.uppy.emit("upload-error",t,s),r(s)})})})},e.prototype.uploadBundle=function(t){var e=this;return new Promise(function(r,n){var o=e.opts.endpoint,i=e.opts.method,s=new FormData;t.forEach(function(t,r){var n=e.getOptions(t);s.append(n.fieldName,t.data)});var a=new XMLHttpRequest;a.withCredentials=e.opts.withCredentials;var l=e.createProgressTimeout(e.opts.timeout,function(t){a.abort(),u(t),n(t)}),u=function(r){t.forEach(function(t){e.uppy.emit("upload-error",t,r)})};a.upload.addEventListener("loadstart",function(t){e.uppy.log("[XHRUpload] started uploading bundle"),l.progress()}),a.upload.addEventListener("progress",function(r){l.progress(),r.lengthComputable&&t.forEach(function(t){e.uppy.emit("upload-progress",t,{uploader:e,bytesUploaded:r.loaded/r.total*t.size,bytesTotal:t.size})})}),a.addEventListener("load",function(o){if(l.done(),o.target.status>=200&&o.target.status<300){var i=e.opts.getResponseData(a.responseText,a);return t.forEach(function(t){e.uppy.emit("upload-success",t,i)}),r()}var s=e.opts.getResponseError(a.responseText,a)||new Error("Upload error");return s.request=a,u(s),n(s)}),a.addEventListener("error",function(t){l.done();var r=e.opts.getResponseError(a.responseText,a)||new Error("Upload error");return u(r),n(r)}),e.uppy.on("cancel-all",function(){l.done(),a.abort()}),a.open(i.toUpperCase(),o,!0),a.withCredentials=e.opts.withCredentials,Object.keys(e.opts.headers).forEach(function(t){a.setRequestHeader(t,e.opts.headers[t])}),a.send(s),t.forEach(function(t){e.uppy.emit("upload-started",t)})})},e.prototype.uploadFiles=function(t){var e=this,r=t.map(function(r,n){var o=parseInt(n,10)+1,i=t.length;return r.error?function(){return Promise.reject(new Error(r.error))}:r.isRemote?(e.uppy.emit("upload-started",r),e.uploadRemote.bind(e,r,o,i)):(e.uppy.emit("upload-started",r),e.upload.bind(e,r,o,i))}).map(function(t){return e.limitUploads(t)()});return ht(r)},e.prototype.handleUpload=function(t){var e=this;if(0===t.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();this.uppy.log("[XHRUpload] Uploading...");var r=t.map(function(t){return e.uppy.getFile(t)});return this.opts.bundle?this.uploadBundle(r):this.uploadFiles(r).then(function(){return null})},e.prototype.install=function(){this.opts.bundle&&this.uppy.setState({capabilities:dt({},this.uppy.getState().capabilities,{bundled:!0})}),this.uppy.addUploader(this.handleUpload)},e.prototype.uninstall=function(){this.opts.bundle&&this.uppy.setState({capabilities:dt({},this.uppy.getState().capabilities,{bundled:!0})}),this.uppy.removeUploader(this.handleUpload)},e}(z.Plugin),vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function wt(t){var e=t.headers?t.headers["content-type"]:t.getResponseHeader("Content-Type");return"string"==typeof e&&"application/xml"===e.toLowerCase()}var St,Pt,kt,_t=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.type="uploader",o.id="AwsS3",o.title="AWS S3";var i={strings:{preparingUpload:"Preparing upload..."}},s={timeout:3e4,limit:0,getUploadParameters:o.getUploadParameters.bind(o),locale:i};return o.opts=bt({},s,n),o.locale=bt({},i,o.opts.locale),o.locale.strings=bt({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.prepareUpload=o.prepareUpload.bind(o),"number"==typeof o.opts.limit&&0!==o.opts.limit?o.limitRequests=nt(o.opts.limit):o.limitRequests=function(t){return t},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getUploadParameters=function(t){if(!this.opts.serverUrl)throw new Error("Expected a `serverUrl` option containing an uppy-server address.");var e=encodeURIComponent(t.name),r=encodeURIComponent(t.type);return fetch(this.opts.serverUrl+"/s3/params?filename="+e+"&type="+r,{method:"get",headers:{accept:"application/json"}}).then(function(t){return t.json()})},e.prototype.validateParameters=function(t,e){if("object"!==(void 0===e?"undefined":vt(e))||!e||"string"!=typeof e.url||"object"!==vt(e.fields)&&null!=e.fields||null!=e.method&&!/^(put|post)$/i.test(e.method)){var r=new TypeError("AwsS3: got incorrect result from 'getUploadParameters()' for file '"+t.name+"', expected an object '{ url, method, fields, headers }'.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.");throw console.error(r),r}return e},e.prototype.prepareUpload=function(t){var e=this;t.forEach(function(t){var r=e.uppy.getFile(t);e.uppy.emit("preprocess-progress",r,{mode:"determinate",message:e.i18n("preparingUpload"),value:0})});var r=this.limitRequests(this.opts.getUploadParameters);return Promise.all(t.map(function(t){var n=e.uppy.getFile(t);return Promise.resolve().then(function(){return r(n)}).then(function(t){return e.validateParameters(n,t)}).then(function(t){return e.uppy.emit("preprocess-progress",n,{mode:"determinate",message:e.i18n("preparingUpload"),value:1}),t}).catch(function(t){e.uppy.emit("upload-error",n,t)})})).then(function(r){var n={};t.forEach(function(t,o){var i=e.uppy.getFile(t);if(!i.error){var s=r[o],a=s.method,l=void 0===a?"post":a,u=s.url,p=s.fields,c=s.headers,h={method:l,formData:"post"===l.toLowerCase(),endpoint:u,metaFields:Object.keys(p)};c&&(h.headers=c);var d=bt({},i,{meta:bt({},i.meta,p),xhrUpload:h});n[t]=d}}),e.uppy.setState({files:bt({},e.uppy.getState().files,n)}),t.forEach(function(t){var r=e.uppy.getFile(t);e.uppy.emit("preprocess-complete",r)})})},e.prototype.install=function(){var t=this.uppy.log;this.uppy.addPreProcessor(this.prepareUpload);var e=!1;this.uppy.use(mt,{fieldName:"file",responseUrlFieldName:"location",timeout:this.opts.timeout,limit:this.opts.limit,getResponseData:function(r,n){if(!wt(n))return"POST"===this.method.toUpperCase()?(e||(t("[AwsS3] No response data found, make sure to set the success_action_status AWS SDK option to 201. See https://uppy.io/docs/aws-s3/#POST-Uploads","warning"),e=!0),{location:null}):n.responseURL?{location:n.responseURL.replace(/\?.*$/,"")}:{location:null};var o=function(){return""};return n.responseXML&&(o=function(t){var e=n.responseXML.querySelector(t);return e?e.textContent:""}),n.responseText&&(o=function(t){var e=n.responseText.indexOf("<"+t+">"),r=n.responseText.indexOf("</"+t+">");return-1!==e&&-1!==r?n.responseText.slice(e+t.length+2,r):""}),{location:ct(n.responseURL,o("Location")),bucket:o("Bucket"),key:o("Key"),etag:o("ETag")}},getResponseError:function(t,e){if(wt(e)){var r=e.responseXML.querySelector("Error > Message");return new Error(r.textContent)}}})},e.prototype.uninstall=function(){var t=this.uppy.getPlugin("XHRUpload");this.uppy.removePlugin(t),this.uppy.removePreProcessor(this.prepareUpload)},e}(z.Plugin),Et=function(t,e){return(e="number"==typeof e?e:1/0)?function t(r,n){return r.reduce(function(r,o){return Array.isArray(o)&&n<e?r.concat(t(o,n+1)):r.concat(o)},[])}(t,1):Array.isArray(t)?t.map(function(t){return t}):t},Ct=St={};function Ut(){throw new Error("setTimeout has not been defined")}function Tt(){throw new Error("clearTimeout has not been defined")}function Ft(t){if(Pt===setTimeout)return setTimeout(t,0);if((Pt===Ut||!Pt)&&setTimeout)return Pt=setTimeout,setTimeout(t,0);try{return Pt(t,0)}catch(e){try{return Pt.call(null,t,0)}catch(e){return Pt.call(this,t,0)}}}!function(){try{Pt="function"==typeof setTimeout?setTimeout:Ut}catch(t){Pt=Ut}try{kt="function"==typeof clearTimeout?clearTimeout:Tt}catch(t){kt=Tt}}();var Ot,At=[],xt=!1,Rt=-1;function Dt(){xt&&Ot&&(xt=!1,Ot.length?At=Ot.concat(At):Rt=-1,At.length&&It())}function It(){if(!xt){var t=Ft(Dt);xt=!0;for(var e=At.length;e;){for(Ot=At,At=[];++Rt<e;)Ot&&Ot[Rt].run();Rt=-1,e=At.length}Ot=null,xt=!1,function(t){if(kt===clearTimeout)return clearTimeout(t);if((kt===Tt||!kt)&&clearTimeout)return kt=clearTimeout,clearTimeout(t);try{kt(t)}catch(e){try{return kt.call(null,t)}catch(e){return kt.call(this,t)}}}(t)}}function Bt(t,e){this.fun=t,this.array=e}function jt(){}Ct.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];At.push(new Bt(t,e)),1!==At.length||xt||Ft(It)},Bt.prototype.run=function(){this.fun.apply(null,this.array)},Ct.title="browser",Ct.browser=!0,Ct.env={},Ct.argv=[],Ct.version="",Ct.versions={},Ct.on=jt,Ct.addListener=jt,Ct.once=jt,Ct.off=jt,Ct.removeListener=jt,Ct.removeAllListeners=jt,Ct.emit=jt,Ct.prependListener=jt,Ct.prependOnceListener=jt,Ct.listeners=function(t){return[]},Ct.binding=function(t){throw new Error("process.binding is not supported")},Ct.cwd=function(){return"/"},Ct.chdir=function(t){throw new Error("process.chdir is not supported")},Ct.umask=function(){return 0};var Mt={};(function(t){Mt=function(e,r){var n,o,i,s=!0;function a(e){function o(){r&&r(e,n),r=null}s?t.nextTick(o):o()}function l(t,e,r){n[t]=r,(0==--o||e)&&a(e)}Array.isArray(e)?(n=[],o=e.length):(i=Object.keys(e),n={},o=i.length),o?i?i.forEach(function(t){e[t](function(e,r){l(t,e,r)})}):e.forEach(function(t,e){t(function(t,r){l(e,t,r)})}):a(null),s=!1}}).call(this,St);var Lt=function(t,e){if("string"==typeof t){var r=t;if(!(t=window.document.querySelector(t)))throw new Error('"'+r+'" does not match any HTML elements')}if(!t)throw new Error('"'+t+'" is not a valid HTML element');var n;return"function"==typeof e&&(e={onDrop:e}),t.addEventListener("dragenter",o,!1),t.addEventListener("dragover",i,!1),t.addEventListener("dragleave",s,!1),t.addEventListener("drop",a,!1),function(){l(),t.removeEventListener("dragenter",o,!1),t.removeEventListener("dragover",i,!1),t.removeEventListener("dragleave",s,!1),t.removeEventListener("drop",a,!1)};function o(t){return e.onDragEnter&&e.onDragEnter(t),t.stopPropagation(),t.preventDefault(),!1}function i(r){if(r.stopPropagation(),r.preventDefault(),r.dataTransfer.items){var o=zt(r.dataTransfer.items),i=o.filter(function(t){return"file"===t.kind}),s=o.filter(function(t){return"string"===t.kind});if(0===i.length&&!e.onDropText)return;if(0===s.length&&!e.onDrop)return;if(0===i.length&&0===s.length)return}return t.classList.add("drag"),clearTimeout(n),e.onDragOver&&e.onDragOver(r),r.dataTransfer.dropEffect="copy",!1}function s(t){return t.stopPropagation(),t.preventDefault(),e.onDragLeave&&e.onDragLeave(t),clearTimeout(n),n=setTimeout(l,50),!1}function a(t){t.stopPropagation(),t.preventDefault(),e.onDragLeave&&e.onDragLeave(t),clearTimeout(n),l();var r={x:t.clientX,y:t.clientY},o=t.dataTransfer.getData("text");if(o&&e.onDropText&&e.onDropText(o,r),t.dataTransfer.files){console.log("e.dataTransfer.files");var i=zt(t.dataTransfer.files);if(0===i.length)return;i.forEach(function(t){t.fullPath="/"+t.name}),e.onDrop&&e.onDrop(i,r)}else if(t.dataTransfer.items){console.log("e.dataTransfer.items");var s=zt(t.dataTransfer.items).filter(function(t){return"file"===t.kind});if(0===s.length)return;Mt(s.map(function(t){return function(e){!function(t,e){var r=[];if(t.isFile)t.file(function(r){r.fullPath=t.fullPath,e(null,r)},function(t){e(t)});else if(t.isDirectory){var n=t.createReader();!function t(){n.readEntries(function(n){n.length>0?(r=r.concat(zt(n)),t()):Mt(r.map(function(t){return function(e){!function(t,e){var r=[];if(t.isFile)t.file(function(r){r.fullPath=t.fullPath,e(null,r)},function(t){e(t)});else if(t.isDirectory){var n=t.createReader();!function t(){n.readEntries(function(n){n.length>0?(r=r.concat(zt(n)),t()):Mt(r.map(function(t){return function(e){Nt(t,e)}}),e)})}()}}(t,e)}}),e)})}()}}(t.webkitGetAsEntry(),e)}}),function(t,n){if(t)throw t;e.onDrop&&e.onDrop(Et(n),r)})}return!1}function l(){t.classList.remove("drag")}};function Nt(t,e){var r=[];if(t.isFile){t.file(function(r){r.fullPath=t.fullPath;e(null,r)},function(t){e(t)})}else if(t.isDirectory){var n=t.createReader();o()}function o(){n.readEntries(function(t){if(t.length>0){r=r.concat(zt(t));o()}else{i()}})}function i(){Mt(r.map(function(t){return function(e){Nt(t,e)}}),e)}}function zt(t){return Array.prototype.slice.call(t||[],0)}var qt={exports:{}};!function(){"use strict";var t={}.hasOwnProperty;function e(){for(var r=[],n=0;n<arguments.length;n++){var o=arguments[n];if(o){var i=typeof o;if("string"===i||"number"===i)r.push(o);else if(Array.isArray(o)&&o.length){var s=e.apply(null,o);s&&r.push(s)}else if("object"===i)for(var a in o)t.call(o,a)&&o[a]&&r.push(a)}}return r.join(" ")}qt.exports?(e.default=e,qt.exports=e):window.classNames=e}(),qt=qt.exports;var Ht=k.h,Wt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"30",height:"30",viewBox:"0 0 30 30"},Ht("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))},Xt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"51",height:"51",viewBox:"0 0 51 51"},Ht("path",{d:"M17.21 45.765a5.394 5.394 0 0 1-7.62 0l-4.12-4.122a5.393 5.393 0 0 1 0-7.618l6.774-6.775-2.404-2.404-6.775 6.776c-3.424 3.427-3.424 9 0 12.426l4.12 4.123a8.766 8.766 0 0 0 6.216 2.57c2.25 0 4.5-.858 6.214-2.57l13.55-13.552a8.72 8.72 0 0 0 2.575-6.213 8.73 8.73 0 0 0-2.575-6.213l-4.123-4.12-2.404 2.404 4.123 4.12a5.352 5.352 0 0 1 1.58 3.81c0 1.438-.562 2.79-1.58 3.808l-13.55 13.55z"}),Ht("path",{d:"M44.256 2.858A8.728 8.728 0 0 0 38.043.283h-.002a8.73 8.73 0 0 0-6.212 2.574l-13.55 13.55a8.725 8.725 0 0 0-2.575 6.214 8.73 8.73 0 0 0 2.574 6.216l4.12 4.12 2.405-2.403-4.12-4.12a5.357 5.357 0 0 1-1.58-3.812c0-1.437.562-2.79 1.58-3.808l13.55-13.55a5.348 5.348 0 0 1 3.81-1.58c1.44 0 2.792.562 3.81 1.58l4.12 4.12c2.1 2.1 2.1 5.518 0 7.617L39.2 23.775l2.404 2.404 6.775-6.777c3.426-3.427 3.426-9 0-12.426l-4.12-4.12z"}))},Vt=function(){return Ht("svg",{class:"UppyIcon retry",width:"28",height:"31",viewBox:"0 0 16 19",xmlns:"http://www.w3.org/2000/svg"},Ht("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),Ht("path",{d:"M7.9 3H10v2H7.9z"}),Ht("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),Ht("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))},Gt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"28",height:"28",viewBox:"0 0 28 28"},Ht("path",{d:"M25.436 2.566a7.98 7.98 0 0 0-2.078-1.51C22.638.703 21.906.5 21.198.5a3 3 0 0 0-1.023.17 2.436 2.436 0 0 0-.893.562L2.292 18.217.5 27.5l9.28-1.796 16.99-16.99c.255-.254.444-.56.562-.888a3 3 0 0 0 .17-1.023c0-.708-.205-1.44-.555-2.16a8 8 0 0 0-1.51-2.077zM9.01 24.252l-4.313.834c0-.03.008-.06.012-.09.007-.944-.74-1.715-1.67-1.723-.04 0-.078.007-.118.01l.83-4.29L17.72 5.024l5.264 5.264L9.01 24.252zm16.84-16.96a.818.818 0 0 1-.194.31l-1.57 1.57-5.26-5.26 1.57-1.57a.82.82 0 0 1 .31-.194 1.45 1.45 0 0 1 .492-.074c.397 0 .917.126 1.468.397.55.27 1.13.678 1.656 1.21.53.53.94 1.11 1.208 1.655.272.55.397 1.07.393 1.468.004.193-.027.358-.074.488z"}))},Kt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"27",height:"25",viewBox:"0 0 27 25"},Ht("path",{d:"M5.586 9.288a.313.313 0 0 0 .282.176h4.84v3.922c0 1.514 1.25 2.24 2.792 2.24 1.54 0 2.79-.726 2.79-2.24V9.464h4.84c.122 0 .23-.068.284-.176a.304.304 0 0 0-.046-.324L13.735.106a.316.316 0 0 0-.472 0l-7.63 8.857a.302.302 0 0 0-.047.325z"}),Ht("path",{d:"M24.3 5.093c-.218-.76-.54-1.187-1.208-1.187h-4.856l1.018 1.18h3.948l2.043 11.038h-7.193v2.728H9.114v-2.725h-7.36l2.66-11.04h3.33l1.018-1.18H3.907c-.668 0-1.06.46-1.21 1.186L0 16.456v7.062C0 24.338.676 25 1.51 25h23.98c.833 0 1.51-.663 1.51-1.482v-7.062L24.3 5.093z"}))},Yt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"62",height:"62",viewBox:"0 0 62 62",xmlns:"http://www.w3.org/2000/svg"},Ht("path",{d:"M4.309 4.309h24.912v53.382h-6.525v3.559h16.608v-3.559h-6.525V4.309h24.912v10.676h3.559V.75H.75v14.235h3.559z","fill-rule":"nonzero",fill:"#000"}))},Jt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",width:"55",height:"55",viewBox:"0 0 55 55"},Ht("path",{d:"M52.66.25c-.216-.19-.5-.276-.79-.242l-31 4.01a1 1 0 0 0-.87.992V40.622C18.174 38.428 15.273 37 12 37c-5.514 0-10 4.037-10 9s4.486 9 10 9 10-4.037 10-9c0-.232-.02-.46-.04-.687.014-.065.04-.124.04-.192V16.12l29-3.753v18.257C49.174 28.428 46.273 27 43 27c-5.514 0-10 4.037-10 9s4.486 9 10 9c5.464 0 9.913-3.966 9.993-8.867 0-.013.007-.024.007-.037V1a.998.998 0 0 0-.34-.75zM12 53c-4.41 0-8-3.14-8-7s3.59-7 8-7 8 3.14 8 7-3.59 7-8 7zm31-10c-4.41 0-8-3.14-8-7s3.59-7 8-7 8 3.14 8 7-3.59 7-8 7zM22 14.1V5.89l29-3.753v8.21l-29 3.754z"}))},$t=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",viewBox:"0 0 58 58"},Ht("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),Ht("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))},Qt=function(){return Ht("svg",{"aria-hidden":"true",class:"UppyIcon",viewBox:"0 0 342 335"},Ht("path",{d:"M329.337 227.84c-2.1 1.3-8.1 2.1-11.9 2.1-12.4 0-27.6-5.7-49.1-14.9 8.3-.6 15.8-.9 22.6-.9 12.4 0 16 0 28.2 3.1 12.1 3 12.2 9.3 10.2 10.6zm-215.1 1.9c4.8-8.4 9.7-17.3 14.7-26.8 12.2-23.1 20-41.3 25.7-56.2 11.5 20.9 25.8 38.6 42.5 52.8 2.1 1.8 4.3 3.5 6.7 5.3-34.1 6.8-63.6 15-89.6 24.9zm39.8-218.9c6.8 0 10.7 17.06 11 33.16.3 16-3.4 27.2-8.1 35.6-3.9-12.4-5.7-31.8-5.7-44.5 0 0-.3-24.26 2.8-24.26zm-133.4 307.2c3.9-10.5 19.1-31.3 41.6-49.8 1.4-1.1 4.9-4.4 8.1-7.4-23.5 37.6-39.3 52.5-49.7 57.2zm315.2-112.3c-6.8-6.7-22-10.2-45-10.5-15.6-.2-34.3 1.2-54.1 3.9-8.8-5.1-17.9-10.6-25.1-17.3-19.2-18-35.2-42.9-45.2-70.3.6-2.6 1.2-4.8 1.7-7.1 0 0 10.8-61.5 7.9-82.3-.4-2.9-.6-3.7-1.4-5.9l-.9-2.5c-2.9-6.76-8.7-13.96-17.8-13.57l-5.3-.17h-.1c-10.1 0-18.4 5.17-20.5 12.84-6.6 24.3.2 60.5 12.5 107.4l-3.2 7.7c-8.8 21.4-19.8 43-29.5 62l-1.3 2.5c-10.2 20-19.5 37-27.9 51.4l-8.7 4.6c-.6.4-15.5 8.2-19 10.3-29.6 17.7-49.28 37.8-52.54 53.8-1.04 5-.26 11.5 5.01 14.6l8.4 4.2c3.63 1.8 7.53 2.7 11.43 2.7 21.1 0 45.6-26.2 79.3-85.1 39-12.7 83.4-23.3 122.3-29.1 29.6 16.7 66 28.3 89 28.3 4.1 0 7.6-.4 10.5-1.2 4.4-1.1 8.1-3.6 10.4-7.1 4.4-6.7 5.4-15.9 4.1-25.4-.3-2.8-2.6-6.3-5-8.7z"}))},Zt=function(t){var e={color:"#cbcbcb",icon:""};if(!t)return e;var r=t.split("/")[0],n=t.split("/")[1];return"text"===r?{color:"#cbcbcb",icon:Yt()}:"audio"===r?{color:"#1abc9c",icon:Jt()}:"video"===r?{color:"#2980b9",icon:$t()}:"application"===r&&"pdf"===n?{color:"#e74c3c",icon:Qt()}:"image"===r?{color:"#f2f2f2",icon:""}:e},te=k.h,ee=function(t){var e=t.file;if(e.preview)return te("img",{class:"uppy-DashboardItem-previewImg",alt:e.name,src:e.preview});var r=Zt(e.type),n=r.color,o=r.icon;return te("div",{class:"uppy-DashboardItem-previewIconWrap"},te("span",{class:"uppy-DashboardItem-previewIcon",style:{color:n}},o),te("svg",{class:"uppy-DashboardItem-previewIconBg",width:"72",height:"93",viewBox:"0 0 72 93"},te("g",null,te("path",{d:"M24.08 5h38.922A2.997 2.997 0 0 1 66 8.003v74.994A2.997 2.997 0 0 1 63.004 86H8.996A2.998 2.998 0 0 1 6 83.01V22.234L24.08 5z",fill:"#FFF"}),te("path",{d:"M24 5L6 22.248h15.007A2.995 2.995 0 0 0 24 19.244V5z",fill:"#E4E4E4"}))))},re=k.h,ne=function(t){function e(r){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.meta={},n.tempStoreMetaOrSubmit=n.tempStoreMetaOrSubmit.bind(n),n.renderMetaFields=n.renderMetaFields.bind(n),n.handleSave=n.handleSave.bind(n),n.handleCancel=n.handleCancel.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.tempStoreMetaOrSubmit=function(t){var e=this.props.files[this.props.fileCardFor];if(13===t.keyCode)return t.stopPropagation(),t.preventDefault(),void this.props.saveFileCard(this.meta,e.id);var r=t.target.value,n=t.target.dataset.name;this.meta[n]=r},e.prototype.renderMetaFields=function(t){var e=this;return(this.props.metaFields||[]).map(function(r){return re("fieldset",{class:"uppy-DashboardFileCard-fieldset"},re("label",{class:"uppy-DashboardFileCard-label"},r.name),re("input",{class:"uppy-c-textInput uppy-DashboardFileCard-input",type:"text","data-name":r.id,value:t.meta[r.id],placeholder:r.placeholder,onkeyup:e.tempStoreMetaOrSubmit,onkeydown:e.tempStoreMetaOrSubmit,onkeypress:e.tempStoreMetaOrSubmit}))})},e.prototype.handleSave=function(t){var e=this.props.fileCardFor;this.props.saveFileCard(this.meta,e)},e.prototype.handleCancel=function(t){this.meta={},this.props.toggleFileCard()},e.prototype.render=function(){if(!this.props.fileCardFor)return re("div",{class:"uppy-DashboardFileCard","aria-hidden":!0});var t=this.props.files[this.props.fileCardFor];return re("div",{class:"uppy-DashboardFileCard","aria-hidden":!this.props.fileCardFor},re("div",{style:{width:"100%",height:"100%"}},re("div",{class:"uppy-DashboardContent-bar"},re("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},this.props.i18nArray("editing",{file:re("span",{class:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),re("button",{class:"uppy-DashboardContent-back",type:"button",title:this.props.i18n("finishEditingFile"),onclick:this.handleSave},this.props.i18n("done"))),re("div",{class:"uppy-DashboardFileCard-inner"},re("div",{class:"uppy-DashboardFileCard-preview",style:{backgroundColor:Zt(t.type).color}},re(ee,{file:t})),re("div",{class:"uppy-DashboardFileCard-info"},this.renderMetaFields(t)),re("div",{class:"uppy-Dashboard-actions"},re("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-actionsBtn",type:"button",onclick:this.handleSave},this.props.i18n("saveChanges")),re("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-actionsBtn",type:"button",onclick:this.handleCancel},this.props.i18n("cancel"))))))},e}(k.Component),oe=k.h,ie=function(t){function e(r){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.handleClick=n.handleClick.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(){var t=this,e=oe("button",{type:"button",class:"uppy-Dashboard-browse",onclick:this.handleClick},this.props.i18n("browse"));return oe("span",null,0===this.props.acquirers.length?this.props.i18nArray("dropPaste",{browse:e}):this.props.i18nArray("dropPasteImport",{browse:e}),oe("input",{class:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabindex:-1,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,onchange:this.props.handleInputChange,accept:this.props.allowedFileTypes,value:"",ref:function(e){t.input=e}}))},e}(k.Component),se=k.h,ae=2*Math.PI*15,le=function(t){return se("svg",{width:"70",height:"70",viewBox:"0 0 36 36",class:"UppyIcon UppyIcon-progressCircle"},se("g",{class:"progress-group"},se("circle",{class:"bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),se("circle",{class:"progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)","stroke-width":"2",fill:"none","stroke-dasharray":ae,"stroke-dashoffset":ae-ae/100*t.progress})),t.hidePauseResumeCancelButtons||t.bundled?null:se("g",null,se("polygon",{class:"play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}),se("g",{class:"pause",transform:"translate(14.5, 13)"},se("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),se("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})),se("polygon",{class:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})),se("polygon",{class:"check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"}))},ue=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pe=Gt,ce=Xt,he=Vt,de=k.h,fe=function(t){if(!t.hideRetryButton||!t.error)return t.isUploaded||t.bundled||t.hidePauseResumeCancelButtons&&!t.error?de("div",{class:"uppy-DashboardItem-progressIndicator"},de(le,{progress:t.file.progress.percentage,fileID:t.file.id,hidePauseResumeCancelButtons:t.hidePauseResumeCancelButtons,bundled:t.bundled})):de("button",{class:"uppy-DashboardItem-progressIndicator",type:"button","aria-label":t.progressIndicatorTitle,title:t.progressIndicatorTitle,onclick:t.onPauseResumeCancelRetry},t.error?t.hideRetryButton?null:he():de(le,{progress:t.file.progress.percentage,fileID:t.file.id,hidePauseResumeCancelButtons:t.hidePauseResumeCancelButtons}))},ye=function(t){var e,r,n=t.file,o=t.acquirers,i=n.progress.preprocess||n.progress.postprocess,s=n.progress.uploadComplete&&!i&&!n.error,a=n.progress.uploadStarted||i,l=n.progress.uploadStarted&&!n.progress.uploadComplete||i,u=n.isPaused||!1,p=n.error||!1,c=j(n.meta.name).name,h=t.isWide?(r=14,(e=c).length>r?e.substr(0,r/2)+"..."+e.substr(e.length-r/4,e.length):e):c,d=qt("uppy-DashboardItem",{"is-inprogress":l},{"is-processing":i},{"is-complete":s},{"is-paused":u},{"is-error":p},{"is-resumable":t.resumableUploads},{"is-bundled":t.bundledUpload}),f=s?t.i18n("uploadComplete"):t.resumableUploads?n.isPaused?t.i18n("resumeUpload"):t.i18n("pauseUpload"):p?t.i18n("retryUpload"):t.i18n("cancelUpload");return de("li",{class:d,id:"uppy_"+n.id,title:n.meta.name},de("div",{class:"uppy-DashboardItem-preview"},de("div",{class:"uppy-DashboardItem-previewInnerWrap",style:{backgroundColor:Zt(n.type).color}},t.showLinkToFileUploadResult&&n.uploadURL?de("a",{class:"uppy-DashboardItem-previewLink",href:n.uploadURL,rel:"noreferrer noopener",target:"_blank"}):null,de(ee,{file:n})),de("div",{class:"uppy-DashboardItem-progress"},de(fe,ue({progressIndicatorTitle:f,onPauseResumeCancelRetry:function(e){s||(!p||t.hideRetryButton?t.hidePauseResumeCancelButtons||(t.resumableUploads?t.pauseUpload(n.id):t.cancelUpload(n.id)):t.retryUpload(n.id))},file:n,error:p},t)))),de("div",{class:"uppy-DashboardItem-info"},de("div",{class:"uppy-DashboardItem-name",title:c},t.showLinkToFileUploadResult&&n.uploadURL?de("a",{href:n.uploadURL,rel:"noreferrer noopener",target:"_blank"},n.extension?h+"."+n.extension:h):n.extension?h+"."+n.extension:h),de("div",{class:"uppy-DashboardItem-status"},n.data.size?de("div",{class:"uppy-DashboardItem-statusSize"},P(n.data.size)):null,n.source&&de("div",{class:"uppy-DashboardItem-sourceIcon"},o.map(function(e){if(e.id===n.source)return de("span",{title:t.i18n("fileSource",{name:e.name})},e.icon())}))),!a&&t.metaFields&&t.metaFields.length?de("button",{class:"uppy-DashboardItem-edit",type:"button","aria-label":t.i18n("editFile"),title:t.i18n("editFile"),onclick:function(e){return t.toggleFileCard(n.id)}},pe()):null,t.showLinkToFileUploadResult&&n.uploadURL?de("button",{class:"uppy-DashboardItem-copyLink",type:"button","aria-label":t.i18n("copyLink"),title:t.i18n("copyLink"),onclick:function(){var e,r;(e=n.uploadURL,r=t.i18n("copyLinkToClipboardFallback"),r=r||"Copy the URL below",new Promise(function(t){var n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=e,document.body.appendChild(n),n.select();var o=function(){document.body.removeChild(n),window.prompt(r,e),t()};try{return document.execCommand("copy")?(document.body.removeChild(n),t()):o()}catch(t){return document.body.removeChild(n),o()}})).then(function(){t.log("Link copied to clipboard."),t.info(t.i18n("copyLinkToClipboardSuccess"),"info",3e3)}).catch(t.log)}},ce()):""),de("div",{class:"uppy-DashboardItem-action"},!s&&de("button",{class:"uppy-DashboardItem-remove",type:"button","aria-label":t.i18n("removeFile"),title:t.i18n("removeFile"),onclick:function(){return t.removeFile(n.id)}},de("svg",{"aria-hidden":"true",class:"UppyIcon",width:"60",height:"60",viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg"},de("path",{stroke:"#FFF","stroke-width":"1","fill-rule":"nonzero","vector-effect":"non-scaling-stroke",d:"M30 1C14 1 1 14 1 30s13 29 29 29 29-13 29-29S46 1 30 1z"}),de("path",{fill:"#FFF","vector-effect":"non-scaling-stroke",d:"M42 39.667L39.667 42 30 32.333 20.333 42 18 39.667 27.667 30 18 20.333 20.333 18 30 27.667 39.667 18 42 20.333 32.333 30z"})))))},ge=k.h,me=function(t){var e=0===t.totalFileCount,r=qt("uppy-Dashboard-files",{"uppy-Dashboard-files--noFiles":e});return ge("ul",{class:r},e&&ge("div",{class:"uppy-Dashboard-bgIcon"},ge("div",{class:"uppy-Dashboard-dropFilesTitle"},ge(ie,{acquirers:t.acquirers,handleInputChange:t.handleInputChange,i18n:t.i18n,i18nArray:t.i18nArray,allowedFileTypes:t.allowedFileTypes,maxNumberOfFiles:t.maxNumberOfFiles})),t.note&&ge("div",{class:"uppy-Dashboard-note"},t.note),t.proudlyDisplayPoweredByUppy&&ge("a",{tabindex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",class:"uppy-Dashboard-poweredBy"},"Powered by ",ge("svg",{"aria-hidden":"true",class:"UppyIcon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",xmlns:"http://www.w3.org/2000/svg"},ge("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z","fill-rule":"evenodd"})),ge("span",{class:"uppy-Dashboard-poweredByUppy"},"Uppy"))),Object.keys(t.files).map(function(e){return ge(ye,{acquirers:t.acquirers,file:t.files[e],toggleFileCard:t.toggleFileCard,showProgressDetails:t.showProgressDetails,info:t.info,log:t.log,i18n:t.i18n,removeFile:t.removeFile,pauseUpload:t.pauseUpload,cancelUpload:t.cancelUpload,retryUpload:t.retryUpload,hidePauseResumeCancelButtons:t.hidePauseResumeCancelButtons,hideRetryButton:t.hideRetryButton,resumableUploads:t.resumableUploads,bundled:t.bundled,isWide:t.isWide,showLinkToFileUploadResult:t.showLinkToFileUploadResult,metaFields:t.metaFields})}))},ve=Kt,be=k.h,we=function(t){function e(r){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.handleClick=n.handleClick.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(){var t=this,e=0===Object.keys(this.props.files).length;return 0!==this.props.acquirers.length?be("div",{class:"uppy-DashboardTabs"},be("ul",{class:"uppy-DashboardTabs-list",role:"tablist"},be("li",{class:"uppy-DashboardTab",role:"presentation"},be("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,onclick:this.handleClick},ve(),be("div",{class:"uppy-DashboardTab-name"},this.props.i18n("myDevice"))),be("input",{class:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabindex:-1,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,accept:this.props.allowedFileTypes,onchange:this.props.handleInputChange,value:"",ref:function(e){t.input=e}})),this.props.acquirers.map(function(e){return be("li",{class:"uppy-DashboardTab",role:"presentation"},be("button",{class:"uppy-DashboardTab-btn",type:"button",role:"tab",tabindex:0,"aria-controls":"uppy-DashboardContent-panel--"+e.id,"aria-selected":t.props.activePanel.id===e.id,onclick:function(){return t.props.showPanel(e.id)}},e.icon(),be("div",{class:"uppy-DashboardTab-name"},e.name)))}))):be("div",{class:"uppy-DashboardTabs","aria-hidden":e},be("div",{class:"uppy-DashboardTabs-title"},be(ie,{acquirers:this.props.acquirers,handleInputChange:this.props.handleInputChange,i18n:this.props.i18n,i18nArray:this.props.i18nArray})))},e}(k.Component),Se=k.h,Pe=function(t){return Se("div",{style:{width:"100%",height:"100%"}},Se("div",{class:"uppy-DashboardContent-bar"},Se("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},t.i18n("importFrom",{name:t.activePanel.name})),Se("button",{class:"uppy-DashboardContent-back",type:"button",onclick:t.hideAllPanels},t.i18n("done"))),t.getPlugin(t.activePanel.id).render(t.state))},ke=function(t){var e=qt({"uppy-Root":t.isTargetDOMEl},"uppy-Dashboard",{"Uppy--isTouchDevice":"ontouchstart"in window||navigator.maxTouchPoints},{"uppy-Dashboard--animateOpenClose":t.animateOpenClose},{"uppy-Dashboard--isClosing":t.isClosing},{"uppy-Dashboard--modal":!t.inline},{"uppy-Dashboard--wide":t.isWide});return Se("div",{class:e,"aria-hidden":t.inline?"false":t.modal.isHidden,"aria-label":t.inline?t.i18n("dashboardTitle"):t.i18n("dashboardWindowTitle"),onpaste:t.handlePaste},Se("div",{class:"uppy-Dashboard-overlay",tabindex:-1,onclick:t.handleClickOutside}),Se("div",{class:"uppy-Dashboard-inner","aria-modal":!t.inline&&"true",role:!t.inline&&"dialog",style:{width:t.inline&&t.width?t.width:"",height:t.inline&&t.height?t.height:""}},Se("button",{class:"uppy-Dashboard-close",type:"button","aria-label":t.i18n("closeModal"),title:t.i18n("closeModal"),onclick:t.closeModal},Se("span",{"aria-hidden":"true"},"\xd7")),Se("div",{class:"uppy-Dashboard-innerWrap"},Se(we,t),Se(ne,t),Se("div",{class:"uppy-Dashboard-filesContainer"},Se(me,t)),Se("div",{class:"uppy-DashboardContent-panel",role:"tabpanel",id:t.activePanel&&"uppy-DashboardContent-panel--"+t.activePanel.id,"aria-hidden":t.activePanel?"false":"true"},t.activePanel&&Se(Pe,t)),Se("div",{class:"uppy-Dashboard-progressindicators"},t.progressindicators.map(function(e){return t.getPlugin(e.id).render(t.state)})))))},_e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ee=z.Plugin,Ce=k.h,Ue=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="progressindicator",o.id=o.opts.id||"Informer",o.title="Informer",o.opts=_e({},{typeColors:{info:{text:"#fff",bg:"#000"},warning:{text:"#fff",bg:"#F6A623"},error:{text:"#fff",bg:"#D32F2F"},success:{text:"#fff",bg:"#1BB240"}}},n),o.render=o.render.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t){var e=t.info,r=e.isHidden,n=e.type,o=e.message,i=e.details,s={backgroundColor:this.opts.typeColors[n].bg,color:this.opts.typeColors[n].text};return Ce("div",{class:"uppy uppy-Informer",style:s,"aria-hidden":r},Ce("p",{role:"alert"},o," ",i&&Ce("span",{style:{color:this.opts.typeColors[n].bg},"aria-label":i,"data-microtip-position":"top","data-microtip-size":"large",role:"tooltip"},"?")))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e}(Ee),Te="error",Fe="waiting",Oe="preprocessing",Ae="uploading",xe="postprocessing",Re="complete",De=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ie=k.h,Be=function(t){var e=qt("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":t.uploadState===Fe});return Ie("button",{type:"button",class:e,"aria-label":t.i18n("uploadXFiles",{smart_count:t.newFiles}),onclick:t.startUpload},t.newFiles&&t.uploadStarted?t.i18n("uploadXNewFiles",{smart_count:t.newFiles}):t.i18n("uploadXFiles",{smart_count:t.newFiles}))},je=function(t){return Ie("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t.i18n("retryUpload"),onclick:t.retryAll},t.i18n("retry"))},Me=function(t){return Ie("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--cancel","aria-label":t.i18n("cancel"),onclick:t.cancelAll},t.i18n("cancel"))},Le=function(t){var e=t.resumableUploads,r=t.isAllPaused,n=(0,t.i18n)(e?r?"resumeUpload":"pauseUpload":"cancelUpload");return Ie("button",{title:n,class:"uppy-u-reset uppy-StatusBar-statusIndicator",type:"button",onclick:function(){return function(t){if(!t.isAllComplete)return t.resumableUploads?t.isAllPaused?t.resumeAll():t.pauseAll():t.cancelAll()}(t)}},e?r?Ie("svg",{"aria-hidden":"true",class:"UppyIcon",width:"15",height:"17",viewBox:"0 0 11 13"},Ie("path",{d:"M1.26 12.534a.67.67 0 0 1-.674.012.67.67 0 0 1-.336-.583v-11C.25.724.38.5.586.382a.658.658 0 0 1 .673.012l9.165 5.5a.66.66 0 0 1 .325.57.66.66 0 0 1-.325.573l-9.166 5.5z"})):Ie("svg",{"aria-hidden":"true",class:"UppyIcon",width:"16",height:"17",viewBox:"0 0 12 13"},Ie("path",{d:"M4.888.81v11.38c0 .446-.324.81-.722.81H2.722C2.324 13 2 12.636 2 12.19V.81c0-.446.324-.81.722-.81h1.444c.398 0 .722.364.722.81zM9.888.81v11.38c0 .446-.324.81-.722.81H7.722C7.324 13 7 12.636 7 12.19V.81c0-.446.324-.81.722-.81h1.444c.398 0 .722.364.722.81z"})):Ie("svg",{"aria-hidden":"true",class:"UppyIcon",width:"16px",height:"16px",viewBox:"0 0 19 19"},Ie("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"})))},Ne=function(t){var e=Math.round(100*t.value);return Ie("div",{class:"uppy-StatusBar-content"},"determinate"===t.mode?e+"% \xb7 ":"",t.message)},ze=tt(function(t){return Ie("span",{class:"uppy-StatusBar-statusSecondary"},t.inProgress>1&&t.i18n("filesUploadedOfTotal",{complete:t.complete,smart_count:t.inProgress})+" \xb7 ",t.i18n("dataUploadedOfTotal",{complete:t.totalUploadedSize,total:t.totalSize})+" \xb7 ",t.i18n("xTimeLeft",{time:t.totalETA}))},500,{leading:!0,trailing:!0}),qe=function(t){if(!t.isUploadStarted||t.isAllComplete)return null;var e=t.isAllPaused?t.i18n("paused"):t.i18n("uploading");return Ie("div",{class:"uppy-StatusBar-content","aria-label":e,title:e},!t.hidePauseResumeCancelButtons&&Ie(Le,t),Ie("div",{class:"uppy-StatusBar-status"},Ie("span",{class:"uppy-StatusBar-statusPrimary"},e,": ",t.totalProgress,"%"),Ie("br",null),!t.isAllPaused&&Ie(ze,t)))},He=function(t){t.totalProgress;var e=t.i18n;return Ie("div",{class:"uppy-StatusBar-content",role:"status",title:e("complete")},Ie("svg",{"aria-hidden":"true",class:"uppy-StatusBar-statusIndicator UppyIcon",width:"18",height:"17",viewBox:"0 0 23 17"},Ie("path",{d:"M8.944 17L0 7.865l2.555-2.61 6.39 6.525L20.41 0 23 2.645z"})),e("complete"))},We=function(t){var e=t.error,r=(t.retryAll,t.hideRetryButton),n=t.i18n;return Ie("div",{class:"uppy-StatusBar-content",role:"alert"},Ie("strong",{class:"uppy-StatusBar-contentPadding"},n("uploadFailed"),"."),!r&&Ie("span",{class:"uppy-StatusBar-contentPadding"},n("pleasePressRetry")),Ie("span",{class:"uppy-StatusBar-details","aria-label":e,"data-microtip-position":"top","data-microtip-size":"large",role:"tooltip"},"?"))},Xe=function(t){var e,r=(e=t,{hours:Math.floor(e/3600)%24,minutes:Math.floor(e/60)%60,seconds:Math.floor(e%60)}),n=r.hours?r.hours+"h ":"",o=r.hours?("0"+r.minutes).substr(-2):r.minutes;return n+(o?o+"m ":"")+(o?("0"+r.seconds).substr(-2):r.seconds)+"s"},Ve=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ge=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.id=o.opts.id||"StatusBar",o.title="StatusBar",o.type="progressindicator";var i={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",pleasePressRetry:"Please press Retry to upload again",paused:"Paused",error:"Error",retry:"Retry",cancel:"Cancel",pressToRetry:"Press to retry",retryUpload:"Retry upload",resumeUpload:"Resume upload",cancelUpload:"Cancel upload",pauseUpload:"Pause upload",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"}}},s={target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeCancelButtons:!1,showProgressDetails:!1,locale:i,hideAfterFinish:!0};return o.opts=Ve({},s,n),o.locale=Ve({},i,o.opts.locale),o.locale.strings=Ve({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.startUpload=o.startUpload.bind(o),o.render=o.render.bind(o),o.install=o.install.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getTotalSpeed=function(t){var e=0;return t.forEach(function(t){e+=function(t){if(!t.bytesUploaded)return 0;var e=new Date-t.uploadStarted;return t.bytesUploaded/(e/1e3)}(t.progress)}),e},e.prototype.getTotalETA=function(t){var e=this.getTotalSpeed(t);if(0===e)return 0;var r=t.reduce(function(t,e){return t+((r=e.progress).bytesTotal-r.bytesUploaded);var r},0);return Math.round(r/e*10)/10},e.prototype.startUpload=function(){var t=this;return this.uppy.upload().catch(function(e){t.uppy.log(e.stack||e.message||e)})},e.prototype.getUploadingState=function(t,e,r){if(t)return Te;if(e)return Re;for(var n=Fe,o=Object.keys(r),i=0;i<o.length;i++){var s=r[o[i]].progress;if(s.uploadStarted&&!s.uploadComplete)return Ae;s.preprocess&&n!==Ae&&(n=Oe),s.postprocess&&n!==Ae&&n!==Oe&&(n=xe)}return n},e.prototype.render=function(t){var e=t.files,r=Object.keys(e).filter(function(t){return e[t].progress.uploadStarted}),n=Object.keys(e).filter(function(t){return!e[t].progress.uploadStarted&&!e[t].progress.preprocess&&!e[t].progress.postprocess}),o=Object.keys(e).filter(function(t){return e[t].progress.uploadComplete}),i=Object.keys(e).filter(function(t){return e[t].error}),s=Object.keys(e).filter(function(t){return!e[t].progress.uploadComplete&&e[t].progress.uploadStarted&&!e[t].isPaused}),a=Object.keys(e).filter(function(t){return e[t].progress.preprocess||e[t].progress.postprocess}),l=s.map(function(t){return e[t]}),u=P(this.getTotalSpeed(l)),p=Xe(this.getTotalETA(l)),c=0,h=0;l.forEach(function(t){c+=t.progress.bytesTotal||0,h+=t.progress.bytesUploaded||0}),c=P(c),h=P(h);var d=r.length>0,f=100===t.totalProgress&&o.length===Object.keys(e).length&&0===a.length,y=d&&i.length===r.length,g=0===s.length&&!f&&!y&&r.length>0,m=t.capabilities.resumableUploads||!1;return function(t){var e=(t=t||{}).uploadState,r=t.totalProgress,n=void 0,o=void 0;if(e===Oe||e===xe){var i=function(t){var e=[];Object.keys(t).forEach(function(r){var n=t[r].progress;n.preprocess&&e.push(n.preprocess),n.postprocess&&e.push(n.postprocess)});var r=e[0];return{mode:r.mode,message:r.message,value:e.filter(function(t){return"determinate"===t.mode}).reduce(function(t,e,r,n){return t+e.value/n.length},0)}}(t.files);"determinate"===(n=i.mode)&&(r=100*i.value),o=Ne(i)}else e===Re?o=He(t):e===Ae?o=qe(t):e===Te&&(r=void 0,o=We(t));var s="number"==typeof r?r:100,a=e===Fe&&t.hideUploadButton||e===Fe&&!t.newFiles>0||e===Re&&t.hideAfterFinish,l="uppy-StatusBar-progress\n                           "+(n?"is-"+n:""),u=qt("uppy","uppy-StatusBar","is-"+e,{"uppy-StatusBar--detailedProgress":t.showProgressDetails});return Ie("div",{class:u,"aria-hidden":a},Ie("div",{class:l,style:{width:s+"%"},role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":r}),o,Ie("div",{class:"uppy-StatusBar-actions"},t.newFiles&&!t.hideUploadButton?Ie(Be,De({},t,{uploadState:e})):null,t.error&&!t.hideRetryButton?Ie(je,t):null,t.hidePauseResumeCancelButtons||e===Fe||e===Re?null:Ie(Me,t)))}({error:t.error,uploadState:this.getUploadingState(y,f,t.files||{}),totalProgress:t.totalProgress,totalSize:c,totalUploadedSize:h,uploadStarted:r.length,isAllComplete:f,isAllPaused:g,isAllErrored:y,isUploadStarted:d,complete:o.length,newFiles:n.length,inProgress:s.length,totalSpeed:u,totalETA:p,files:t.files,i18n:this.i18n,pauseAll:this.uppy.pauseAll,resumeAll:this.uppy.resumeAll,retryAll:this.uppy.retryAll,cancelAll:this.uppy.cancelAll,startUpload:this.startUpload,resumableUploads:m,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeCancelButtons:this.opts.hidePauseResumeCancelButtons,hideAfterFinish:this.opts.hideAfterFinish})},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(z.Plugin),Ke=function(t,e,r){var n=t.split(",")[1],o=e.mimeType||t.split(",")[0].split(":")[1].split(";")[0];null==o&&(o="plain/text");for(var i=atob(n),s=[],a=0;a<i.length;a++)s.push(i.charCodeAt(a));return r?new File([new Uint8Array(s)],e.name||"",{type:o}):new Blob([new Uint8Array(s)],{type:o})},Ye=function(t){if(!t)return!1;var e=t.split("/")[1];return!!/^(jpeg|gif|png|svg|svg\+xml|bmp)$/.test(e)},Je=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$e=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="thumbnail",o.id=o.opts.id||"ThumbnailGenerator",o.title="Thumbnail Generator",o.queue=[],o.queueProcessing=!1,o.opts=Je({},{thumbnailWidth:200},n),o.addToQueue=o.addToQueue.bind(o),o.onRestored=o.onRestored.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createThumbnail=function(t,e){var r=this,n=URL.createObjectURL(t.data);return new Promise(function(t,e){var r=new Image;r.src=n,r.onload=function(){URL.revokeObjectURL(n),t(r)},r.onerror=function(){URL.revokeObjectURL(n),e(new Error("Could not create thumbnail"))}}).then(function(t){var n=r.getProportionalHeight(t,e),o=r.resizeImage(t,e,n);return r.canvasToBlob(o,"image/png")}).then(function(t){return URL.createObjectURL(t)})},e.prototype.protect=function(t){var e=t.width/t.height,r=Math.floor(Math.sqrt(5e6*e)),n=Math.floor(5e6/Math.sqrt(5e6*e));if(r>4096&&(r=4096,n=Math.round(r/e)),n>4096&&(n=4096,r=Math.round(e*n)),t.width>r){var o=document.createElement("canvas");o.width=r,o.height=n,o.getContext("2d").drawImage(t,0,0,r,n),t.src="about:blank",t.width=1,t.height=1,t=o}return t},e.prototype.resizeImage=function(t,e,r){t=this.protect(t);var n=Math.ceil(Math.log(t.width/e)*Math.LOG2E);n<1&&(n=1);for(var o=e*Math.pow(2,n-1),i=r*Math.pow(2,n-1);n--;){var s=document.createElement("canvas");s.width=o,s.height=i,s.getContext("2d").drawImage(t,0,0,o,i),t=s,o=Math.round(o/2),i=Math.round(i/2)}return t},e.prototype.canvasToBlob=function(t,e,r){return t.toBlob?new Promise(function(n){t.toBlob(n,e,r)}):Promise.resolve().then(function(){return Ke(t.toDataURL(e,r),{})})},e.prototype.getProportionalHeight=function(t,e){var r=t.width/t.height;return Math.round(e/r)},e.prototype.setPreviewURL=function(t,e){this.uppy.setFileState(t,{preview:e})},e.prototype.addToQueue=function(t){this.queue.push(t),!1===this.queueProcessing&&this.processQueue()},e.prototype.processQueue=function(){var t=this;if(this.queueProcessing=!0,this.queue.length>0){var e=this.queue.shift();return this.requestThumbnail(e).catch(function(t){}).then(function(){return t.processQueue()})}this.queueProcessing=!1},e.prototype.requestThumbnail=function(t){var e=this;return Ye(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth).then(function(r){e.setPreviewURL(t.id,r)}).catch(function(t){console.warn(t.stack||t.message)}):Promise.resolve()},e.prototype.onRestored=function(){var t=this;Object.keys(this.uppy.getState().files).forEach(function(e){var r=t.uppy.getFile(e);r.isRestored&&(r.preview&&!/^blob:/.test(r.preview)||t.addToQueue(r))})},e.prototype.install=function(){this.uppy.on("file-added",this.addToQueue),this.uppy.on("restored",this.onRestored)},e.prototype.uninstall=function(){this.uppy.off("file-added",this.addToQueue),this.uppy.off("restored",this.onRestored)},e}(z.Plugin),Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze=function(t){if("string"==typeof t){var e=[].slice.call(document.querySelectorAll(t));return e.length>0?e:null}if("object"===(void 0===t?"undefined":Qe(t))&&E(t))return[t]},tr=function(t){return Array.prototype.slice.call(t||[],0)},er=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rr=Wt,nr=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'],or=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.id=o.opts.id||"Dashboard",o.title="Dashboard",o.type="orchestrator",o.modalName="uppy-Dashboard";var i={strings:{selectToUpload:"Select files to upload",closeModal:"Close Modal",upload:"Upload",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",fileSource:"File source: %{name}",done:"Done",name:"Name",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",finishEditingFile:"Finish editing file",saveChanges:"Save changes",cancel:"Cancel",localDisk:"Local Disk",myDevice:"My Device",dropPasteImport:"Drop files here, paste, import from one of the locations above or %{browse}",dropPaste:"Drop files here, paste or %{browse}",browse:"browse",fileProgress:"File progress: upload speed and ETA",numberOfSelectedFiles:"Number of selected files",uploadAllNewFiles:"Upload all new files",emptyFolderAdded:"No files were added from empty folder",uploadComplete:"Upload complete",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}},s={target:"body",metaFields:[],trigger:"#uppy-select-files",inline:!1,width:750,height:550,thumbnailWidth:280,defaultTabIcon:rr,showLinkToFileUploadResult:!0,showProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeCancelButtons:!1,hideProgressAfterFinish:!1,note:null,closeModalOnClickOutside:!1,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:function(){return o.closeModal()},locale:i,browserBackButtonClose:!1};return o.opts=er({},s,n),o.locale=er({},i,o.opts.locale),o.locale.strings=er({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.i18nArray=o.translator.translateArray.bind(o.translator),o.openModal=o.openModal.bind(o),o.closeModal=o.closeModal.bind(o),o.requestCloseModal=o.requestCloseModal.bind(o),o.isModalOpen=o.isModalOpen.bind(o),o.addTarget=o.addTarget.bind(o),o.removeTarget=o.removeTarget.bind(o),o.hideAllPanels=o.hideAllPanels.bind(o),o.showPanel=o.showPanel.bind(o),o.getFocusableNodes=o.getFocusableNodes.bind(o),o.setFocusToFirstNode=o.setFocusToFirstNode.bind(o),o.handlePopState=o.handlePopState.bind(o),o.maintainFocus=o.maintainFocus.bind(o),o.initEvents=o.initEvents.bind(o),o.onKeydown=o.onKeydown.bind(o),o.handleClickOutside=o.handleClickOutside.bind(o),o.toggleFileCard=o.toggleFileCard.bind(o),o.handleDrop=o.handleDrop.bind(o),o.handlePaste=o.handlePaste.bind(o),o.handleInputChange=o.handleInputChange.bind(o),o.updateDashboardElWidth=o.updateDashboardElWidth.bind(o),o.render=o.render.bind(o),o.install=o.install.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.removeTarget=function(t){var e=this.getPluginState().targets.filter(function(e){return e.id!==t.id});this.setPluginState({targets:e})},e.prototype.addTarget=function(t){var e=t.id||t.constructor.name,r=t.title||e,n=t.type;if("acquirer"===n||"progressindicator"===n||"presenter"===n){var o={id:e,name:r,type:n},i=this.getPluginState().targets.slice();return i.push(o),this.setPluginState({targets:i}),this.el}this.uppy.log("Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter")},e.prototype.hideAllPanels=function(){this.setPluginState({activePanel:!1})},e.prototype.showPanel=function(t){var e=this.getPluginState().targets.filter(function(e){return"acquirer"===e.type&&e.id===t})[0];this.setPluginState({activePanel:e})},e.prototype.requestCloseModal=function(){if(this.opts.onRequestCloseModal)return this.opts.onRequestCloseModal();this.closeModal()},e.prototype.getFocusableNodes=function(){var t=this.el.querySelectorAll(nr);return Object.keys(t).map(function(e){return t[e]})},e.prototype.setFocusToFirstNode=function(){var t=this.getFocusableNodes();t.length&&t[0].focus()},e.prototype.updateBrowserHistory=function(){var t;history.state&&history.state[this.modalName]||history.pushState(((t={})[this.modalName]=!0,t),""),window.addEventListener("popstate",this.handlePopState,!1)},e.prototype.handlePopState=function(t){t.state&&t.state[this.modalName]||this.closeModal({manualClose:!1}),!this.isModalOpen()&&t.state&&t.state[this.modalName]&&history.go(-1)},e.prototype.setFocusToBrowse=function(){var t=this.el.querySelector(".uppy-Dashboard-browse");t&&t.focus()},e.prototype.maintainFocus=function(t){var e=this.getFocusableNodes(),r=e.indexOf(document.activeElement);t.shiftKey&&0===r&&(e[e.length-1].focus(),t.preventDefault()),t.shiftKey||r!==e.length-1||(e[0].focus(),t.preventDefault())},e.prototype.openModal=function(){this.setPluginState({isHidden:!1}),this.savedScrollPosition=window.scrollY,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.onKeydown),this.rerender(this.uppy.getState()),this.updateDashboardElWidth(),this.setFocusToBrowse()},e.prototype.closeModal=function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).manualClose,r=void 0===e||e;this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose?(this.setPluginState({isClosing:!0}),this.el.addEventListener("animationend",function e(){t.setPluginState({isHidden:!0,isClosing:!1}),t.el.removeEventListener("animationend",e,!1)},!1)):this.setPluginState({isHidden:!0}),document.removeEventListener("keydown",this.onKeydown),this.savedActiveElement.focus(),r&&this.opts.browserBackButtonClose&&history.state&&history.state[this.modalName]&&history.go(-1)},e.prototype.isModalOpen=function(){return!this.getPluginState().isHidden||!1},e.prototype.onKeydown=function(t){27===t.keyCode&&this.requestCloseModal(t),9===t.keyCode&&this.maintainFocus(t)},e.prototype.handleClickOutside=function(){this.opts.closeModalOnClickOutside&&this.requestCloseModal()},e.prototype.handlePaste=function(t){var e=this;tr(t.clipboardData.items).forEach(function(t){if("file"===t.kind){var r=t.getAsFile();if(!r)return e.uppy.log("[Dashboard] File pasted, but the file blob is empty"),void e.uppy.info("Error pasting file","error");e.uppy.log("[Dashboard] File pasted");try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:r})}catch(t){}}})},e.prototype.handleInputChange=function(t){var e=this;t.preventDefault(),tr(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.initEvents=function(){var t=this,e=Ze(this.opts.trigger);!this.opts.inline&&e&&e.forEach(function(e){return e.addEventListener("click",t.openModal)}),this.opts.inline||e||this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options unless you are planning to call openModal() method yourself"),this.removeDragDropListener=Lt(this.el,function(e){t.handleDrop(e)}),this.updateDashboardElWidth(),window.addEventListener("resize",this.updateDashboardElWidth),this.uppy.on("plugin-remove",this.removeTarget)},e.prototype.removeEvents=function(){var t=this,e=Ze(this.opts.trigger);!this.opts.inline&&e&&e.forEach(function(e){return e.removeEventListener("click",t.openModal)}),this.removeDragDropListener(),window.removeEventListener("resize",this.updateDashboardElWidth),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-remove",this.removeTarget)},e.prototype.updateDashboardElWidth=function(){var t=this.el.querySelector(".uppy-Dashboard-inner");this.uppy.log("Dashboard width: "+t.offsetWidth),this.setPluginState({containerWidth:t.offsetWidth})},e.prototype.toggleFileCard=function(t){this.setPluginState({fileCardFor:t||!1})},e.prototype.handleDrop=function(t){var e=this;this.uppy.log("[Dashboard] Files were dropped"),t.forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.render=function(t){var e=this,r=this.getPluginState(),n=t.files,o=t.capabilities,i=Object.keys(n).filter(function(t){return!n[t].progress.uploadStarted}),s=Object.keys(n).filter(function(t){return!n[t].progress.uploadComplete&&n[t].progress.uploadStarted&&!n[t].isPaused}),a=[];s.forEach(function(t){a.push(n[t])});var l=0,u=0;a.forEach(function(t){l+=t.progress.bytesTotal||0,u+=t.progress.bytesUploaded||0}),l=P(l),u=P(u);var p=function(t){var r=e.uppy.getPlugin(t.id);return er({},t,{icon:r.icon||e.opts.defaultTabIcon,render:r.render})},c=r.targets.filter(function(t){return"acquirer"===t.type&&function(t){var r=e.uppy.getPlugin(t.id);return"function"!=typeof r.isSupported||r.isSupported()}(t)}).map(p),h=r.targets.filter(function(t){return"progressindicator"===t.type}).map(p);return ke({state:t,modal:r,newFiles:i,files:n,totalFileCount:Object.keys(n).length,totalProgress:t.totalProgress,acquirers:c,activePanel:r.activePanel,animateOpenClose:this.opts.animateOpenClose,isClosing:r.isClosing,getPlugin:this.uppy.getPlugin,progressindicators:h,autoProceed:this.uppy.opts.autoProceed,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeCancelButtons:this.opts.hidePauseResumeCancelButtons,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,log:this.uppy.log,i18n:this.i18n,i18nArray:this.i18nArray,addFile:this.uppy.addFile,removeFile:this.uppy.removeFile,info:this.uppy.info,note:this.opts.note,metaFields:r.metaFields,resumableUploads:o.resumableUploads||!1,bundled:o.bundled||!1,startUpload:function(t){e.uppy.upload().catch(function(t){e.uppy.log(t.stack||t.message||t)})},pauseUpload:this.uppy.pauseResume,retryUpload:this.uppy.retryUpload,cancelUpload:function(t){e.uppy.emit("upload-cancel",t),e.uppy.removeFile(t)},fileCardFor:r.fileCardFor,toggleFileCard:this.toggleFileCard,saveFileCard:function(t,r){e.uppy.setFileMeta(r,t),e.toggleFileCard()},updateDashboardElWidth:this.updateDashboardElWidth,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,currentWidth:r.containerWidth,isWide:r.containerWidth>400,isTargetDOMEl:this.isTargetDOMEl,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles})},e.prototype.discoverProviderPlugins=function(){var t=this;this.uppy.iteratePlugins(function(e){e&&!e.target&&e.opts&&e.opts.target===t.constructor&&t.addTarget(e)})},e.prototype.install=function(){var t=this;this.setPluginState({isHidden:!0,showFileCard:!1,activePanel:!1,metaFields:this.opts.metaFields,targets:[]});var e=this.opts.target;e&&this.mount(e,this),(this.opts.plugins||[]).forEach(function(e){var r=t.uppy.getPlugin(e);r&&r.mount(t,r)}),this.opts.disableStatusBar||this.uppy.use(Ge,{id:this.id+":StatusBar",target:this,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeCancelButtons:this.opts.hidePauseResumeCancelButtons,showProgressDetails:this.opts.showProgressDetails,hideAfterFinish:this.opts.hideProgressAfterFinish,locale:this.opts.locale}),this.opts.disableInformer||this.uppy.use(Ue,{id:this.id+":Informer",target:this}),this.opts.disableThumbnailGenerator||this.uppy.use($e,{id:this.id+":ThumbnailGenerator",thumbnailWidth:this.opts.thumbnailWidth}),this.discoverProviderPlugins(),this.initEvents()},e.prototype.uninstall=function(){var t=this;if(!this.opts.disableInformer){var e=this.uppy.getPlugin(this.id+":Informer");e&&this.uppy.removePlugin(e)}if(!this.opts.disableStatusBar){var r=this.uppy.getPlugin(this.id+":StatusBar");r&&this.uppy.removePlugin(r)}if(!this.opts.disableThumbnailGenerator){var n=this.uppy.getPlugin(this.id+":ThumbnailGenerator");n&&this.uppy.removePlugin(n)}(this.opts.plugins||[]).forEach(function(e){var r=t.uppy.getPlugin(e);r&&r.unmount()}),this.unmount(),this.removeEvents()},e}(z.Plugin),ir=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sr=z.Plugin,ar=k.h,lr=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.type="acquirer",o.id=o.opts.id||"DragDrop",o.title="Drag & Drop";var i={strings:{dropHereOr:"Drop files here or %{browse}",browse:"browse"}},s={target:null,inputName:"files[]",width:"100%",height:"100%",note:null,locale:i};return o.opts=ir({},s,n),o.isDragDropSupported=o.checkDragDropSupport(),o.locale=ir({},i,o.opts.locale),o.locale.strings=ir({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.i18nArray=o.translator.translateArray.bind(o.translator),o.handleDrop=o.handleDrop.bind(o),o.handleInputChange=o.handleInputChange.bind(o),o.checkDragDropSupport=o.checkDragDropSupport.bind(o),o.render=o.render.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.checkDragDropSupport=function(){var t=document.createElement("div");return"draggable"in t&&"ondragstart"in t&&"ondrop"in t&&"FormData"in window&&"FileReader"in window},e.prototype.handleDrop=function(t){var e=this;this.uppy.log("[DragDrop] Files dropped"),t.forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.handleInputChange=function(t){var e=this;this.uppy.log("[DragDrop] Files selected through input"),tr(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.render=function(t){var e=this,r="uppy-Root uppy-DragDrop-container "+(this.isDragDropSupported?"uppy-DragDrop--is-dragdrop-supported":""),n={width:this.opts.width,height:this.opts.height},o=this.uppy.opts.restrictions;return ar("div",{class:r,style:n},ar("div",{class:"uppy-DragDrop-inner"},ar("svg",{"aria-hidden":"true",class:"UppyIcon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},ar("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0","fill-rule":"evenodd"})),ar("label",{class:"uppy-DragDrop-label"},ar("input",{style:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},class:"uppy-DragDrop-input",type:"file",name:this.opts.inputName,multiple:1!==o.maxNumberOfFiles,accept:o.allowedFileTypes,ref:function(t){e.input=t},onchange:this.handleInputChange,value:""}),this.i18nArray("dropHereOr",{browse:ar("span",{class:"uppy-DragDrop-dragText"},this.i18n("browse"))})),ar("span",{class:"uppy-DragDrop-note"},this.opts.note)))},e.prototype.install=function(){var t=this,e=this.opts.target;e&&this.mount(e,this),this.removeDragDropListener=Lt(this.el,function(e){t.handleDrop(e),t.uppy.log(e)})},e.prototype.uninstall=function(){this.unmount(),this.removeDragDropListener()},e}(sr),ur=k.h,pr={folder:function(){return ur("svg",{"aria-hidden":"true",class:"UppyIcon",style:{width:16,marginRight:3},viewBox:"0 0 276.157 276.157"},ur("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}))},file:function(){return ur("svg",{"aria-hidden":"true",class:"UppyIcon",width:11,height:14.5,viewBox:"0 0 44 58"},ur("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}))}},cr=k.h,hr=function(t){return cr("div",{class:"uppy-Provider-loading"},cr("span",null,"Loading..."))};function dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fr(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function yr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var gr=k.h,mr=k.Component,vr=function(t){function e(){return dr(this,e),fr(this,t.apply(this,arguments))}return yr(e,t),e.prototype.componentDidMount=function(){var t=this;setTimeout(function(){t.connectButton&&t.connectButton.focus({preventScroll:!0})},150)},e.prototype.render=function(){var t=this;return gr("div",{class:"uppy-Provider-auth"},gr("div",{class:"uppy-Provider-authIcon"},this.props.pluginIcon()),gr("h1",{class:"uppy-Provider-authTitle"},"Please authenticate with ",gr("span",{class:"uppy-Provider-authTitleName"},this.props.pluginName),gr("br",null)," to select files"),gr("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleAuth,ref:function(e){t.connectButton=e}},"Connect to ",this.props.pluginName),this.props.demo&&gr("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleDemoAuth},"Proceed with Demo Account"))},e}(mr),br=function(t){function e(){return dr(this,e),fr(this,t.apply(this,arguments))}return yr(e,t),e.prototype.componentDidMount=function(){this.props.checkAuth()},e.prototype.render=function(){return gr("div",{style:{height:"100%"}},this.props.checkAuthInProgress?gr(hr,null):gr(vr,this.props))},e}(mr),wr=k.h,Sr=k.h,Pr=function(t){function e(r){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.isEmpty=!0,n.handleKeyPress=n.handleKeyPress.bind(n),n.handleClear=n.handleClear.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleKeyPress=function(t){if(13===t.keyCode)return t.stopPropagation(),void t.preventDefault();this.isEmpty=!this.input.value.length>0,this.props.filterQuery(t)},e.prototype.handleClear=function(t){this.input.value="",this.props.filterQuery()},e.prototype.render=function(){var t=this;return Sr("div",{class:"uppy-u-reset uppy-ProviderBrowser-search"},Sr("svg",{class:"UppyIcon uppy-ProviderBrowser-searchIcon",viewBox:"0 0 100 100"},Sr("path",{d:"M87.533 80.03L62.942 55.439c3.324-4.587 5.312-10.207 5.312-16.295 0-.312-.043-.611-.092-.908.05-.301.093-.605.093-.922 0-15.36-12.497-27.857-27.857-27.857-.273 0-.536.043-.799.08-.265-.037-.526-.08-.799-.08-15.361 0-27.858 12.497-27.858 27.857 0 .312.042.611.092.909a5.466 5.466 0 0 0-.093.921c0 15.36 12.496 27.858 27.857 27.858.273 0 .535-.043.8-.081.263.038.524.081.798.081 5.208 0 10.071-1.464 14.245-3.963L79.582 87.98a5.603 5.603 0 0 0 3.976 1.647 5.621 5.621 0 0 0 3.975-9.597zM39.598 55.838c-.265-.038-.526-.081-.8-.081-9.16 0-16.612-7.452-16.612-16.612 0-.312-.042-.611-.092-.908.051-.301.093-.605.093-.922 0-9.16 7.453-16.612 16.613-16.612.272 0 .534-.042.799-.079.263.037.525.079.799.079 9.16 0 16.612 7.452 16.612 16.612 0 .312.043.611.092.909-.05.301-.094.604-.094.921 0 9.16-7.452 16.612-16.612 16.612-.274 0-.536.043-.798.081z"})),Sr("input",{class:"uppy-u-reset uppy-ProviderBrowser-searchInput",type:"text",placeholder:"Filter","aria-label":"Filter",onkeyup:this.handleKeyPress,onkeydown:this.handleKeyPress,onkeypress:this.handleKeyPress,value:this.props.filterInput,ref:function(e){t.input=e}}),!this.isEmpty&&Sr("button",{class:"uppy-u-reset uppy-ProviderBrowser-searchClose",type:"button",onclick:this.handleClear},Sr("svg",{class:"UppyIcon",viewBox:"0 0 19 19"},Sr("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))))},e}(k.Component),kr=k.h,_r=function(t){return kr("div",{class:"uppy-ProviderBrowser-footer"},kr("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",onclick:t.done},t.i18n("selectXFiles",{smart_count:t.selected})),kr("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onclick:t.cancel},t.i18n("cancel")))},Er=k.h,Cr=function(t){var e=function(t){13===t.keyCode&&(t.stopPropagation(),t.preventDefault())};return Er("li",{class:"uppy-ProviderBrowserItem"+(t.isChecked?" uppy-ProviderBrowserItem--selected":"")},Er("div",{class:"uppy-ProviderBrowserItem-checkbox"},Er("input",{type:"checkbox",role:"option",tabindex:0,"aria-label":"Select "+t.title,id:t.id,checked:t.isChecked,disabled:t.isDisabled,onchange:t.handleClick,onkeyup:e,onkeydown:e,onkeypress:e}),Er("label",{for:t.id,onclick:t.handleClick})),Er("button",{type:"button",class:"uppy-ProviderBrowserItem-inner","aria-label":"Select "+t.title,tabindex:0,onclick:function(e){if(e.preventDefault(),"folder"===t.type)return t.handleFolderClick(e);t.handleClick(e)}},t.getItemIcon()," ",t.showTitles&&t.title))},Ur=k.h,Tr=function(t){return t.folders.length||t.files.length?Ur("div",{class:"uppy-ProviderBrowser-body"},Ur("ul",{class:"uppy-ProviderBrowser-list",onscroll:t.handleScroll,role:"listbox","aria-label":"List of files from "+t.title},t.folders.map(function(e){var r=!1,n=t.isChecked(e);return n&&(r=n.loading),Cr({title:t.getItemName(e),id:t.getItemId(e),type:"folder",getItemIcon:function(){return t.getItemIcon(e)},isDisabled:r,isChecked:n,handleFolderClick:function(){return t.handleFolderClick(e)},handleClick:function(r){return t.toggleCheckbox(r,e)},columns:t.columns,showTitles:t.showTitles})}),t.files.map(function(e){return Cr({title:t.getItemName(e),id:t.getItemId(e),type:"file",getItemIcon:function(){return t.getItemIcon(e)},isDisabled:!1,isChecked:t.isChecked(e),handleClick:function(r){return t.toggleCheckbox(r,e)},columns:t.columns,showTitles:t.showTitles})}))):Ur("div",{class:"uppy-Provider-empty"},t.i18n("noFilesFound"))},Fr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Or=k.h,Ar=function(t){var e=t.folders,r=t.files;""!==t.filterInput&&(e=t.filterItems(t.folders),r=t.filterItems(t.files));var n=t.currentSelection.length;return Or("div",{class:qt("uppy-ProviderBrowser","uppy-ProviderBrowser-viewType--"+t.viewType)},Or("div",{class:"uppy-ProviderBrowser-header"},Or("div",{class:qt("uppy-ProviderBrowser-headerBar",!t.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple")},Or("div",{class:"uppy-Provider-breadcrumbsIcon"},t.pluginIcon&&t.pluginIcon()),t.showBreadcrumbs&&function(t){return wr("ul",{class:"uppy-Provider-breadcrumbs"},t.directories.map(function(e,r){return function(t){return wr("li",null,wr("button",{type:"button",onclick:t.getFolder},t.title))}({getFolder:function(){return t.getFolder(e.id)},title:0===r?t.title:e.title})}))}({getFolder:t.getFolder,directories:t.directories,title:t.title}),Or("span",{class:"uppy-ProviderBrowser-user"},t.username),Or("button",{type:"button",onclick:t.logout,class:"uppy-ProviderBrowser-userLogout"},t.i18n("logOut")))),t.showFilter&&Or(Pr,t),Or(Tr,{columns:[{name:"Name",key:"title"}],folders:e,files:r,activeRow:t.isActiveRow,sortByTitle:t.sortByTitle,sortByDate:t.sortByDate,isChecked:t.isChecked,handleFolderClick:t.getNextFolder,toggleCheckbox:t.toggleCheckbox,getItemName:t.getItemName,getItemIcon:t.getItemIcon,handleScroll:t.handleScroll,title:t.title,showTitles:t.showTitles,getItemId:t.getItemId,i18n:t.i18n}),n>0&&Or(_r,Fr({selected:n},t)))},xr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function Rr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Dr=k.h,Ir=function(t){function e(){return Rr(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillUnmount=function(){this.props.onUnmount()},e.prototype.render=function(){return this.props.children[0]},e}(k.Component),Br=function(){function t(e,r){Rr(this,t),this.plugin=e,this.Provider=e[e.id],this.opts=xr({},{viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0},r),this.addFile=this.addFile.bind(this),this.filterItems=this.filterItems.bind(this),this.filterQuery=this.filterQuery.bind(this),this.toggleSearch=this.toggleSearch.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.checkAuth=this.checkAuth.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleDemoAuth=this.handleDemoAuth.bind(this),this.sortByTitle=this.sortByTitle.bind(this),this.sortByDate=this.sortByDate.bind(this),this.isActiveRow=this.isActiveRow.bind(this),this.isChecked=this.isChecked.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection()}return t.prototype.tearDown=function(){},t.prototype._updateFilesAndFolders=function(t,e,r){var n=this;this.plugin.getItemSubList(t).forEach(function(t){n.plugin.isFolder(t)?r.push(t):e.push(t)}),this.plugin.setPluginState({folders:r,files:e})},t.prototype.checkAuth=function(){var t=this;this.plugin.setPluginState({checkAuthInProgress:!0}),this.Provider.checkAuth().then(function(e){t.plugin.setPluginState({checkAuthInProgress:!1}),t.plugin.onAuth(e)}).catch(function(e){t.plugin.setPluginState({checkAuthInProgress:!1}),t.handleError(e)})},t.prototype.getFolder=function(t,e){var r=this;return this._loaderWrapper(this.Provider.list(t),function(n){var o,i=r.plugin.getPluginState(),s=function(e,r){for(var n=0;n<e.length;n++)if(o=e[n],t===o.id)return n;var o;return-1}(i.directories);o=-1!==s?i.directories.slice(0,s+1):i.directories.concat([{id:t,title:e||r.plugin.getItemName(n)}]),r.username=r.username?r.username:r.plugin.getUsername(n),r._updateFilesAndFolders(n,[],[]),r.plugin.setPluginState({directories:o})},this.handleError)},t.prototype.getNextFolder=function(t){var e=this.plugin.getItemRequestPath(t);this.getFolder(e,this.plugin.getItemName(t)),this.lastCheckbox=void 0},t.prototype.addFile=function(t){var e={id:this.providerFileToId(t),source:this.plugin.id,data:this.plugin.getItemData(t),name:this.plugin.getItemName(t)||this.plugin.getItemId(t),type:this.plugin.getMimeType(t),isRemote:!0,body:{fileId:this.plugin.getItemId(t)},remote:{serverUrl:this.plugin.opts.serverUrl,url:""+this.Provider.fileUrl(this.plugin.getItemRequestPath(t)),body:{fileId:this.plugin.getItemId(t)},providerOptions:this.Provider.opts}},r=L(e);r&&Ye(r)&&(e.preview=this.plugin.getItemThumbnailUrl(t)),this.plugin.uppy.log("Adding remote file");try{this.plugin.uppy.addFile(e)}catch(t){}},t.prototype.removeFile=function(t){var e=this.plugin.getPluginState().currentSelection;this.plugin.setPluginState({currentSelection:e.filter(function(e){return e.id!==t})})},t.prototype.logout=function(){var t=this;this.Provider.logout(location.href).then(function(e){e.ok&&t.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[]})}).catch(this.handleError)},t.prototype.filterQuery=function(t){var e=this.plugin.getPluginState();this.plugin.setPluginState(xr({},e,{filterInput:t?t.target.value:""}))},t.prototype.toggleSearch=function(t){var e=this.plugin.getPluginState();this.plugin.setPluginState({isSearchVisible:!e.isSearchVisible,filterInput:""})},t.prototype.filterItems=function(t){var e=this,r=this.plugin.getPluginState();return""===r.filterInput?t:t.filter(function(t){return-1!==e.plugin.getItemName(t).toLowerCase().indexOf(r.filterInput.toLowerCase())})},t.prototype.sortByTitle=function(){var t=this,e=xr({},this.plugin.getPluginState()),r=e.files,n=e.folders,o=e.sorting,i=r.sort(function(e,r){return"titleDescending"===o?t.plugin.getItemName(r).localeCompare(t.plugin.getItemName(e)):t.plugin.getItemName(e).localeCompare(t.plugin.getItemName(r))}),s=n.sort(function(e,r){return"titleDescending"===o?t.plugin.getItemName(r).localeCompare(t.plugin.getItemName(e)):t.plugin.getItemName(e).localeCompare(t.plugin.getItemName(r))});this.plugin.setPluginState(xr({},e,{files:i,folders:s,sorting:"titleDescending"===o?"titleAscending":"titleDescending"}))},t.prototype.sortByDate=function(){var t=this,e=xr({},this.plugin.getPluginState()),r=e.files,n=e.folders,o=e.sorting,i=r.sort(function(e,r){var n=new Date(t.plugin.getItemModifiedDate(e)),i=new Date(t.plugin.getItemModifiedDate(r));return"dateDescending"===o?n>i?-1:n<i?1:0:n>i?1:n<i?-1:0}),s=n.sort(function(e,r){var n=new Date(t.plugin.getItemModifiedDate(e)),i=new Date(t.plugin.getItemModifiedDate(r));return"dateDescending"===o?n>i?-1:n<i?1:0:n>i?1:n<i?-1:0});this.plugin.setPluginState(xr({},e,{files:i,folders:s,sorting:"dateDescending"===o?"dateAscending":"dateDescending"}))},t.prototype.sortBySize=function(){var t=this,e=xr({},this.plugin.getPluginState()),r=e.files,n=e.sorting;if(r.length&&this.plugin.getItemData(r[0]).size){var o=r.sort(function(e,r){var o=t.plugin.getItemData(e).size,i=t.plugin.getItemData(r).size;return"sizeDescending"===n?o>i?-1:o<i?1:0:o>i?1:o<i?-1:0});this.plugin.setPluginState(xr({},e,{files:o,sorting:"sizeDescending"===n?"sizeAscending":"sizeDescending"}))}},t.prototype.isActiveRow=function(t){return this.plugin.getPluginState().activeRow===this.plugin.getItemId(t)},t.prototype.isChecked=function(t){return this.plugin.getPluginState().currentSelection.some(function(e){return e===t})},t.prototype.addFolder=function(t){var e=this,r=this.providerFileToId(t),n=this.plugin.getPluginState(),o=n.selectedFolders||{};if(!(r in o&&o[r].loading))return o[r]={loading:!0,files:[]},this.plugin.setPluginState({selectedFolders:o}),this.Provider.list(this.plugin.getItemRequestPath(t)).then(function(i){var s=[];e.plugin.getItemSubList(i).forEach(function(t){e.plugin.isFolder(t)||(e.addFile(t),s.push(e.providerFileToId(t)))}),(n=e.plugin.getPluginState()).selectedFolders[r]={loading:!1,files:s},e.plugin.setPluginState({selectedFolders:o});var a,l=e.plugin.uppy.getPlugin("Dashboard");a=s.length?l.i18n("folderAdded",{smart_count:s.length,folder:e.plugin.getItemName(t)}):l.i18n("emptyFolderAdded"),e.plugin.uppy.info(a)}).catch(function(t){delete(n=e.plugin.getPluginState()).selectedFolders[r],e.plugin.setPluginState({selectedFolders:n.selectedFolders}),e.handleError(t)})},t.prototype.toggleCheckbox=function(t,e){t.stopPropagation(),t.preventDefault();var r=this.plugin.getPluginState(),n=r.folders,o=r.files,i=this.filterItems(n.concat(o));if(this.lastCheckbox&&t.shiftKey){var s,a=i.indexOf(this.lastCheckbox),l=i.indexOf(e);return s=a<l?i.slice(a,l+1):i.slice(l,a+1),void this.plugin.setPluginState({currentSelection:s})}this.lastCheckbox=e;var u=this.plugin.getPluginState().currentSelection;this.isChecked(e)?this.plugin.setPluginState({currentSelection:u.filter(function(t){return t!==e})}):this.plugin.setPluginState({currentSelection:u.concat([e])})},t.prototype.providerFileToId=function(t){return B({data:this.plugin.getItemData(t),name:this.plugin.getItemName(t)||this.plugin.getItemId(t),type:this.plugin.getMimeType(t)})},t.prototype.handleDemoAuth=function(){var t=this.plugin.getPluginState();this.plugin.setPluginState({},t,{authenticated:!0})},t.prototype.handleAuth=function(){var t=this,e=btoa(JSON.stringify({origin:location.origin})),r=this.Provider.authUrl()+"?state="+e,n=window.open(r,"_blank"),o=function(t){return t.replace(/^(https?:|)\/\//,"")};window.addEventListener("message",function e(r){new RegExp(o(t.plugin.opts.serverPattern)).test(o(r.origin))&&r.source===n?(n.close(),window.removeEventListener("message",e),t.Provider.setAuthToken(r.data.token),t._loaderWrapper(t.Provider.checkAuth(),t.plugin.onAuth,t.handleError)):t.plugin.uppy.log("rejecting event from "+r.origin+" vs allowed pattern "+t.plugin.opts.serverPattern)})},t.prototype.handleError=function(t){var e=this.plugin.uppy,r=e.i18n("uppyServerError");e.log(t.toString()),e.info({message:r,details:t.toString()},"error",5e3)},t.prototype.handleScroll=function(t){var e=this,r=t.target.scrollHeight-(t.target.scrollTop+t.target.offsetHeight),n=this.plugin.getNextPagePath?this.plugin.getNextPagePath():null;r<50&&n&&!this._isHandlingScroll&&(this.Provider.list(n).then(function(t){var r=e.plugin.getPluginState(),n=r.files,o=r.folders;e._updateFilesAndFolders(t,n,o)}).catch(this.handleError).then(function(){e._isHandlingScroll=!1}),this._isHandlingScroll=!0)},t.prototype.donePicking=function(){var t=this,e=this.plugin.getPluginState().currentSelection.map(function(e){return t.plugin.isFolder(e)?t.addFolder(e):t.addFile(e)});this._loaderWrapper(Promise.all(e),function(){t.clearSelection();var e=t.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},function(){})},t.prototype.cancelPicking=function(){this.clearSelection();var t=this.plugin.uppy.getPlugin("Dashboard");t&&t.hideAllPanels()},t.prototype.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},t.prototype._loaderWrapper=function(t,e,r){var n=this;t.then(function(t){n.plugin.setPluginState({loading:!1}),e(t)}).catch(function(t){n.plugin.setPluginState({loading:!1}),r(t)}),this.plugin.setPluginState({loading:!0})},t.prototype.render=function(t){var e=this.plugin.getPluginState(),r=e.authenticated,n=e.checkAuthInProgress;if(e.loading)return Dr(Ir,{onUnmount:this.clearSelection},Dr(hr,null));if(!r)return Dr(Ir,{onUnmount:this.clearSelection},Dr(br,{pluginName:this.plugin.title,pluginIcon:this.plugin.icon,demo:this.plugin.opts.demo,checkAuth:this.checkAuth,handleAuth:this.handleAuth,handleDemoAuth:this.handleDemoAuth,checkAuthInProgress:n}));var o=xr({},this.plugin.getPluginState(),{username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,filterItems:this.filterItems,filterQuery:this.filterQuery,toggleSearch:this.toggleSearch,sortByTitle:this.sortByTitle,sortByDate:this.sortByDate,logout:this.logout,demo:this.plugin.opts.demo,isActiveRow:this.isActiveRow,isChecked:this.isChecked,toggleCheckbox:this.toggleCheckbox,getItemId:this.plugin.getItemId,getItemName:this.plugin.getItemName,getItemIcon:this.plugin.getItemIcon,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,title:this.plugin.title,viewType:this.opts.viewType,showTitles:this.opts.showTitles,showFilter:this.opts.showFilter,showBreadcrumbs:this.opts.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n});return Dr(Ir,{onUnmount:this.clearSelection},Dr(Ar,o))},t}(),jr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mr=z.Plugin,Lr=Z.Provider,Nr=k.h,zr=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="acquirer",o.id=o.opts.id||"Dropbox",o.title="Dropbox",o.icon=function(){return Nr("svg",{class:"UppyIcon",width:"128",height:"118",viewBox:"0 0 128 118"},Nr("path",{d:"M38.145.777L1.108 24.96l25.608 20.507 37.344-23.06z"}),Nr("path",{d:"M1.108 65.975l37.037 24.183L64.06 68.525l-37.343-23.06zM64.06 68.525l25.917 21.633 37.036-24.183-25.61-20.51z"}),Nr("path",{d:"M127.014 24.96L89.977.776 64.06 22.407l37.345 23.06zM64.136 73.18l-25.99 21.567-11.122-7.262v8.142l37.112 22.256 37.114-22.256v-8.142l-11.12 7.262z"}))},o[o.id]=new Lr(r,{serverUrl:o.opts.serverUrl,serverHeaders:o.opts.serverHeaders,provider:"dropbox"}),o.files=[],o.onAuth=o.onAuth.bind(o),o.render=o.render.bind(o),o.opts=jr({},{},n),o.opts.serverPattern=n.serverPattern||n.serverUrl,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Br(this),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder()},e.prototype.getUsername=function(t){return t.user_email},e.prototype.isFolder=function(t){return"folder"===t[".tag"]},e.prototype.getItemData=function(t){return t},e.prototype.getItemIcon=function(t){return pr[t[".tag"]]()},e.prototype.getItemSubList=function(t){return t.entries},e.prototype.getItemName=function(t){return t.name||""},e.prototype.getMimeType=function(t){return null},e.prototype.getItemId=function(t){return t.id},e.prototype.getItemRequestPath=function(t){return encodeURIComponent(t.path_lower)},e.prototype.getItemModifiedDate=function(t){return t.server_modified},e.prototype.getItemThumbnailUrl=function(t){return this.opts.serverUrl+"/"+this.Dropbox.id+"/thumbnail/"+this.getItemRequestPath(t)},e.prototype.render=function(t){return this.view.render(t)},e}(Mr),qr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hr=z.Plugin,Wr=k.h,Xr=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.id=o.opts.id||"FileInput",o.title="File Input",o.type="acquirer";var i={strings:{chooseFiles:"Choose files"}},s={target:null,pretty:!0,inputName:"files[]",locale:i};return o.opts=qr({},s,n),o.locale=qr({},i,o.opts.locale),o.locale.strings=qr({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.render=o.render.bind(o),o.handleInputChange=o.handleInputChange.bind(o),o.handleClick=o.handleClick.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleInputChange=function(t){var e=this;this.uppy.log("[FileInput] Something selected through input..."),tr(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(t){var e=this,r=this.uppy.opts.restrictions;return Wr("div",{class:"uppy-Root uppy-FileInput-container"},Wr("input",{class:"uppy-FileInput-input",style:this.opts.pretty&&{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},type:"file",name:this.opts.inputName,onchange:this.handleInputChange,multiple:1!==r.maxNumberOfFiles,accept:r.allowedFileTypes,ref:function(t){e.input=t},value:""}),this.opts.pretty&&Wr("button",{class:"uppy-FileInput-btn",type:"button",onclick:this.handleClick},this.i18n("chooseFiles")))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(Hr),Vr={__esModule:!0};Vr.default=Zr,Vr.getFieldData=tn;var Gr={"[object HTMLCollection]":!0,"[object NodeList]":!0,"[object RadioNodeList]":!0},Kr={button:!0,fieldset:!0,reset:!0,submit:!0},Yr={checkbox:!0,radio:!0},Jr=/^\s+|\s+$/g,$r=Array.prototype.slice,Qr=Object.prototype.toString;function Zr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{trim:!1};if(!t)throw new Error("A form is required by getFormData, was given form="+t);for(var r={},n=void 0,o=[],i={},s=0,a=t.elements.length;s<a;s++){var l=t.elements[s];Kr[l.type]||l.disabled||(n=l.name||l.id)&&!i[n]&&(o.push(n),i[n]=!0)}for(var u=0,p=o.length;u<p;u++){var c=tn(t,n=o[u],e);null!=c&&(r[n]=c)}return r}function tn(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{trim:!1};if(!t)throw new Error("A form is required by getFieldData, was given form="+t);if(!e&&"[object String]"!==Qr.call(e))throw new Error("A field name is required by getFieldData, was given fieldName="+e);var n=t.elements[e];if(!n||n.disabled)return null;if(!Gr[Qr.call(n)])return en(n,r.trim);for(var o=[],i=!0,s=0,a=n.length;s<a;s++)if(!n[s].disabled){i&&"radio"!==n[s].type&&(i=!1);var l=en(n[s],r.trim);null!=l&&(o=o.concat(l))}return i&&1===o.length?o[0]:o.length>0?o:null}function en(t,e){var r=null,n=t.type;if("select-one"===n)return t.options.length&&(r=t.options[t.selectedIndex].value),r;if("select-multiple"===n){r=[];for(var o=0,i=t.options.length;o<i;o++)t.options[o].selected&&r.push(t.options[o].value);return 0===r.length&&(r=null),r}return"file"===n&&"files"in t?(t.multiple?0===(r=$r.call(t.files)).length&&(r=null):r=t.files[0],r):(Yr[n]?t.checked&&(r=t.value):r=e?t.value.replace(Jr,""):t.value,r)}Zr.getFieldData=tn;var rn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},nn=z.Plugin,on=Vr.default||Vr,sn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="acquirer",o.id="Form",o.title="Form",o.opts=rn({},{target:null,resultName:"uppyResult",getMetaFromForm:!0,addResultToForm:!0,submitOnSuccess:!1,triggerUploadOnSubmit:!1},n),o.handleFormSubmit=o.handleFormSubmit.bind(o),o.handleUploadStart=o.handleUploadStart.bind(o),o.handleSuccess=o.handleSuccess.bind(o),o.addResultToForm=o.addResultToForm.bind(o),o.getMetaFromForm=o.getMetaFromForm.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleUploadStart=function(){this.opts.getMetaFromForm&&this.getMetaFromForm()},e.prototype.handleSuccess=function(t){this.opts.addResultToForm&&this.addResultToForm(t),this.opts.submitOnSuccess&&this.form.submit()},e.prototype.handleFormSubmit=function(t){var e=this;this.opts.triggerUploadOnSubmit&&(t.preventDefault(),this.uppy.upload().catch(function(t){e.uppy.log(t.stack||t.message||t)}))},e.prototype.addResultToForm=function(t){this.uppy.log("[Form] Adding result to the original form:"),this.uppy.log(t);var e=this.form.querySelector('[name="'+this.opts.resultName+'"]');e?e.value=JSON.stringify(t):((e=document.createElement("input")).name=this.opts.resultName,e.type="hidden",e.value=JSON.stringify(t),this.form.appendChild(e))},e.prototype.getMetaFromForm=function(){var t=on(this.form);this.uppy.setMeta(t)},e.prototype.install=function(){this.form=U(this.opts.target),this.form&&"FORM"!==!this.form.nodeName?(this.form.addEventListener("submit",this.handleFormSubmit),this.uppy.on("upload",this.handleUploadStart),this.uppy.on("complete",this.handleSuccess)):console.error("Form plugin requires a <form> target element passed in options to operate, none was found","error")},e.prototype.uninstall=function(){this.form.removeEventListener("submit",this.handleFormSubmit),this.uppy.off("upload",this.handleUploadStart),this.uppy.off("complete",this.handleSuccess)},e}(nn),an={},ln=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},un="undefined"!=typeof window&&(window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB),pn=!!un,cn="uppy-blobs",hn="files",dn=864e5,fn=3;function yn(t){var e=un.open(t,fn);return new Promise(function(t,r){e.onupgradeneeded=function(e){var r=e.target.result,n=e.currentTarget.transaction;if(e.oldVersion<2&&r.createObjectStore(hn,{keyPath:"id"}).createIndex("store","store",{unique:!1}),e.oldVersion<3){var o=n.objectStore(hn);o.createIndex("expires","expires",{unique:!1}),o.openCursor().onsuccess=function(t){var e=t.target.result;if(e){var r=e.value;r.expires=Date.now()+dn,e.update(r)}}}n.oncomplete=function(){t(r)}},e.onsuccess=function(e){t(e.target.result)},e.onerror=r})}function gn(t){return new Promise(function(e,r){t.onsuccess=function(t){e(t.target.result)},t.onerror=r})}var mn=!1,vn=function(){function t(e){var r=this;!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=ln({dbName:cn,storeName:"default",expires:dn,maxFileSize:10485760,maxTotalSize:314572800},e),this.name=this.opts.storeName;var n=function(){return yn(r.opts.dbName)};mn?this.ready=n():(mn=!0,this.ready=t.cleanup().then(n,n))}return t.prototype.key=function(t){return this.name+"!"+t},t.prototype.list=function(){var t=this;return this.ready.then(function(e){return gn(e.transaction([hn],"readonly").objectStore(hn).index("store").getAll(IDBKeyRange.only(t.name)))}).then(function(t){var e={};return t.forEach(function(t){e[t.fileID]=t.data}),e})},t.prototype.get=function(t){var e=this;return this.ready.then(function(r){return gn(r.transaction([hn],"readonly").objectStore(hn).get(e.key(t)))}).then(function(t){return{id:t.data.fileID,data:t.data.data}})},t.prototype.getSize=function(){var t=this;return this.ready.then(function(e){var r=e.transaction([hn],"readonly").objectStore(hn).index("store").openCursor(IDBKeyRange.only(t.name));return new Promise(function(t,e){var n=0;r.onsuccess=function(e){var r=e.target.result;r?(n+=r.value.data.size,r.continue()):t(n)},r.onerror=function(){e(new Error("Could not retrieve stored blobs size"))}})})},t.prototype.put=function(t){var e=this;return t.data.size>this.opts.maxFileSize?Promise.reject(new Error("File is too big to store.")):this.getSize().then(function(t){return t>e.opts.maxTotalSize?Promise.reject(new Error("No space left")):e.ready}).then(function(r){return gn(r.transaction([hn],"readwrite").objectStore(hn).add({id:e.key(t.id),fileID:t.id,store:e.name,expires:Date.now()+e.opts.expires,data:t.data}))})},t.prototype.delete=function(t){var e=this;return this.ready.then(function(r){return gn(r.transaction([hn],"readwrite").objectStore(hn).delete(e.key(t)))})},t.cleanup=function(){return yn(cn).then(function(t){var e=t.transaction([hn],"readwrite").objectStore(hn).index("expires").openCursor(IDBKeyRange.upperBound(Date.now()));return new Promise(function(r,n){e.onsuccess=function(e){var n=e.target.result;if(n){var o=n.value;console.log("[IndexedDBStore] Deleting record",o.fileID,"of size",P(o.data.size),"- expired on",new Date(o.expires)),n.delete(),n.continue()}else r(t)},e.onerror=n})}).then(function(t){t.close()})},t}();vn.isSupported=pn,an=vn;var bn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function wn(t){try{return JSON.parse(t)}catch(t){return null}}var Sn=!1,Pn=function(){function t(e){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=bn({expires:864e5},e),this.name="uppyState:"+e.storeName,Sn||(Sn=!0,t.cleanup())}return t.prototype.load=function(){var t=localStorage.getItem(this.name);if(!t)return null;var e=wn(t);return e?e.metadata?e.metadata:(this.save(e),e):null},t.prototype.save=function(t){var e=Date.now()+this.opts.expires,r=JSON.stringify({metadata:t,expires:e});localStorage.setItem(this.name,r)},t.cleanup=function(){var t=function(){for(var t=[],e=0;e<localStorage.length;e++){var r=localStorage.key(e);/^uppyState:/.test(r)&&t.push(r.slice("uppyState:".length))}return t}(),e=Date.now();t.forEach(function(t){var r=localStorage.getItem("uppyState:"+t);if(!r)return null;var n=wn(r);if(!n)return null;n.expires&&n.expires<e&&localStorage.removeItem("uppyState:"+t)})},t}(),kn={},_n="undefined"!=typeof navigator&&"serviceWorker"in navigator,En=function(){function t(e){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.ready=new Promise(function(t,e){_n?navigator.serviceWorker.controller?t():navigator.serviceWorker.addEventListener("controllerchange",function(){t()}):e(new Error("Unsupported"))}),this.name=e.storeName}return t.prototype.list=function(){var t=this,e={},r=new Promise(function(t,r){e.resolve=t,e.reject=r});console.log("Loading stored blobs from Service Worker");var n=function r(n){if(n.data.store===t.name)switch(n.data.type){case"uppy/ALL_FILES":e.resolve(n.data.files),navigator.serviceWorker.removeEventListener("message",r)}};return this.ready.then(function(){navigator.serviceWorker.addEventListener("message",n),navigator.serviceWorker.controller.postMessage({type:"uppy/GET_FILES",store:t.name})}),r},t.prototype.put=function(t){var e=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/ADD_FILE",store:e.name,file:t})})},t.prototype.delete=function(t){var e=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/REMOVE_FILE",store:e.name,fileID:t})})},t}();En.isSupported=_n,kn=En;var Cn,Un=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="debugger",o.id="GoldenRetriever",o.title="Golden Retriever",o.opts=Un({},{expires:864e5,serviceWorker:!1},n),o.MetaDataStore=new Pn({expires:o.opts.expires,storeName:r.getID()}),o.ServiceWorkerStore=null,o.opts.serviceWorker&&(o.ServiceWorkerStore=new kn({storeName:r.getID()})),o.IndexedDBStore=new an(Un({expires:o.opts.expires},n.indexedDB||{},{storeName:r.getID()})),o.saveFilesStateToLocalStorage=o.saveFilesStateToLocalStorage.bind(o),o.loadFilesStateFromLocalStorage=o.loadFilesStateFromLocalStorage.bind(o),o.loadFileBlobsFromServiceWorker=o.loadFileBlobsFromServiceWorker.bind(o),o.loadFileBlobsFromIndexedDB=o.loadFileBlobsFromIndexedDB.bind(o),o.onBlobsLoaded=o.onBlobsLoaded.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.loadFilesStateFromLocalStorage=function(){var t=this.MetaDataStore.load();t&&(this.uppy.log("[GoldenRetriever] Recovered some state from Local Storage"),this.uppy.setState({currentUploads:t.currentUploads||{},files:t.files||{}}),this.savedPluginData=t.pluginData)},e.prototype.getWaitingFiles=function(){var t={};return this.uppy.getFiles().forEach(function(e){e.progress&&e.progress.uploadStarted||(t[e.id]=e)}),t},e.prototype.getUploadingFiles=function(){var t=this,e={},r=this.uppy.getState().currentUploads;return r&&Object.keys(r).forEach(function(n){r[n].fileIDs.forEach(function(r){e[r]=t.uppy.getFile(r)})}),e},e.prototype.saveFilesStateToLocalStorage=function(){var t=Un(this.getWaitingFiles(),this.getUploadingFiles()),e={};this.uppy.emit("restore:get-data",function(t){Un(e,t)});var r=this.uppy.getState().currentUploads;this.MetaDataStore.save({currentUploads:r,files:t,pluginData:e})},e.prototype.loadFileBlobsFromServiceWorker=function(){var t=this;this.ServiceWorkerStore.list().then(function(e){var r=Object.keys(e).length;return r===t.uppy.getFiles().length?(t.uppy.log("[GoldenRetriever] Successfully recovered "+r+" blobs from Service Worker!"),t.uppy.info("Successfully recovered "+r+" files","success",3e3),t.onBlobsLoaded(e)):(t.uppy.log("[GoldenRetriever] No blobs found in Service Worker, trying IndexedDB now..."),t.loadFileBlobsFromIndexedDB())}).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to recover blobs from Service Worker","warning"),t.uppy.log(e)})},e.prototype.loadFileBlobsFromIndexedDB=function(){var t=this;this.IndexedDBStore.list().then(function(e){var r=Object.keys(e).length;if(r>0)return t.uppy.log("[GoldenRetriever] Successfully recovered "+r+" blobs from IndexedDB!"),t.uppy.info("Successfully recovered "+r+" files","success",3e3),t.onBlobsLoaded(e);t.uppy.log("[GoldenRetriever] No blobs found in IndexedDB")}).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to recover blobs from IndexedDB","warning"),t.uppy.log(e)})},e.prototype.onBlobsLoaded=function(t){var e=this,r=[],n=Un({},this.uppy.getState().files);Object.keys(t).forEach(function(o){var i=e.uppy.getFile(o);if(i){var s=t[o],a=Un({},i,{data:s,isRestored:!0});n[o]=a}else r.push(o)}),this.uppy.setState({files:n}),this.uppy.emit("restored",this.savedPluginData),r.length&&this.deleteBlobs(r).then(function(){e.uppy.log("[GoldenRetriever] Cleaned up "+r.length+" old files")}).catch(function(t){e.uppy.log("[GoldenRetriever] Could not clean up "+r.length+" old files","warning"),e.uppy.log(t)})},e.prototype.deleteBlobs=function(t){var e=this,r=[];return t.forEach(function(t){e.ServiceWorkerStore&&r.push(e.ServiceWorkerStore.delete(t)),e.IndexedDBStore&&r.push(e.IndexedDBStore.delete(t))}),Promise.all(r)},e.prototype.install=function(){var t=this;this.loadFilesStateFromLocalStorage(),this.uppy.getFiles().length>0?this.ServiceWorkerStore?(this.uppy.log("[GoldenRetriever] Attempting to load files from Service Worker..."),this.loadFileBlobsFromServiceWorker()):(this.uppy.log("[GoldenRetriever] Attempting to load files from Indexed DB..."),this.loadFileBlobsFromIndexedDB()):(this.uppy.log("[GoldenRetriever] No files need to be loaded, only restoring processing state..."),this.onBlobsLoaded([])),this.uppy.on("file-added",function(e){e.isRemote||(t.ServiceWorkerStore&&t.ServiceWorkerStore.put(e).catch(function(e){t.uppy.log("[GoldenRetriever] Could not store file","warning"),t.uppy.log(e)}),t.IndexedDBStore.put(e).catch(function(e){t.uppy.log("[GoldenRetriever] Could not store file","warning"),t.uppy.log(e)}))}),this.uppy.on("file-removed",function(e){t.ServiceWorkerStore&&t.ServiceWorkerStore.delete(e.id).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to remove file","warning"),t.uppy.log(e)}),t.IndexedDBStore.delete(e.id).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to remove file","warning"),t.uppy.log(e)})}),this.uppy.on("complete",function(e){var r=e.successful,n=r.map(function(t){return t.id});t.deleteBlobs(n).then(function(){t.uppy.log("[GoldenRetriever] Removed "+r.length+" files that finished uploading")}).catch(function(e){t.uppy.log("[GoldenRetriever] Could not remove "+r.length+" files that finished uploading","warning"),t.uppy.log(e)})}),this.uppy.on("state-update",this.saveFilesStateToLocalStorage),this.uppy.on("restored",function(){var e=t.uppy.getState().currentUploads;e&&Object.keys(e).forEach(function(r){t.uppy.restore(r,e[r])})})},e}(z.Plugin),Fn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},On=z.Plugin,An=Z.Provider,xn=k.h,Rn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="acquirer",o.id=o.opts.id||"GoogleDrive",o.title="Google Drive",o.icon=function(){return xn("svg",{"aria-hidden":"true",class:"UppyIcon UppyModalTab-icon",width:"28",height:"28",viewBox:"0 0 16 16"},xn("path",{d:"M2.955 14.93l2.667-4.62H16l-2.667 4.62H2.955zm2.378-4.62l-2.666 4.62L0 10.31l5.19-8.99 2.666 4.62-2.523 4.37zm10.523-.25h-5.333l-5.19-8.99h5.334l5.19 8.99z"}))},o[o.id]=new An(r,{serverUrl:o.opts.serverUrl,serverHeaders:o.opts.serverHeaders,provider:"drive",authProvider:"google"}),o.files=[],o.onAuth=o.onAuth.bind(o),o.render=o.render.bind(o),o.opts=Fn({},{},n),o.opts.serverPattern=n.serverPattern||n.serverUrl,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Br(this),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder("root")},e.prototype.getUsername=function(t){var e=t.items,r=Array.isArray(e),n=0;for(e=r?e:e[Symbol.iterator]();;){var o;if(r){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var i=o;if("owner"===i.userPermission.role){var s=i.owners,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var u;if(a){if(l>=s.length)break;u=s[l++]}else{if((l=s.next()).done)break;u=l.value}var p=u;if(p.isAuthenticatedUser)return p.emailAddress}}}},e.prototype.isFolder=function(t){return"application/vnd.google-apps.folder"===t.mimeType},e.prototype.getItemData=function(t){return Fn({},t,{size:parseFloat(t.fileSize)})},e.prototype.getItemIcon=function(t){return xn("img",{src:t.iconLink})},e.prototype.getItemSubList=function(t){var e=this;return t.items.filter(function(t){return e.isFolder(t)||!t.mimeType.startsWith("application/vnd.google")})},e.prototype.getItemName=function(t){return t.title?t.title:"/"},e.prototype.getMimeType=function(t){return t.mimeType},e.prototype.getItemId=function(t){return t.id},e.prototype.getItemRequestPath=function(t){return this.getItemId(t)},e.prototype.getItemModifiedDate=function(t){return t.modifiedByMeDate},e.prototype.getItemThumbnailUrl=function(t){return this.opts.serverUrl+"/"+this.GoogleDrive.id+"/thumbnail/"+this.getItemRequestPath(t)},e.prototype.render=function(t){return this.view.render(t)},e}(On),Dn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},In=z.Plugin,Bn=Z.Provider,jn=k.h,Mn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="acquirer",o.id=o.opts.id||"Instagram",o.title="Instagram",o.icon=function(){return jn("svg",{"aria-hidden":"true",class:"UppyIcon",width:"28",height:"28",viewBox:"0 0 512 512"},jn("path",{d:"M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z"}),jn("path",{d:"M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z"}),jn("circle",{cx:"390.476",cy:"121.524",r:"30.23"}))},o[o.id]=new Bn(r,{serverUrl:o.opts.serverUrl,serverHeaders:o.opts.serverHeaders,provider:"instagram",authProvider:"instagram"}),o.files=[],o.onAuth=o.onAuth.bind(o),o.render=o.render.bind(o),o.opts=Dn({},{},n),o.opts.serverPattern=n.serverPattern||n.serverUrl,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Br(this,{viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1}),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder("recent")},e.prototype.getUsername=function(t){return t.data[0].user.username},e.prototype.isFolder=function(t){return!1},e.prototype.getItemData=function(t){return t},e.prototype.getItemIcon=function(t){return t.images?jn("img",{src:t.images.low_resolution.url}):jn("svg",{viewBox:"0 0 58 58",opacity:"0.6"},jn("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),jn("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))},e.prototype.getItemSubList=function(t){var e=[];return t.data.forEach(function(t){t.carousel_media?t.carousel_media.forEach(function(r,n){var o=t.id,i=t.created_time,s=Dn({},r,{id:o,created_time:i});s.carousel_id=n,e.push(s)}):e.push(t)}),e},e.prototype.getItemName=function(t){if(t&&t.created_time){var e="video"===t.type?"mp4":"jpeg",r=new Date(1e3*t.created_time);return"Instagram "+(r=r.toLocaleDateString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}))+" "+(t.carousel_id||"")+"."+e}return""},e.prototype.getMimeType=function(t){return"video"===t.type?"video/mp4":"image/jpeg"},e.prototype.getItemId=function(t){return""+t.id+(t.carousel_id||"")},e.prototype.getItemRequestPath=function(t){var e=isNaN(t.carousel_id)?"":"?carousel_id="+t.carousel_id;return""+t.id+e},e.prototype.getItemModifiedDate=function(t){return t.created_time},e.prototype.getItemThumbnailUrl=function(t){return t.images.thumbnail.url},e.prototype.getNextPagePath=function(){var t=this.getPluginState().files;return"recent?max_id="+this.getItemId(t[t.length-1])},e.prototype.render=function(t){return this.view.render(t)},e}(In),Ln=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nn=z.Plugin,zn=k.h,qn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.id=o.opts.id||"ProgressBar",o.title="Progress Bar",o.type="progressindicator",o.opts=Ln({},{target:"body",replaceTargetContent:!1,fixed:!1,hideAfterFinish:!0},n),o.render=o.render.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t){var e=t.totalProgress||0,r=100===e&&this.opts.hideAfterFinish;return zn("div",{class:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":r},zn("div",{class:"uppy-ProgressBar-inner",style:{width:e+"%"}}),zn("div",{class:"uppy-ProgressBar-percentage"},e))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(Nn),Hn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wn=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="debugger",o.id="ReduxDevTools",o.title="Redux DevTools",o.opts=Hn({},{},n),o.handleStateChange=o.handleStateChange.bind(o),o.initDevTools=o.initDevTools.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleStateChange=function(t,e,r){this.devTools.send("UPPY_STATE_UPDATE",e)},e.prototype.initDevTools=function(){var t=this;this.devTools=window.devToolsExtension.connect(),this.devToolsUnsubscribe=this.devTools.subscribe(function(e){if("DISPATCH"===e.type)switch(console.log(e.payload.type),e.payload.type){case"RESET":return void t.uppy.reset();case"IMPORT_STATE":var r=e.payload.nextLiftedState.computedStates;return t.uppy.store.state=Hn({},t.uppy.getState(),r[r.length-1].state),void t.uppy.updateAll(t.uppy.getState());case"JUMP_TO_STATE":case"JUMP_TO_ACTION":t.uppy.store.state=Hn({},t.uppy.getState(),JSON.parse(e.state)),t.uppy.updateAll(t.uppy.getState())}})},e.prototype.install=function(){this.withDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__,this.withDevTools&&(this.initDevTools(),this.uppy.on("state-update",this.handleStateChange))},e.prototype.uninstall=function(){this.withDevTools&&(this.devToolsUnsubscribe(),this.uppy.off("state-update",this.handleStateUpdate))},e}(z.Plugin),Xn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vn=function(t){return function(e){return e.uppy[t]}},Gn=function(){function t(e){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._store=e.store,this._id=e.id||p(),this._selector=e.selector||Vn(this._id),this.setState({})}return t.prototype.setState=function(t){this._store.dispatch({type:"uppy/STATE_UPDATE",id:this._id,payload:t})},t.prototype.getState=function(){return this._selector(this._store.getState())},t.prototype.subscribe=function(t){var e=this,r=this.getState();return this._store.subscribe(function(){var n=e.getState();if(r!==n){var o=function(t,e){var r=Object.keys(e),n={};return r.forEach(function(r){t[r]!==e[r]&&(n[r]=e[r])}),n}(r,n);t(r,n,o),r=n}})},t}();(Cn=function(t){return new Gn(t)}).STATE_UPDATE="uppy/STATE_UPDATE",Cn.reducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];if("uppy/STATE_UPDATE"===e.type){var r,n=Xn({},t[e.id],e.payload);return Xn({},t,((r={})[e.id]=n,r))}return t},Cn.middleware=function(){return function(){return function(t){return function(e){t(e)}}}};var Kn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=e}return t.prototype.createAssembly=function(t){t.templateId;var e=t.params,r=t.fields,n=t.signature,o=t.expectedFiles,i=new FormData;return i.append("params","string"==typeof e?e:JSON.stringify(e)),n&&i.append("signature",n),Object.keys(r).forEach(function(t){i.append(t,r[t])}),i.append("num_expected_upload_files",o),fetch(this.opts.service+"/assemblies",{method:"post",body:i}).then(function(t){return t.json()}).then(function(t){if(t.error){var e=new Error(t.error);throw e.message=t.error,e.details=t.reason,e}return t})},t.prototype.reserveFile=function(t,e){var r=encodeURIComponent(e.size);return fetch(t.assembly_ssl_url+"/reserve_file?size="+r,{method:"post"}).then(function(t){return t.json()})},t.prototype.addFile=function(t,e){if(!e.uploadURL)return Promise.reject(new Error("File does not have an `uploadURL`."));var r=encodeURIComponent(e.size),n=encodeURIComponent(e.uploadURL),o="size="+r+"&filename="+encodeURIComponent(e.name)+"&fieldname=file&s3Url="+n;return fetch(t.assembly_ssl_url+"/add_file?"+o,{method:"post"}).then(function(t){return t.json()})},t.prototype.getAssemblyStatus=function(t){return fetch(t).then(function(t){return t.json()})},t}(),Yn={};function Jn(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Yn=Jn,Jn.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},Jn.prototype.reset=function(){this.attempts=0},Jn.prototype.setMin=function(t){this.ms=t},Jn.prototype.setMax=function(t){this.max=t},Jn.prototype.setJitter=function(t){this.jitter=t};var $n=[].slice,Qn=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=$n.call(arguments,2);return function(){return e.apply(t,r.concat($n.call(arguments)))}},Zn={exports:{}};function to(t){if(t)return function(t){for(var e in to.prototype)t[e]=to.prototype[e];return t}(t)}Zn.exports=to,to.prototype.on=to.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},to.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},to.prototype.off=to.prototype.removeListener=to.prototype.removeAllListeners=to.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((r=n[o])===e||r.fn===e){n.splice(o,1);break}return this},to.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,e);return this},to.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},to.prototype.hasListeners=function(t){return!!this.listeners(t).length},Zn=Zn.exports;for(var eo=[].indexOf,ro=function(t,e){if(eo)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1},no=function(t,e,r){return t.on(e,r),{destroy:function(){t.removeListener(e,r)}}},oo={toByteArray:function(t){var e,r,n,o,i,s,a=t.length;i=co(t),s=new ao(3*a/4-i),n=i>0?a-4:a;var l=0;for(e=0,r=0;e<n;e+=4,r+=3)o=so[t.charCodeAt(e)]<<18|so[t.charCodeAt(e+1)]<<12|so[t.charCodeAt(e+2)]<<6|so[t.charCodeAt(e+3)],s[l++]=o>>16&255,s[l++]=o>>8&255,s[l++]=255&o;return 2===i?(o=so[t.charCodeAt(e)]<<2|so[t.charCodeAt(e+1)]>>4,s[l++]=255&o):1===i&&(o=so[t.charCodeAt(e)]<<10|so[t.charCodeAt(e+1)]<<4|so[t.charCodeAt(e+2)]>>2,s[l++]=o>>8&255,s[l++]=255&o),s},fromByteArray:function(t){for(var e,r=t.length,n=r%3,o="",i=[],s=0,a=r-n;s<a;s+=16383)i.push(ho(t,s,s+16383>a?a:s+16383));return 1===n?(e=t[r-1],o+=io[e>>2],o+=io[e<<4&63],o+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],o+=io[e>>10],o+=io[e>>4&63],o+=io[e<<2&63],o+="="),i.push(o),i.join("")}},io=[],so=[],ao="undefined"!=typeof Uint8Array?Uint8Array:Array,lo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uo=0,po=lo.length;uo<po;++uo)io[uo]=lo[uo],so[lo.charCodeAt(uo)]=uo;function co(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function ho(t,e,r){for(var n,o,i=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(io[(o=n)>>18&63]+io[o>>12&63]+io[o>>6&63]+io[63&o]);return i.join("")}so["-".charCodeAt(0)]=62,so["_".charCodeAt(0)]=63;var fo={read:function(t,e,r,n,o){var i,s,a=8*o-n-1,l=(1<<a)-1,u=l>>1,p=-7,c=r?o-1:0,h=r?-1:1,d=t[e+c];for(c+=h,i=d&(1<<-p)-1,d>>=-p,p+=a;p>0;i=256*i+t[e+c],c+=h,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=n;p>0;s=256*s+t[e+c],c+=h,p-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),i-=u}return(d?-1:1)*s*Math.pow(2,i-n)},write:function(t,e,r,n,o,i){var s,a,l,u=8*i-o-1,p=(1<<u)-1,c=p>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,f=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?h/l:h*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=p?(a=0,s=p):s+c>=1?(a=(e*l-1)*Math.pow(2,o),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;t[r+d]=255&a,d+=f,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[r+d]=255&s,d+=f,s/=256,u-=8);t[r+d-f]|=128*y}},yo={};yo.Buffer=vo,yo.INSPECT_MAX_BYTES=50;var go=2147483647;function mo(t){if(t>go)throw new RangeError("Invalid typed array length");var e=new Uint8Array(t);return e.__proto__=vo.prototype,e}function vo(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return So(t)}return bo(t,e,r)}function bo(t,e,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return Jo(t)||t&&Jo(t.buffer)?function(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r)).__proto__=vo.prototype,n}(t,e,r):"string"==typeof t?function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!vo.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|_o(t,e),n=mo(r),o=n.write(t,e);return o!==r&&(n=n.slice(0,o)),n}(t,e):function(t){if(vo.isBuffer(t)){var e=0|ko(t.length),r=mo(e);return 0===r.length?r:(t.copy(r,0,0,e),r)}if(t){if(ArrayBuffer.isView(t)||"length"in t)return"number"!=typeof t.length||$o(t.length)?mo(0):Po(t);if("Buffer"===t.type&&Array.isArray(t.data))return Po(t.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(t)}function wo(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('"size" argument must not be negative')}function So(t){return wo(t),mo(t<0?0:0|ko(t))}function Po(t){for(var e=t.length<0?0:0|ko(t.length),r=mo(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function ko(t){if(t>=go)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+go.toString(16)+" bytes");return 0|t}function _o(t,e){if(vo.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Jo(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Go(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Ko(t).length;default:if(n)return Go(t).length;e=(""+e).toLowerCase(),n=!0}}function Eo(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Co(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),$o(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=vo.from(e,n)),vo.isBuffer(e))return 0===e.length?-1:Uo(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Uo(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Uo(t,e,r,n,o){var i,s=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var p=-1;for(i=r;i<a;i++)if(u(t,i)===u(e,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===l)return p*s}else-1!==p&&(i-=i-p),p=-1}else for(r+l>a&&(r=a-l),i=r;i>=0;i--){for(var c=!0,h=0;h<l;h++)if(u(t,i+h)!==u(e,h)){c=!1;break}if(c)return i}return-1}function To(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if($o(a))return s;t[r+s]=a}return s}function Fo(t,e,r,n){return Yo(Go(e,t.length-r),t,r,n)}function Oo(t,e,r,n){return Yo(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function Ao(t,e,r,n){return Oo(t,e,r,n)}function xo(t,e,r,n){return Yo(Ko(e),t,r,n)}function Ro(t,e,r,n){return Yo(function(t,e){for(var r,n,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function Do(t,e,r){return 0===e&&r===t.length?oo.fromByteArray(t):oo.fromByteArray(t.slice(e,r))}function Io(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,a,l,u=t[o],p=null,c=u>239?4:u>223?3:u>191?2:1;if(o+c<=r)switch(c){case 1:u<128&&(p=u);break;case 2:128==(192&(i=t[o+1]))&&(l=(31&u)<<6|63&i)>127&&(p=l);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(l=(15&u)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(p=l);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(p=l)}null===p?(p=65533,c=1):p>65535&&(p-=65536,n.push(p>>>10&1023|55296),p=56320|1023&p),n.push(p),o+=c}return function(t){var e=t.length;if(e<=Bo)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Bo));return r}(n)}vo.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),vo.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(vo.prototype,"parent",{get:function(){if(this instanceof vo)return this.buffer}}),Object.defineProperty(vo.prototype,"offset",{get:function(){if(this instanceof vo)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&vo[Symbol.species]===vo&&Object.defineProperty(vo,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),vo.poolSize=8192,vo.from=function(t,e,r){return bo(t,e,r)},vo.prototype.__proto__=Uint8Array.prototype,vo.__proto__=Uint8Array,vo.alloc=function(t,e,r){return function(t,e,r){return wo(t),t<=0?mo(t):void 0!==e?"string"==typeof r?mo(t).fill(e,r):mo(t).fill(e):mo(t)}(t,e,r)},vo.allocUnsafe=function(t){return So(t)},vo.allocUnsafeSlow=function(t){return So(t)},vo.isBuffer=function(t){return null!=t&&!0===t._isBuffer},vo.compare=function(t,e){if(!vo.isBuffer(t)||!vo.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},vo.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},vo.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return vo.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=vo.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var i=t[r];if(ArrayBuffer.isView(i)&&(i=vo.from(i)),!vo.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},vo.byteLength=_o,vo.prototype._isBuffer=!0,vo.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Eo(this,e,e+1);return this},vo.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Eo(this,e,e+3),Eo(this,e+1,e+2);return this},vo.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Eo(this,e,e+7),Eo(this,e+1,e+6),Eo(this,e+2,e+5),Eo(this,e+3,e+4);return this},vo.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?Io(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Lo(this,e,r);case"utf8":case"utf-8":return Io(this,e,r);case"ascii":return jo(this,e,r);case"latin1":case"binary":return Mo(this,e,r);case"base64":return Do(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return No(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},vo.prototype.toLocaleString=vo.prototype.toString,vo.prototype.equals=function(t){if(!vo.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===vo.compare(this,t)},vo.prototype.inspect=function(){var t="",e=yo.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},vo.prototype.compare=function(t,e,r,n,o){if(!vo.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(i,s),l=this.slice(n,o),u=t.slice(e,r),p=0;p<a;++p)if(l[p]!==u[p]){i=l[p],s=u[p];break}return i<s?-1:s<i?1:0},vo.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},vo.prototype.indexOf=function(t,e,r){return Co(this,t,e,r,!0)},vo.prototype.lastIndexOf=function(t,e,r){return Co(this,t,e,r,!1)},vo.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return To(this,t,e,r);case"utf8":case"utf-8":return Fo(this,t,e,r);case"ascii":return Oo(this,t,e,r);case"latin1":case"binary":return Ao(this,t,e,r);case"base64":return xo(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ro(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},vo.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Bo=4096;function jo(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function Mo(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function Lo(t,e,r){var n,o=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>o)&&(r=o);for(var i="",s=e;s<r;++s)i+=(n=t[s])<16?"0"+n.toString(16):n.toString(16);return i}function No(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function zo(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function qo(t,e,r,n,o,i){if(!vo.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Ho(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Wo(t,e,r,n,o){return e=+e,r>>>=0,o||Ho(t,0,r,4),fo.write(t,e,r,n,23,4),r+4}function Xo(t,e,r,n,o){return e=+e,r>>>=0,o||Ho(t,0,r,8),fo.write(t,e,r,n,52,8),r+8}vo.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return n.__proto__=vo.prototype,n},vo.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||zo(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},vo.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||zo(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},vo.prototype.readUInt8=function(t,e){return t>>>=0,e||zo(t,1,this.length),this[t]},vo.prototype.readUInt16LE=function(t,e){return t>>>=0,e||zo(t,2,this.length),this[t]|this[t+1]<<8},vo.prototype.readUInt16BE=function(t,e){return t>>>=0,e||zo(t,2,this.length),this[t]<<8|this[t+1]},vo.prototype.readUInt32LE=function(t,e){return t>>>=0,e||zo(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},vo.prototype.readUInt32BE=function(t,e){return t>>>=0,e||zo(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},vo.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||zo(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},vo.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||zo(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},vo.prototype.readInt8=function(t,e){return t>>>=0,e||zo(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},vo.prototype.readInt16LE=function(t,e){t>>>=0,e||zo(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},vo.prototype.readInt16BE=function(t,e){t>>>=0,e||zo(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},vo.prototype.readInt32LE=function(t,e){return t>>>=0,e||zo(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},vo.prototype.readInt32BE=function(t,e){return t>>>=0,e||zo(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},vo.prototype.readFloatLE=function(t,e){return t>>>=0,e||zo(t,4,this.length),fo.read(this,t,!0,23,4)},vo.prototype.readFloatBE=function(t,e){return t>>>=0,e||zo(t,4,this.length),fo.read(this,t,!1,23,4)},vo.prototype.readDoubleLE=function(t,e){return t>>>=0,e||zo(t,8,this.length),fo.read(this,t,!0,52,8)},vo.prototype.readDoubleBE=function(t,e){return t>>>=0,e||zo(t,8,this.length),fo.read(this,t,!1,52,8)},vo.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||qo(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},vo.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||qo(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},vo.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,1,255,0),this[e]=255&t,e+1},vo.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},vo.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},vo.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},vo.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},vo.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);qo(this,t,e,r,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},vo.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);qo(this,t,e,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},vo.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},vo.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},vo.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},vo.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},vo.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||qo(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},vo.prototype.writeFloatLE=function(t,e,r){return Wo(this,t,e,!0,r)},vo.prototype.writeFloatBE=function(t,e,r){return Wo(this,t,e,!1,r)},vo.prototype.writeDoubleLE=function(t,e,r){return Xo(this,t,e,!0,r)},vo.prototype.writeDoubleBE=function(t,e,r){return Xo(this,t,e,!1,r)},vo.prototype.copy=function(t,e,r,n){if(!vo.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o=n-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var i=o-1;i>=0;--i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return o},vo.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!vo.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var o=t.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(t=o)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var s=vo.isBuffer(t)?t:new vo(t,n),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=s[i%a]}return this};var Vo=/[^+\/0-9A-Za-z-_]/g;function Go(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Ko(t){return oo.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(Vo,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Yo(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function Jo(t){return t instanceof ArrayBuffer||null!=t&&null!=t.constructor&&"ArrayBuffer"===t.constructor.name&&"number"==typeof t.byteLength}function $o(t){return t!=t}var Qo={}.toString,Zo=Array.isArray||function(t){return"[object Array]"==Qo.call(t)},ti={};(function(t){var e=Object.prototype.toString,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===e.call(Blob),n="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===e.call(File);ti=function e(o){if(!o||"object"!=typeof o)return!1;if(Zo(o)){for(var i=0,s=o.length;i<s;i++)if(e(o[i]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(o)||"function"==typeof ArrayBuffer&&o instanceof ArrayBuffer||r&&o instanceof Blob||n&&o instanceof File)return!0;if(o.toJSON&&"function"==typeof o.toJSON&&1===arguments.length)return e(o.toJSON(),!0);for(var a in o)if(Object.prototype.hasOwnProperty.call(o,a)&&e(o[a]))return!0;return!1}}).call(this,yo.Buffer);var ei={encode:function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e},decode:function(t){for(var e={},r=t.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},ri=1e3,ni=6e4,oi=864e5;function ii(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var si={};function ai(t){var e;function r(){if(r.enabled){var t=r,n=+new Date,o=n-(e||n);t.diff=o,t.prev=e,t.curr=n,e=n;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=si.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,r){if("%%"===e)return e;a++;var n=si.formatters[r];if("function"==typeof n){var o=i[a];e=n.call(t,o),i.splice(a,1),a--}return e}),si.formatArgs.call(t,i),(r.log||si.log||console.log.bind(console)).apply(t,i)}}return r.namespace=t,r.enabled=si.enabled(t),r.useColors=si.useColors(),r.color=function(t){var e,r=0;for(e in t)r=(r<<5)-r+t.charCodeAt(e),r|=0;return si.colors[Math.abs(r)%si.colors.length]}(t),r.destroy=li,"function"==typeof si.init&&si.init(r),si.instances.push(r),r}function li(){var t=si.instances.indexOf(this);return-1!==t&&(si.instances.splice(t,1),!0)}(si=si=ai.debug=ai.default=ai).coerce=function(t){return t instanceof Error?t.stack||t.message:t},si.disable=function(){si.enable("")},si.enable=function(t){var e;si.save(t),si.names=[],si.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),n=r.length;for(e=0;e<n;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?si.skips.push(new RegExp("^"+t.substr(1)+"$")):si.names.push(new RegExp("^"+t+"$")));for(e=0;e<si.instances.length;e++){var o=si.instances[e];o.enabled=si.enabled(o.namespace)}},si.enabled=function(t){if("*"===t[t.length-1])return!0;var e,r;for(e=0,r=si.skips.length;e<r;e++)if(si.skips[e].test(t))return!1;for(e=0,r=si.names.length;e<r;e++)if(si.names[e].test(t))return!0;return!1},si.humanize=function(t,e){e=e||{};var r,n=typeof t;if("string"===n&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"days":case"day":case"d":return r*oi;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return r*ni;case"seconds":case"second":case"secs":case"sec":case"s":return r*ri;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===n&&!1===isNaN(t))return e.long?ii(r=t,oi,"day")||ii(r,36e5,"hour")||ii(r,ni,"minute")||ii(r,ri,"second")||r+" ms":function(t){return t>=oi?Math.round(t/oi)+"d":t>=36e5?Math.round(t/36e5)+"h":t>=ni?Math.round(t/ni)+"m":t>=ri?Math.round(t/ri)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))},si.instances=[],si.names=[],si.skips=[],si.formatters={};var ui={};(function(t){function e(){var e;try{e=ui.storage.debug}catch(t){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(ui=ui=si).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},ui.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+ui.humanize(this.diff),e){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(n++,"%c"===t&&(o=n))}),t.splice(o,0,r)}},ui.save=function(t){try{null==t?ui.storage.removeItem("debug"):ui.storage.debug=t}catch(t){}},ui.load=e,ui.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},ui.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),ui.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],ui.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},ui.enable(e())}).call(this,St);var pi={};(function(t){pi=function(o){return e&&t.Buffer.isBuffer(o)||r&&(o instanceof t.ArrayBuffer||n(o))};var e="function"==typeof t.Buffer&&"function"==typeof t.Buffer.isBuffer,r="function"==typeof t.ArrayBuffer,n=r&&"function"==typeof t.ArrayBuffer.isView?t.ArrayBuffer.isView:function(e){return e.buffer instanceof t.ArrayBuffer}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ci={};(function(t){var e=Object.prototype.toString,r="function"==typeof t.Blob||"[object BlobConstructor]"===e.call(t.Blob),n="function"==typeof t.File||"[object FileConstructor]"===e.call(t.File);ci.deconstructPacket=function(t){var e=[],r=t.data,n=t;return n.data=function t(e,r){if(!e)return e;if(pi(e)){var n={_placeholder:!0,num:r.length};return r.push(e),n}if(Zo(e)){for(var o=new Array(e.length),i=0;i<e.length;i++)o[i]=t(e[i],r);return o}if("object"==typeof e&&!(e instanceof Date)){o={};for(var s in e)o[s]=t(e[s],r);return o}return e}(r,e),n.attachments=e.length,{packet:n,buffers:e}},ci.reconstructPacket=function(t,e){return t.data=function t(e,r){if(!e)return e;if(e&&e._placeholder)return r[e.num];if(Zo(e))for(var n=0;n<e.length;n++)e[n]=t(e[n],r);else if("object"==typeof e)for(var o in e)e[o]=t(e[o],r);return e}(t.data,e),t.attachments=void 0,t},ci.removeBlobs=function(t,e){var o=0,i=t;!function t(s,a,l){if(!s)return s;if(r&&s instanceof Blob||n&&s instanceof File){o++;var u=new FileReader;u.onload=function(){l?l[a]=this.result:i=this.result,--o||e(i)},u.readAsArrayBuffer(s)}else if(Zo(s))for(var p=0;p<s.length;p++)t(s[p],p,s);else if("object"==typeof s&&!pi(s))for(var c in s)t(s[c],c,s)}(i),o||e(i)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var hi={},di=ui("socket.io-parser");function fi(){}hi.protocol=4,hi.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],hi.CONNECT=0,hi.DISCONNECT=1,hi.EVENT=2,hi.ACK=3,hi.ERROR=4,hi.BINARY_EVENT=5,hi.BINARY_ACK=6,hi.Encoder=fi,hi.Decoder=mi;var yi=hi.ERROR+'"encode error"';function gi(t){var e=""+t.type;if(hi.BINARY_EVENT!==t.type&&hi.BINARY_ACK!==t.type||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data){var r=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===r)return yi;e+=r}return di("encoded %j as %s",t,e),e}function mi(){this.reconstructor=null}function vi(t){this.reconPack=t,this.buffers=[]}function bi(t){return{type:hi.ERROR,data:"parser error: "+t}}fi.prototype.encode=function(t,e){di("encoding packet %j",t),hi.BINARY_EVENT===t.type||hi.BINARY_ACK===t.type?function(t,e){ci.removeBlobs(t,function(t){var r=ci.deconstructPacket(t),n=gi(r.packet),o=r.buffers;o.unshift(n),e(o)})}(t,e):e([gi(t)])},Zn(mi.prototype),mi.prototype.add=function(t){var e;if("string"==typeof t)e=function(t){var e=0,r={type:Number(t.charAt(0))};if(null==hi.types[r.type])return bi("unknown packet type "+r.type);if(hi.BINARY_EVENT===r.type||hi.BINARY_ACK===r.type){for(var n="";"-"!==t.charAt(++e)&&(n+=t.charAt(e),e!=t.length););if(n!=Number(n)||"-"!==t.charAt(e))throw new Error("Illegal attachments");r.attachments=Number(n)}if("/"===t.charAt(e+1))for(r.nsp="";++e;){if(","===(i=t.charAt(e)))break;if(r.nsp+=i,e===t.length)break}else r.nsp="/";var o=t.charAt(e+1);if(""!==o&&Number(o)==o){for(r.id="";++e;){var i;if(null==(i=t.charAt(e))||Number(i)!=i){--e;break}if(r.id+=t.charAt(e),e===t.length)break}r.id=Number(r.id)}if(t.charAt(++e)){var s=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!(!1!==s&&(r.type===hi.ERROR||Zo(s))))return bi("invalid payload");r.data=s}return di("decoded %s as %j",t,r),r}(t),hi.BINARY_EVENT===e.type||hi.BINARY_ACK===e.type?(this.reconstructor=new vi(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!pi(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",e))}},mi.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},vi.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=ci.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},vi.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};var wi=function(t,e){for(var r=[],n=(e=e||0)||0;n<t.length;n++)r[n-e]=t[n];return r},Si={},Pi=ui("socket.io-client:socket");Si=Si=Ei;var ki={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},_i=Zn.prototype.emit;function Ei(t,e,r){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}function Ci(){}Zn(Ei.prototype),Ei.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[no(t,"open",Qn(this,"onopen")),no(t,"packet",Qn(this,"onpacket")),no(t,"close",Qn(this,"onclose"))]}},Ei.prototype.open=Ei.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},Ei.prototype.send=function(){var t=wi(arguments);return t.unshift("message"),this.emit.apply(this,t),this},Ei.prototype.emit=function(t){if(ki.hasOwnProperty(t))return _i.apply(this,arguments),this;var e=wi(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:ti(e))?hi.BINARY_EVENT:hi.EVENT,data:e,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(Pi("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},Ei.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},Ei.prototype.onopen=function(){if(Pi("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?ei.encode(this.query):this.query;Pi("sending connect packet with query %s",t),this.packet({type:hi.CONNECT,query:t})}else this.packet({type:hi.CONNECT})},Ei.prototype.onclose=function(t){Pi("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},Ei.prototype.onpacket=function(t){var e=t.nsp===this.nsp,r=t.type===hi.ERROR&&"/"===t.nsp;if(e||r)switch(t.type){case hi.CONNECT:this.onconnect();break;case hi.EVENT:case hi.BINARY_EVENT:this.onevent(t);break;case hi.ACK:case hi.BINARY_ACK:this.onack(t);break;case hi.DISCONNECT:this.ondisconnect();break;case hi.ERROR:this.emit("error",t.data)}},Ei.prototype.onevent=function(t){var e=t.data||[];Pi("emitting event %j",e),null!=t.id&&(Pi("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?_i.apply(this,e):this.receiveBuffer.push(e)},Ei.prototype.ack=function(t){var e=this,r=!1;return function(){if(!r){r=!0;var n=wi(arguments);Pi("sending ack %j",n),e.packet({type:ti(n)?hi.BINARY_ACK:hi.ACK,id:t,data:n})}}},Ei.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(Pi("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):Pi("bad ack %s",t.id)},Ei.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Ei.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)_i.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},Ei.prototype.ondisconnect=function(){Pi("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Ei.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},Ei.prototype.close=Ei.prototype.disconnect=function(){return this.connected&&(Pi("performing disconnect (%s)",this.nsp),this.packet({type:hi.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},Ei.prototype.compress=function(t){return this.flags.compress=t,this},Ei.prototype.binary=function(t){return this.flags.binary=t,this};var Ui=function(t,e,r){var n=!1;return r=r||Ci,o.count=t,0===t?e():o;function o(t,i){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(n=!0,e(t),e=r):0!==o.count||n||e(null,i)}},Ti=function(t,e,r){var n=t.byteLength;if(e=e||0,r=r||n,t.slice)return t.slice(e,r);if(e<0&&(e+=n),r<0&&(r+=n),r>n&&(r=n),e>=n||e>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(t),i=new Uint8Array(r-e),s=e,a=0;s<r;s++,a++)i[a]=o[s];return i.buffer},Fi={};!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),r=0;r<t.length;r++)e[t.charCodeAt(r)]=r;Fi.encode=function(e){var r,n=new Uint8Array(e),o=n.length,i="";for(r=0;r<o;r+=3)i+=t[n[r]>>2],i+=t[(3&n[r])<<4|n[r+1]>>4],i+=t[(15&n[r+1])<<2|n[r+2]>>6],i+=t[63&n[r+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},Fi.decode=function(t){var r,n,o,i,s,a=.75*t.length,l=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var p=new ArrayBuffer(a),c=new Uint8Array(p);for(r=0;r<l;r+=4)n=e[t.charCodeAt(r)],o=e[t.charCodeAt(r+1)],i=e[t.charCodeAt(r+2)],s=e[t.charCodeAt(r+3)],c[u++]=n<<2|o>>4,c[u++]=(15&o)<<4|i>>2,c[u++]=(3&i)<<6|63&s;return p}}();var Oi={};(function(t){var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),n=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=e&&e.prototype.append&&e.prototype.getBlob;function i(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var o=new Uint8Array(r.byteLength);o.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=o.buffer}t[e]=n}}}Oi=r?n?t.Blob:function(t,e){return i(t),new Blob(t,e||{})}:o?function(t,r){r=r||{};var n=new e;i(t);for(var o=0;o<t.length;o++)n.append(t[o]);return r.type?n.getBlob(r.type):n.getBlob()}:void 0}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ai=Object.keys||function(t){var e=[],r=Object.prototype.hasOwnProperty;for(var n in t)r.call(t,n)&&e.push(n);return e},xi={exports:{}};(function(t){!function(e){var r="object"==typeof xi.exports&&xi.exports,n=xi&&xi.exports==r&&xi,o="object"==typeof t&&t;o.global!==o&&o.window!==o||(e=o);var i,s,a,l=String.fromCharCode;function u(t){for(var e,r,n=[],o=0,i=t.length;o<i;)(e=t.charCodeAt(o++))>=55296&&e<=56319&&o<i?56320==(64512&(r=t.charCodeAt(o++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--):n.push(e);return n}function p(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(t,e){return l(t>>e&63|128)}function h(t,e){if(0==(4294967168&t))return l(t);var r="";return 0==(4294965248&t)?r=l(t>>6&31|192):0==(4294901760&t)?(p(t,e)||(t=65533),r=l(t>>12&15|224),r+=c(t,6)):0==(4292870144&t)&&(r=l(t>>18&7|240),r+=c(t,12),r+=c(t,6)),r+l(63&t|128)}function d(){if(a>=s)throw Error("Invalid byte index");var t=255&i[a];if(a++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function f(t){var e,r;if(a>s)throw Error("Invalid byte index");if(a==s)return!1;if(e=255&i[a],a++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|d())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|d()<<6|d())>=2048)return p(r,t)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=(7&e)<<18|d()<<12|d()<<6|d())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}var y={version:"2.1.2",encode:function(t,e){for(var r=!1!==(e=e||{}).strict,n=u(t),o=n.length,i=-1,s="";++i<o;)s+=h(n[i],r);return s},decode:function(t,e){var r=!1!==(e=e||{}).strict;i=u(t),s=i.length,a=0;for(var n,o=[];!1!==(n=f(r));)o.push(n);return function(t){for(var e,r=t.length,n=-1,o="";++n<r;)(e=t[n])>65535&&(o+=l((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=l(e);return o}(o)}};if(r&&!r.nodeType)if(n)n.exports=y;else{var g={}.hasOwnProperty;for(var m in y)g.call(y,m)&&(r[m]=y[m])}else e.utf8=y}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),xi=xi.exports;var Ri={};(function(t){var e;t&&t.ArrayBuffer&&(e=Fi);var r="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),n="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),o=r||n;Ri.protocol=3;var i=Ri.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=Ai(i),a={type:"error",data:"parser error"};function l(t,e,r){for(var n=new Array(t.length),o=Ui(t.length,r),i=function(t,r,o){e(r,function(e,r){n[t]=r,o(e,n)})},s=0;s<t.length;s++)i(s,t[s],o)}Ri.encodePacket=function(e,r,n,s){"function"==typeof r&&(s=r,r=!1),"function"==typeof n&&(s=n,n=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&a instanceof ArrayBuffer)return function(t,e,r){if(!e)return Ri.encodeBase64Packet(t,r);var n=t.data,o=new Uint8Array(n),s=new Uint8Array(1+n.byteLength);s[0]=i[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(e,r,s);if(Oi&&a instanceof t.Blob)return function(t,e,r){if(!e)return Ri.encodeBase64Packet(t,r);if(o)return function(t,e,r){if(!e)return Ri.encodeBase64Packet(t,r);var n=new FileReader;return n.onload=function(){t.data=n.result,Ri.encodePacket(t,e,!0,r)},n.readAsArrayBuffer(t.data)}(t,e,r);var n=new Uint8Array(1);return n[0]=i[t.type],r(new Oi([n.buffer,t.data]))}(e,r,s);if(a&&a.base64)return function(t,e){return e("b"+Ri.packets[t.type]+t.data.data)}(e,s);var l=i[e.type];return void 0!==e.data&&(l+=n?xi.encode(String(e.data),{strict:!1}):String(e.data)),s(""+l)},Ri.encodeBase64Packet=function(e,r){var n,o="b"+Ri.packets[e.type];if(Oi&&e.data instanceof t.Blob){var i=new FileReader;return i.onload=function(){var t=i.result.split(",")[1];r(o+t)},i.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=new Array(s.length),l=0;l<s.length;l++)a[l]=s[l];n=String.fromCharCode.apply(null,a)}return o+=t.btoa(n),r(o)},Ri.decodePacket=function(t,e,r){if(void 0===t)return a;if("string"==typeof t){if("b"===t.charAt(0))return Ri.decodeBase64Packet(t.substr(1),e);if(r&&!1===(t=function(t){try{t=xi.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return a;var n=t.charAt(0);return Number(n)==n&&s[n]?t.length>1?{type:s[n],data:t.substring(1)}:{type:s[n]}:a}n=new Uint8Array(t)[0];var o=Ti(t,1);return Oi&&"blob"===e&&(o=new Oi([o])),{type:s[n],data:o}},Ri.decodeBase64Packet=function(t,r){var n=s[t.charAt(0)];if(!e)return{type:n,data:{base64:!0,data:t.substr(1)}};var o=e.decode(t.substr(1));return"blob"===r&&Oi&&(o=new Oi([o])),{type:n,data:o}},Ri.encodePayload=function(t,e,r){"function"==typeof e&&(r=e,e=null);var n=ti(t);return e&&n?Oi&&!o?Ri.encodePayloadAsBlob(t,r):Ri.encodePayloadAsArrayBuffer(t,r):t.length?void l(t,function(t,r){Ri.encodePacket(t,!!n&&e,!1,function(t){r(null,function(t){return t.length+":"+t}(t))})},function(t,e){return r(e.join(""))}):r("0:")},Ri.decodePayload=function(t,e,r){if("string"!=typeof t)return Ri.decodePayloadAsBinary(t,e,r);var n;if("function"==typeof e&&(r=e,e=null),""===t)return r(a,0,1);for(var o,i,s="",l=0,u=t.length;l<u;l++){var p=t.charAt(l);if(":"===p){if(""===s||s!=(o=Number(s)))return r(a,0,1);if(s!=(i=t.substr(l+1,o)).length)return r(a,0,1);if(i.length){if(n=Ri.decodePacket(i,e,!1),a.type===n.type&&a.data===n.data)return r(a,0,1);if(!1===r(n,l+o,u))return}l+=o,s=""}else s+=p}return""!==s?r(a,0,1):void 0},Ri.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));l(t,function(t,e){Ri.encodePacket(t,!0,!0,function(t){return e(null,t)})},function(t,r){var n=r.reduce(function(t,e){var r;return t+(r="string"==typeof e?e.length:e.byteLength).toString().length+r+2},0),o=new Uint8Array(n),i=0;return r.forEach(function(t){var e="string"==typeof t,r=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);r=n.buffer}o[i++]=e?0:1;var a=r.byteLength.toString();for(s=0;s<a.length;s++)o[i++]=parseInt(a[s]);for(o[i++]=255,n=new Uint8Array(r),s=0;s<n.length;s++)o[i++]=n[s]}),e(o.buffer)})},Ri.encodePayloadAsBlob=function(t,e){l(t,function(t,e){Ri.encodePacket(t,!0,!0,function(t){var r=new Uint8Array(1);if(r[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);t=n.buffer,r[0]=0}var i=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)s[o]=parseInt(i[o]);if(s[i.length]=255,Oi){var a=new Oi([r.buffer,s.buffer,t]);e(null,a)}})},function(t,r){return e(new Oi(r))})},Ri.decodePayloadAsBinary=function(t,e,r){"function"==typeof e&&(r=e,e=null);for(var n=t,o=[];n.byteLength>0;){for(var i=new Uint8Array(n),s=0===i[0],l="",u=1;255!==i[u];u++){if(l.length>310)return r(a,0,1);l+=i[u]}n=Ti(n,2+l.length),l=parseInt(l);var p=Ti(n,0,l);if(s)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(t){var c=new Uint8Array(p);for(p="",u=0;u<c.length;u++)p+=String.fromCharCode(c[u])}o.push(p),n=Ti(n,l)}var h=o.length;o.forEach(function(t,n){r(Ri.decodePacket(t,e,!0),n,h)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Di=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ii=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Bi=function(t){var e=t,r=t.indexOf("["),n=t.indexOf("]");-1!=r&&-1!=n&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));for(var o=Di.exec(t||""),i={},s=14;s--;)i[Ii[s]]=o[s]||"";return-1!=r&&-1!=n&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i},ji={};function Mi(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}ji=Mi,Zn(Mi.prototype),Mi.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this},Mi.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},Mi.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},Mi.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},Mi.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Mi.prototype.onData=function(t){var e=Ri.decodePacket(t,this.socket.binaryType);this.onPacket(e)},Mi.prototype.onPacket=function(t){this.emit("packet",t)},Mi.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var Li=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t},Ni={};try{Ni="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){Ni=!1}var zi={};(function(t){zi=function(e){var r=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!r||Ni))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(t){}if(!r)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var qi,Hi={},Wi="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Xi=64,Vi={},Gi=0,Ki=0;function Yi(t){var e="";do{e=Wi[t%Xi]+e,t=Math.floor(t/Xi)}while(t>0);return e}function Ji(){var t=Yi(+new Date);return t!==qi?(Gi=0,qi=t):t+"."+Yi(Gi++)}for(;Ki<Xi;Ki++)Vi[Wi[Ki]]=Ki;Ji.encode=Yi,Ji.decode=function(t){var e=0;for(Ki=0;Ki<t.length;Ki++)e=e*Xi+Vi[t.charAt(Ki)];return e},Hi=Ji;var $i=ui("engine.io-client:polling"),Qi=ts,Zi=null!=new zi({xdomain:!1}).responseType;function ts(t){var e=t&&t.forceBase64;Zi&&!e||(this.supportsBinary=!1),ji.call(this,t)}Li(ts,ji),ts.prototype.name="polling",ts.prototype.doOpen=function(){this.poll()},ts.prototype.pause=function(t){var e=this;function r(){$i("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&($i("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){$i("pre-pause polling complete"),--n||r()})),this.writable||($i("we are currently writing - waiting to pause"),n++,this.once("drain",function(){$i("pre-pause writing complete"),--n||r()}))}else r()},ts.prototype.poll=function(){$i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},ts.prototype.onData=function(t){var e=this;$i("polling got data %s",t),Ri.decodePayload(t,this.socket.binaryType,function(t,r,n){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():$i('ignoring poll - transport state "%s"',this.readyState))},ts.prototype.doClose=function(){var t=this;function e(){$i("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?($i("transport open - closing"),e()):($i("transport not open - deferring close"),this.once("open",e))},ts.prototype.write=function(t){var e=this;this.writable=!1;var r=function(){e.writable=!0,e.emit("drain")};Ri.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,r)})},ts.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(t[this.timestampParam]=Hi()),this.supportsBinary||t.sid||(t.b64=1),t=ei.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(r=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t};var es={};(function(t){es=i;var e,r=/\n/g,n=/\\n/g;function o(){}function i(r){Qi.call(this,r),this.query=this.query||{},e||(t.___eio||(t.___eio=[]),e=t.___eio),this.index=e.length;var n=this;e.push(function(t){n.onData(t)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=o)},!1)}Li(i,Qi),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Qi.prototype.doClose.call(this)},i.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},i.prototype.doWrite=function(t,e){var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}function u(){p(),e()}function p(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(t){o.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(t)}catch(t){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}this.form.action=this.uri(),p(),t=t.replace(n,"\\\n"),this.area.value=t.replace(r,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var rs={};(function(t){var e=ui("engine.io-client:polling-xhr");function r(){}function n(e){if(Qi.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var r="https:"===location.protocol,n=location.port;n||(n=r?443:80),this.xd=e.hostname!==t.location.hostname||n!==e.port,this.xs=e.secure!==r}}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function i(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}(rs=n).Request=o,Li(n,Qi),n.prototype.supportsBinary=!0,n.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new o(t)},n.prototype.doWrite=function(t,e){var r="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:r}),o=this;n.on("success",e),n.on("error",function(t){o.onError("xhr post error",t)}),this.sendXhr=n},n.prototype.doPoll=function(){e("xhr poll");var t=this.request(),r=this;t.on("data",function(t){r.onData(t)}),t.on("error",function(t){r.onError("xhr poll error",t)}),this.pollXhr=t},Zn(o.prototype),o.prototype.create=function(){var r={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new zi(r),i=this;try{e("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var s in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this.extraHeaders[s])}catch(t){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){i.onLoad()},n.onerror=function(){i.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState)try{var t=n.getResponseHeader("Content-Type");i.supportsBinary&&"application/octet-stream"===t&&(n.responseType="arraybuffer")}catch(t){}4===n.readyState&&(200===n.status||1223===n.status?i.onLoad():setTimeout(function(){i.onError(n.status)},0))},e("xhr data %s",this.data),n.send(this.data)}catch(t){return void setTimeout(function(){i.onError(t)},0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(t){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",i):t.addEventListener&&t.addEventListener("beforeunload",i,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ns={},os={};(function(t){var e,r=ui("engine.io-client:websocket"),n=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{e=ns}catch(t){}var o=n;function i(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=n&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(o=e),ji.call(this,t)}o||"undefined"!=typeof window||(o=e),os=i,Li(i,ji),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new o(t,e):new o(t):new o(t,e,r)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},i.prototype.write=function(e){var n=this;this.writable=!1;for(var o=e.length,i=0,s=o;i<s;i++)!function(e){Ri.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var s={};e.options&&(s.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof i?t.Buffer.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,s)}catch(t){r("websocket closed before onclose event")}--o||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[i])},i.prototype.onClose=function(){ji.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=Hi()),this.supportsBinary||(t.b64=1),(t=ei.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t},i.prototype.check=function(){return!(!o||"__initialize"in o&&this.name===i.prototype.name)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var is={};(function(t){is.polling=function(e){var r=!1,n=!1,o=!1!==e.jsonp;if(t.location){var i="https:"===location.protocol,s=location.port;s||(s=i?443:80),r=e.hostname!==location.hostname||s!==e.port,n=e.secure!==i}if(e.xdomain=r,e.xscheme=n,"open"in new zi(e)&&!e.forceJSONP)return new rs(e);if(!o)throw new Error("JSONP disabled");return new es(e)},is.websocket=os}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ss={};(function(t){var e=ui("engine.io-client:socket");function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=Bi(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=Bi(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=ei.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var o="object"==typeof t&&t;o.global===o&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}ss=r,r.priorWebsocketSuccess=!1,Zn(r.prototype),r.protocol=Ri.protocol,r.Socket=r,r.Transport=ji,r.transports=is,r.parser=Ri,r.prototype.createTransport=function(t){e('creating transport "%s"',t);var r=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(this.query);r.EIO=Ri.protocol,r.transport=t;var n=this.transportOptions[t]||{};return this.id&&(r.sid=this.id),new is[t]({query:r,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},r.prototype.open=function(){var t;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},r.prototype.setTransport=function(t){e("setting transport %s",t.name);var r=this;this.transport&&(e("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){r.onDrain()}).on("packet",function(t){r.onPacket(t)}).on("error",function(t){r.onError(t)}).on("close",function(){r.onClose("transport close")})},r.prototype.probe=function(t){e('probing transport "%s"',t);var n=this.createTransport(t,{probe:1}),o=!1,i=this;function s(){if(i.onlyBinaryUpgrades){var s=!this.supportsBinary&&i.transport.supportsBinary;o=o||s}o||(e('probe transport "%s" opened',t),n.send([{type:"ping",data:"probe"}]),n.once("packet",function(s){if(!o)if("pong"===s.type&&"probe"===s.data){if(e('probe transport "%s" pong',t),i.upgrading=!0,i.emit("upgrading",n),!n)return;r.priorWebsocketSuccess="websocket"===n.name,e('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){o||"closed"!==i.readyState&&(e("changing transport and sending upgrade packet"),h(),i.setTransport(n),n.send([{type:"upgrade"}]),i.emit("upgrade",n),n=null,i.upgrading=!1,i.flush())})}else{e('probe transport "%s" failed',t);var a=new Error("probe error");a.transport=n.name,i.emit("upgradeError",a)}}))}function a(){o||(o=!0,h(),n.close(),n=null)}function l(r){var o=new Error("probe error: "+r);o.transport=n.name,a(),e('probe transport "%s" failed because of error: %s',t,r),i.emit("upgradeError",o)}function u(){l("transport closed")}function p(){l("socket closed")}function c(t){n&&t.name!==n.name&&(e('"%s" works - aborting "%s"',t.name,n.name),a())}function h(){n.removeListener("open",s),n.removeListener("error",l),n.removeListener("close",u),i.removeListener("close",p),i.removeListener("upgrading",c)}r.priorWebsocketSuccess=!1,n.once("open",s),n.once("error",l),n.once("close",u),this.once("close",p),this.once("upgrading",c),n.open()},r.prototype.onOpen=function(){if(e("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){e("starting upgrade probes");for(var t=0,n=this.upgrades.length;t<n;t++)this.probe(this.upgrades[t])}},r.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(e('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var r=new Error("server error");r.code=t.data,this.onError(r);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else e('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},r.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){e("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},r.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(e("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this},r.prototype.sendPacket=function(t,e,r,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:t,data:e,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},r.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?o():r()}):this.upgrading?o():r()}function r(){t.onClose("forced close"),e("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),r()}function o(){t.once("upgrade",n),t.once("upgradeError",n)}return this},r.prototype.onError=function(t){e("socket error %j",t),r.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},r.prototype.onClose=function(t,r){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(e('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,r),this.writeBuffer=[],this.prevBufferLen=0)},r.prototype.filterUpgrades=function(t){for(var e=[],r=0,n=t.length;r<n;r++)~ro(this.transports,t[r])&&e.push(t[r]);return e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var as={};(as=ss).parser=Ri;var ls={},us=ui("socket.io-client:manager"),ps=Object.prototype.hasOwnProperty;function cs(t,e){if(!(this instanceof cs))return new cs(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new Yn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=e.parser||hi;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}ls=cs,cs.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)ps.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},cs.prototype.updateSocketIds=function(){for(var t in this.nsps)ps.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},cs.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},Zn(cs.prototype),cs.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},cs.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},cs.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},cs.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},cs.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},cs.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},cs.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},cs.prototype.open=cs.prototype.connect=function(t,e){if(us("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;us("opening %s",this.uri),this.engine=as(this.uri,this.opts);var r=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=no(r,"open",function(){n.onopen(),t&&t()}),i=no(r,"error",function(e){if(us("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var r=new Error("Connection error");r.data=e,t(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;us("connect attempt will timeout after %d",s);var a=setTimeout(function(){us("connect attempt timed out after %d",s),o.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(o),this.subs.push(i),this},cs.prototype.onopen=function(){us("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(no(t,"data",Qn(this,"ondata"))),this.subs.push(no(t,"ping",Qn(this,"onping"))),this.subs.push(no(t,"pong",Qn(this,"onpong"))),this.subs.push(no(t,"error",Qn(this,"onerror"))),this.subs.push(no(t,"close",Qn(this,"onclose"))),this.subs.push(no(this.decoder,"decoded",Qn(this,"ondecoded")))},cs.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},cs.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},cs.prototype.ondata=function(t){this.decoder.add(t)},cs.prototype.ondecoded=function(t){this.emit("packet",t)},cs.prototype.onerror=function(t){us("error",t),this.emitAll("error",t)},cs.prototype.socket=function(t,e){var r=this.nsps[t];if(!r){r=new Si(this,t,e),this.nsps[t]=r;var n=this;r.on("connecting",o),r.on("connect",function(){r.id=n.generateId(t)}),this.autoConnect&&o()}function o(){~ro(n.connecting,r)||n.connecting.push(r)}return r},cs.prototype.destroy=function(t){var e=ro(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},cs.prototype.packet=function(t){us("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(r){for(var n=0;n<r.length;n++)e.engine.write(r[n],t.options);e.encoding=!1,e.processPacketQueue()}))},cs.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},cs.prototype.cleanup=function(){us("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},cs.prototype.close=cs.prototype.disconnect=function(){us("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},cs.prototype.onclose=function(t){us("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},cs.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)us("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();us("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(us("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(us("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(us("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(r)}})}},cs.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)};var hs={};(function(t){var e=ui("socket.io-client:url");hs=function(r,n){var o=r;n=n||t.location,null==r&&(r=n.protocol+"//"+n.host),"string"==typeof r&&("/"===r.charAt(0)&&(r="/"===r.charAt(1)?n.protocol+r:n.host+r),/^(https?|wss?):\/\//.test(r)||(e("protocol-less url %s",r),r=void 0!==n?n.protocol+"//"+r:"https://"+r),e("parse %s",r),o=Bi(r)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";var i=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+i+":"+o.port,o.href=o.protocol+"://"+i+(n&&n.port===o.port?"":":"+o.port),o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ds={},fs=ui("socket.io-client"),ys=(ds=ds=gs).managers={};function gs(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,n=hs(t),o=n.source,i=n.id,s=n.path,a=ys[i]&&s in ys[i].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?(fs("ignoring socket cache for %s",o),r=ls(o,e)):(ys[i]||(fs("new io instance for %s",o),ys[i]=ls(o,e)),r=ys[i]),n.query&&!e.query&&(e.query=n.query),r.socket(n.path,e)}ds.protocol=hi.protocol,ds.connect=gs,ds.Manager=ls,ds.Socket=Si;var ms={},vs=Object.prototype.hasOwnProperty;function bs(t){return decodeURIComponent(t.replace(/\+/g," "))}ms.stringify=function(t,e){e=e||"";var r=[];for(var n in"string"!=typeof e&&(e="?"),t)vs.call(t,n)&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return r.length?e+r.join("&"):""},ms.parse=function(t){for(var e,r=/([^=?&]+)=?([^&]*)/g,n={};e=r.exec(t);){var o=bs(e[1]),i=bs(e[2]);o in n||(n[o]=i)}return n};var ws=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},Ss={};(function(t){"use strict";var e=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,n=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],o={hash:1,query:1};function i(e){var n,i=t&&t.location||{},s={},l=typeof(e=e||i);if("blob:"===e.protocol)s=new a(unescape(e.pathname),{});else if("string"===l)for(n in s=new a(e,{}),o)delete s[n];else if("object"===l){for(n in e)n in o||(s[n]=e[n]);void 0===s.slashes&&(s.slashes=r.test(e.href))}return s}function s(t){var r=e.exec(t);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function a(t,e,r){if(!(this instanceof a))return new a(t,e,r);var o,l,u,p,c,h,d=n.slice(),f=typeof e,y=this,g=0;for("object"!==f&&"string"!==f&&(r=e,e=null),r&&"function"!=typeof r&&(r=ms.parse),e=i(e),o=!(l=s(t||"")).protocol&&!l.slashes,y.slashes=l.slashes||o&&e.slashes,y.protocol=l.protocol||e.protocol||"",t=l.rest,l.slashes||(d[2]=[/(.*)/,"pathname"]);g<d.length;g++)u=(p=d[g])[0],h=p[1],u!=u?y[h]=t:"string"==typeof u?~(c=t.indexOf(u))&&("number"==typeof p[2]?(y[h]=t.slice(0,c),t=t.slice(c+p[2])):(y[h]=t.slice(c),t=t.slice(0,c))):(c=u.exec(t))&&(y[h]=c[1],t=t.slice(0,c.index)),y[h]=y[h]||o&&p[3]&&e[h]||"",p[4]&&(y[h]=y[h].toLowerCase());r&&(y.query=r(y.query)),o&&e.slashes&&"/"!==y.pathname.charAt(0)&&(""!==y.pathname||""!==e.pathname)&&(y.pathname=function(t,r){for(var n=(e.pathname||"/").split("/").slice(0,-1).concat(t.split("/")),o=n.length,i=n[o-1],s=!1,a=0;o--;)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),a++):a&&(0===o&&(s=!0),n.splice(o,1),a--);return s&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(y.pathname)),ws(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(p=y.auth.split(":"),y.username=p[0]||"",y.password=p[1]||""),y.origin=y.protocol&&y.host&&"file:"!==y.protocol?y.protocol+"//"+y.host:"null",y.href=y.toString()}a.prototype={set:function(t,e,r){var o=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||ms.parse)(e)),o[t]=e;break;case"port":o[t]=e,ws(e,o.protocol)?e&&(o.host=o.hostname+":"+e):(o.host=o.hostname,o[t]="");break;case"hostname":o[t]=e,o.port&&(e+=":"+o.port),o.host=e;break;case"host":o[t]=e,/:\d+$/.test(e)?(e=e.split(":"),o.port=e.pop(),o.hostname=e.join(":")):(o.hostname=e,o.port="");break;case"protocol":o.protocol=e.toLowerCase(),o.slashes=!r;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";o[t]=e.charAt(0)!==i?i+e:e}else o[t]=e;break;default:o[t]=e}for(var s=0;s<n.length;s++){var a=n[s];a[4]&&(o[a[1]]=o[a[1]].toLowerCase())}return o.origin=o.protocol&&o.host&&"file:"!==o.protocol?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(t){t&&"function"==typeof t||(t=ms.stringify);var e,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(r.slashes?"//":"");return r.username&&(o+=r.username,r.password&&(o+=":"+r.password),o+="@"),o+=r.host+r.pathname,(e="object"==typeof r.query?t(r.query):r.query)&&(o+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(o+=r.hash),o}},a.extractProtocol=s,a.location=i,a.qs=ms,Ss=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ps=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ks=function(){function t(e,r){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var n=S();this.on=n.on.bind(n),this.off=n.off.bind(n),this.emit=n.emit.bind(n);var o=Ss(e);this.assembly=r,this.socket=ds.connect(o.origin,{path:o.pathname}),this.attachDefaultHandlers()}return t.prototype.attachDefaultHandlers=function(){var t=this;this.socket.on("connect",function(){t.socket.emit("assembly_connect",{id:t.assembly.assembly_id}),t.emit("connect")}),this.socket.on("assembly_finished",function(){t.emit("finished"),t.close()}),this.socket.on("assembly_upload_finished",function(e){t.emit("upload",e)}),this.socket.on("assembly_uploading_finished",function(){t.emit("executing")}),this.socket.on("assembly_upload_meta_data_extracted",function(){t.emit("metadata")}),this.socket.on("assembly_result_finished",function(e,r){t.emit("result",e,r)}),this.socket.on("assembly_error",function(e){t.emit("error",Ps(new Error(e.message),e))})},t.prototype.close=function(){this.socket.disconnect()},t}(),_s={};Object.defineProperty(_s,"__esModule",{value:!0}),_s.setItem=function(t,e){if(Es)return localStorage.setItem(t,e)},_s.getItem=function(t){if(Es)return localStorage.getItem(t)},_s.removeItem=function(t){if(Es)return localStorage.removeItem(t)};var Es=!1;try{Es="localStorage"in window;var Cs="tusSupport";localStorage.setItem(Cs,localStorage.getItem(Cs))}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;Es=!1}_s.canStoreURLs=Es;var Us=Object.prototype.hasOwnProperty,Ts=Object.prototype.toString,Fs=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Ts.call(t)},Os=function(t){if(!t||"[object Object]"!==Ts.call(t))return!1;var e,r=Us.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Us.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;for(e in t);return void 0===e||Us.call(t,e)},As={};Object.defineProperty(As,"__esModule",{value:!0}),As.encode=function(t){return xs(unescape(encodeURIComponent(t)))};var xs=window.btoa;As.isSupported="btoa"in window;var Rs={};Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.newRequest=function(){return new window.XMLHttpRequest},Rs.resolveUrl=function(t,e){return(0,Is.default)(t,e)};var Ds,Is=(Ds=ct)&&Ds.__esModule?Ds:{default:Ds},Bs={},js=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.getSource=function(t){if("function"==typeof t.slice&&void 0!==t.size)return new Ms(t);throw new Error("source object may only be an instance of File or Blob in this environment")};var Ms=function(){function t(e){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._file=e,this.size=e.size}return js(t,[{key:"slice",value:function(t,e){return this._file.slice(t,e)}},{key:"close",value:function(){}}]),t}(),Ls={};Object.defineProperty(Ls,"__esModule",{value:!0});var Ns=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Object.getPrototypeOf(e).call(this,t.message));o.originalRequest=n,o.causingError=r;var i=t.message;return null!=r&&(i+=", caused by "+r.toString()),null!=n&&(i+=", originated from request (response code: "+n.status+", response text: "+n.responseText+")"),o.message=i,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Error),e}();Ls.default=Ns;var zs={};Object.defineProperty(zs,"__esModule",{value:!0}),zs.default=function(t,e){return["tus",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-")};var qs={},Hs=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();Object.defineProperty(qs,"__esModule",{value:!0});var Ws=Js(zs),Xs=Js(Ls),Vs=Js(function t(){var e,r,n,o,i,s,a=arguments[0],l=1,u=arguments.length,p=!1;for("boolean"==typeof a&&(p=a,a=arguments[1]||{},l=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});l<u;++l)if(null!=(e=arguments[l]))for(r in e)n=a[r],a!==(o=e[r])&&(p&&o&&(Os(o)||(i=Fs(o)))?(i?(i=!1,s=n&&Fs(n)?n:[]):s=n&&Os(n)?n:{},a[r]=t(p,s,o)):void 0!==o&&(a[r]=o));return a}),Gs=Ys(As),Ks=Ys(_s);function Ys(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Js(t){return t&&t.__esModule?t:{default:t}}var $s={endpoint:null,fingerprint:Ws.default,resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1,uploadUrl:null,uploadSize:null,overridePatchMethod:!1,retryDelays:null,removeFingerprintOnSuccess:!1},Qs=function(){function t(e,r){!function(e,r){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.options=(0,Vs.default)(!0,{},$s,r),this.file=e,this.url=null,this._xhr=null,this._fingerprint=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0}return Hs(t,[{key:"start",value:function(){var t=this,e=this.file;if(e)if(this.options.endpoint||this.options.uploadUrl){var r=this._source=(0,Bs.getSource)(e,this.options.chunkSize);if(null!=this.options.uploadSize){var n=+this.options.uploadSize;if(isNaN(n))throw new Error("tus: cannot convert `uploadSize` option into a number");this._size=n}else{if(null==(n=r.size))throw new Error("tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option");this._size=n}var o,i=this.options.retryDelays;if(null!=i){if("[object Array]"!==Object.prototype.toString.call(i))throw new Error("tus: the `retryDelays` option must either be an array or null");o=t.options.onError,t.options.onError=function(e){t.options.onError=o,null!=t._offset&&t._offset>t._offsetBeforeRetry&&(t._retryAttempt=0);var r=!0;if("undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),t._retryAttempt<i.length&&null!=e.originalRequest&&!Zs(e.originalRequest.status,400)&&r){var n=i[t._retryAttempt++];t._offsetBeforeRetry=t._offset,t.options.uploadUrl=t.url,t._retryTimeout=setTimeout(function(){t.start()},n)}else t._emitError(e)}}if(this._aborted=!1,null==this.url){if(null!=this.options.uploadUrl)return this.url=this.options.uploadUrl,void this._resumeUpload();if(this.options.resume){this._fingerprint=this.options.fingerprint(e,this.options);var s=Ks.getItem(this._fingerprint);if(null!=s)return this.url=s,void this._resumeUpload()}this._createUpload()}else this._resumeUpload()}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"abort",value:function(){null!==this._xhr&&(this._xhr.abort(),this._source.close(),this._aborted=!0),null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null)}},{key:"_emitXhrError",value:function(t,e,r){this._emitError(new Xs.default(e,r,t))}},{key:"_emitError",value:function(t){if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}},{key:"_emitSuccess",value:function(){"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,r){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,r)}},{key:"_setupXHR",value:function(t){this._xhr=t,t.setRequestHeader("Tus-Resumable","1.0.0");var e=this.options.headers;for(var r in e)t.setRequestHeader(r,e[r]);t.withCredentials=this.options.withCredentials}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=(0,Rs.newRequest)();e.open("POST",this.options.endpoint,!0),e.onload=function(){if(Zs(e.status,200)){var r=e.getResponseHeader("Location");if(null!=r){if(t.url=(0,Rs.resolveUrl)(t.options.endpoint,r),0===t._size)return t._emitSuccess(),void t._source.close();t.options.resume&&Ks.setItem(t._fingerprint,t.url),t._offset=0,t._startUpload()}else t._emitXhrError(e,new Error("tus: invalid or missing Location header"))}else t._emitXhrError(e,new Error("tus: unexpected response while creating upload"))},e.onerror=function(r){t._emitXhrError(e,new Error("tus: failed to create upload"),r)},this._setupXHR(e),e.setRequestHeader("Upload-Length",this._size);var r=function(t){if(!Gs.isSupported)return"";var e=[];for(var r in t)e.push(r+" "+Gs.encode(t[r]));return e.join(",")}(this.options.metadata);""!==r&&e.setRequestHeader("Upload-Metadata",r),e.send(null)}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=(0,Rs.newRequest)();e.open("HEAD",this.url,!0),e.onload=function(){if(!Zs(e.status,200))return t.options.resume&&Zs(e.status,400)&&Ks.removeItem(t._fingerprint),423===e.status?void t._emitXhrError(e,new Error("tus: upload is currently locked; retry later")):t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitXhrError(e,new Error("tus: unable to resume upload (new upload cannot be created without an endpoint)"));var r=parseInt(e.getResponseHeader("Upload-Offset"),10);if(isNaN(r))t._emitXhrError(e,new Error("tus: invalid or missing offset value"));else{var n=parseInt(e.getResponseHeader("Upload-Length"),10);if(isNaN(n))t._emitXhrError(e,new Error("tus: invalid or missing length value"));else{if(r===n)return t._emitProgress(n,n),void t._emitSuccess();t._offset=r,t._startUpload()}}},e.onerror=function(r){t._emitXhrError(e,new Error("tus: failed to resume upload"),r)},this._setupXHR(e),e.send(null)}},{key:"_startUpload",value:function(){var t=this;if(!this._aborted){var e=(0,Rs.newRequest)();this.options.overridePatchMethod?(e.open("POST",this.url,!0),e.setRequestHeader("X-HTTP-Method-Override","PATCH")):e.open("PATCH",this.url,!0),e.onload=function(){if(Zs(e.status,200)){var r=parseInt(e.getResponseHeader("Upload-Offset"),10);if(isNaN(r))t._emitXhrError(e,new Error("tus: invalid or missing offset value"));else{if(t._emitProgress(r,t._size),t._emitChunkComplete(r-t._offset,r,t._size),t._offset=r,r==t._size)return t.options.removeFingerprintOnSuccess&&t.options.resume&&Ks.removeItem(t._fingerprint),t._emitSuccess(),void t._source.close();t._startUpload()}}else t._emitXhrError(e,new Error("tus: unexpected response while uploading chunk"))},e.onerror=function(r){t._aborted||t._emitXhrError(e,new Error("tus: failed to upload chunk at offset "+t._offset),r)},"upload"in e&&(e.upload.onprogress=function(e){e.lengthComputable&&t._emitProgress(r+e.loaded,t._size)}),this._setupXHR(e),e.setRequestHeader("Upload-Offset",this._offset),e.setRequestHeader("Content-Type","application/offset+octet-stream");var r=this._offset,n=this._offset+this.options.chunkSize;(n===1/0||n>this._size)&&(n=this._size),e.send(this._source.slice(r,n)),this._emitProgress(this._offset,this._size)}}}]),t}();function Zs(t,e){return t>=e&&t<e+100}Qs.defaultOptions=$s,qs.default=Qs;var ta,ea=(ta=qs)&&ta.__esModule?ta:{default:ta};ea.default.defaultOptions;if("undefined"!=typeof window){var ra=window,na=ra.XMLHttpRequest,oa=ra.Blob;na&&oa&&oa.prototype.slice}else!0;var ia={Upload:ea.default},sa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aa=Z.Provider,la=Z.RequestClient,ua=Z.Socket,pa={endpoint:"",resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1,uploadUrl:null,uploadSize:null,overridePatchMethod:!1,retryDelays:null};function ca(t){var e=[];return{on:function(r,n){return e.push([r,n]),t.on(r,n)},remove:function(){e.forEach(function(e){var r=e[0],n=e[1];t.off(r,n)})}}}var ha=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return o.type="uploader",o.id="Tus",o.title="Tus",o.opts=sa({},{resume:!0,autoRetry:!0,useFastRemoteRetry:!0,limit:0,retryDelays:[0,1e3,3e3,5e3]},n),"number"==typeof o.opts.limit&&0!==o.opts.limit?o.limitUploads=nt(o.opts.limit):o.limitUploads=function(t){return t},o.uploaders=Object.create(null),o.uploaderEvents=Object.create(null),o.uploaderSockets=Object.create(null),o.handleResetProgress=o.handleResetProgress.bind(o),o.handleUpload=o.handleUpload.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleResetProgress=function(){var t=sa({},this.uppy.getState().files);Object.keys(t).forEach(function(e){if(t[e].tus&&t[e].tus.uploadUrl){var r=sa({},t[e].tus);delete r.uploadUrl,t[e]=sa({},t[e],{tus:r})}}),this.uppy.setState({files:t})},e.prototype.resetUploaderReferences=function(t){this.uploaders[t]&&(this.uploaders[t].abort(),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null),this.uploaderSockets[t]&&(this.uploaderSockets[t].close(),this.uploaderSockets[t]=null)},e.prototype.upload=function(t,e,r){var n=this;return this.resetUploaderReferences(t.id),new Promise(function(e,r){var o=sa({},pa,n.opts,t.tus||{});o.onError=function(e){n.uppy.log(e),n.uppy.emit("upload-error",t,e),e.message="Failed because: "+e.message,n.resetUploaderReferences(t.id),r(e)},o.onProgress=function(e,r){n.onReceiveUploadUrl(t,a.url),n.uppy.emit("upload-progress",t,{uploader:n,bytesUploaded:e,bytesTotal:r})},o.onSuccess=function(){n.uppy.emit("upload-success",t,a,a.url),a.url&&n.uppy.log("Download "+a.file.name+" from "+a.url),n.resetUploaderReferences(t.id),e(a)};var i=function(t,e,r){Object.prototype.hasOwnProperty.call(t,e)&&!Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=t[e])},s=sa({},t.meta);i(s,"type","filetype"),i(s,"name","filename"),o.metadata=s;var a=new ia.Upload(t.data,o);n.uploaders[t.id]=a,n.uploaderEvents[t.id]=ca(n.uppy),n.onFileRemove(t.id,function(r){n.resetUploaderReferences(t.id),e("upload "+r+" was removed")}),n.onPause(t.id,function(t){t?a.abort():a.start()}),n.onPauseAll(t.id,function(){a.abort()}),n.onCancelAll(t.id,function(){n.resetUploaderReferences(t.id)}),n.onResumeAll(t.id,function(){t.error&&a.abort(),a.start()}),t.isPaused||a.start()})},e.prototype.uploadRemote=function(t,e,r){var n=this;this.resetUploaderReferences(t.id);var o=sa({},this.opts,t.tus||{});return new Promise(function(e,r){if(n.uppy.log(t.remote.url),t.serverToken)return n.connectToServerSocket(t).then(function(){return e()}).catch(r);n.uppy.emit("upload-started",t),new(t.remote.providerOptions.provider?aa:la)(n.uppy,t.remote.providerOptions).post(t.remote.url,sa({},t.remote.body,{endpoint:o.endpoint,uploadUrl:o.uploadUrl,protocol:"tus",size:t.data.size,metadata:t.meta})).then(function(e){return n.uppy.setFileState(t.id,{serverToken:e.token}),t=n.uppy.getFile(t.id)}).then(function(t){return n.connectToServerSocket(t)}).then(function(){e()}).catch(function(t){r(new Error(t))})})},e.prototype.connectToServerSocket=function(t){var e=this;return new Promise(function(r,n){var o=t.serverToken,i=rt(t.remote.serverUrl),s=new ua({target:i+"/api/"+o});e.uploaderSockets[t.id]=s,e.uploaderEvents[t.id]=ca(e.uppy),e.onFileRemove(t.id,function(){s.send("pause",{}),r("upload "+t.id+" was removed")}),e.onPause(t.id,function(t){t?s.send("pause",{}):s.send("resume",{})}),e.onPauseAll(t.id,function(){return s.send("pause",{})}),e.onCancelAll(t.id,function(){return s.send("pause",{})}),e.onResumeAll(t.id,function(){t.error&&s.send("pause",{}),s.send("resume",{})}),e.onRetry(t.id,function(){s.send("pause",{}),s.send("resume",{})}),e.onRetryAll(t.id,function(){s.send("pause",{}),s.send("resume",{})}),t.isPaused&&s.send("pause",{}),s.on("progress",function(r){return et(e,r,t)}),s.on("error",function(r){var o=r.error.message,i=sa(new Error(o),{cause:r.error});e.opts.useFastRemoteRetry||(e.resetUploaderReferences(t.id),e.uppy.setFileState(t.id,{serverToken:null})),e.uppy.emit("upload-error",t,i),n(i)}),s.on("success",function(n){e.uppy.emit("upload-success",t,n,n.url),e.resetUploaderReferences(t.id),r()})})},e.prototype.onReceiveUploadUrl=function(t,e){var r=this.uppy.getFile(t.id);r&&(r.tus&&r.tus.uploadUrl===e||!this.opts.resume||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(r.id,{tus:sa({},r.tus,{uploadUrl:e})})))},e.prototype.onFileRemove=function(t,e){this.uploaderEvents[t].on("file-removed",function(r){t===r.id&&e(r.id)})},e.prototype.onPause=function(t,e){this.uploaderEvents[t].on("upload-pause",function(r,n){t===r&&e(n)})},e.prototype.onRetry=function(t,e){this.uploaderEvents[t].on("upload-retry",function(r){t===r&&e()})},e.prototype.onRetryAll=function(t,e){var r=this;this.uploaderEvents[t].on("retry-all",function(n){r.uppy.getFile(t)&&e()})},e.prototype.onPauseAll=function(t,e){var r=this;this.uploaderEvents[t].on("pause-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.onCancelAll=function(t,e){var r=this;this.uploaderEvents[t].on("cancel-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.onResumeAll=function(t,e){var r=this;this.uploaderEvents[t].on("resume-all",function(){r.uppy.getFile(t)&&e()})},e.prototype.uploadFiles=function(t){var e=this,r=t.map(function(r,n){var o=parseInt(n,10)+1,i=t.length;return r.error?function(){return Promise.reject(new Error(r.error))}:r.isRemote?(e.uppy.emit("upload-started",r),e.uploadRemote.bind(e,r,o,i)):(e.uppy.emit("upload-started",r),e.upload.bind(e,r,o,i))}).map(function(t){return e.limitUploads(t)()});return ht(r)},e.prototype.handleUpload=function(t){var e=this;if(0===t.length)return this.uppy.log("Tus: no files to upload!"),Promise.resolve();this.uppy.log("Tus is uploading...");var r=t.map(function(t){return e.uppy.getFile(t)});return this.uploadFiles(r).then(function(){return null})},e.prototype.install=function(){this.uppy.setState({capabilities:sa({},this.uppy.getState().capabilities,{resumableUploads:!0})}),this.uppy.addUploader(this.handleUpload),this.uppy.on("reset-progress",this.handleResetProgress),this.opts.autoRetry&&this.uppy.on("back-online",this.uppy.retryAll)},e.prototype.uninstall=function(){this.uppy.setState({capabilities:sa({},this.uppy.getState().capabilities,{resumableUploads:!1})}),this.uppy.removeUploader(this.handleUpload),this.opts.autoRetry&&this.uppy.off("back-online",this.uppy.retryAll)},e}(z.Plugin),da={},fa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};function ya(t,e){return{params:e.params,signature:e.signature,fields:e.fields}}var ga=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/uppy-server/;(da=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.type="uploader",o.id="Transloadit",o.title="Transloadit";var i={strings:{creatingAssembly:"Preparing upload...",creatingAssemblyFailed:"Transloadit: Could not create Assembly",encoding:"Encoding..."}},s={service:"https://api2.transloadit.com",waitForEncoding:!1,waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,signature:null,params:null,fields:{},getAssemblyOptions:ya,locale:i};return o.opts=fa({},s,n),o.locale=fa({},i,o.opts.locale),o.locale.strings=fa({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.prepareUpload=o.prepareUpload.bind(o),o.afterUpload=o.afterUpload.bind(o),o.handleError=o.handleError.bind(o),o.onFileUploadURLAvailable=o.onFileUploadURLAvailable.bind(o),o.onRestored=o.onRestored.bind(o),o.getPersistentData=o.getPersistentData.bind(o),o.opts.params&&o.validateParams(o.opts.params),o.client=new Kn({service:o.opts.service}),o.sockets={},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.validateParams=function(t){if(!t)throw new Error("Transloadit: The `params` option is required.");if("string"==typeof t)try{t=JSON.parse(t)}catch(t){throw t.message="Transloadit: The `params` option is a malformed JSON string: "+t.message,t}if(!t.auth||!t.auth.key)throw new Error("Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/accounts/credentials.")},e.prototype.getAssemblyOptions=function(t){var e=this,r=this.opts;return Promise.all(t.map(function(t){var n=e.uppy.getFile(t);return Promise.resolve().then(function(){return r.getAssemblyOptions(n,r)}).then(function(t){return function(t,e){if(Array.isArray(e.fields)){var r=e.fields;e.fields={},r.forEach(function(r){e.fields[r]=t.meta[r]})}return e.fields||(e.fields={}),e}(n,t)}).then(function(r){return e.validateParams(r.params),{fileIDs:[t],options:r}})}))},e.prototype.dedupeAssemblyOptions=function(t){var e=Object.create(null);return t.forEach(function(t){var r,n=t.fileIDs,o=t.options,i=JSON.stringify(o);e[i]?(r=e[i].fileIDs).push.apply(r,n):e[i]={options:o,fileIDs:[].concat(n)}}),Object.keys(e).map(function(t){return e[t]})},e.prototype.createAssembly=function(t,e,r){var n=this,o=this.opts;return this.uppy.log("[Transloadit] create Assembly"),this.client.createAssembly({params:r.params,fields:r.fields,expectedFiles:t.length,signature:r.signature}).then(function(r){var i,s,a=n.getPluginState(),l=a.uploadsAssemblies[e],u=fa({},a.uploadsAssemblies,((i={})[e]=l.concat([r.assembly_id]),i));n.setPluginState({assemblies:fa(a.assemblies,(s={},s[r.assembly_id]=r,s)),uploadsAssemblies:u});var p=fa({},n.uppy.getState().files);return t.forEach(function(t){p[t]=function(t,e){var r={assembly_url:e.assembly_url,filename:t.name,fieldname:"file"},n=fa({},t.meta,r),i=fa({},t.tus,{endpoint:e.tus_url}),s=t.remote;if(t.remote&&ga.test(t.remote.serverUrl)){var a=e.uppyserver_url,l=t.remote.url.replace(t.remote.serverUrl,"");a=a.replace(/\/$/,""),l=l.replace(/^\//,""),s=fa({},t.remote,{serverUrl:a,url:a+"/"+l})}var u={assembly:e.assembly_id},p=fa({},t,{transloadit:u});return o.importFromUploadURLs||fa(p,{meta:n,tus:i,remote:s}),p}(p[t],r)}),n.uppy.setState({files:p}),n.uppy.emit("transloadit:assembly-created",r,t),n.connectSocket(r).then(function(){return r})}).then(function(t){return n.uppy.log("[Transloadit] Created Assembly "+t.assembly_id),t}).catch(function(t){throw t.message=n.i18n("creatingAssemblyFailed")+": "+t.message,t})},e.prototype.shouldWait=function(){return this.opts.waitForEncoding||this.opts.waitForMetadata},e.prototype.reserveFiles=function(t,e){var r=this;return Promise.all(e.map(function(e){var n=r.uppy.getFile(e);return r.client.reserveFile(t,n)}))},e.prototype.onFileUploadURLAvailable=function(t){var e=this;if(t&&t.transloadit&&t.transloadit.assembly){var r=this.getPluginState().assemblies[t.transloadit.assembly];this.client.addFile(r,t).catch(function(n){e.uppy.log(n),e.uppy.emit("transloadit:import-error",r,t.id,n)})}},e.prototype.findFile=function(t){for(var e=this.uppy.getFiles(),r=0;r<e.length;r++){var n=e[r];if(n.uploadURL===t.tus_upload_url)return n;if(n.tus&&n.tus.uploadUrl===t.tus_upload_url)return n;if(!t.is_tus_file&&n.name===t.name&&n.size===t.size)return n}},e.prototype.onFileUploadComplete=function(t,e){var r,n=this.getPluginState(),o=this.findFile(e);o?(this.setPluginState({files:fa({},n.files,(r={},r[e.id]={assembly:t,id:o.id,uploadedFile:e},r))}),this.uppy.emit("transloadit:upload",e,this.getAssembly(t))):this.uppy.log("[Transloadit] Couldn\u2019t file the file, it was likely removed in the process")},e.prototype.onResult=function(t,e,r){var n=this.getPluginState(),o=n.files[r.original_id];r.localId=o?o.id:null;var i={result:r,stepName:e,id:r.id,assembly:t};this.setPluginState({results:[].concat(n.results,[i])}),this.uppy.emit("transloadit:result",e,r,this.getAssembly(t))},e.prototype.onAssemblyFinished=function(t){var e=this;this.client.getAssemblyStatus(t).then(function(t){var r,n=e.getPluginState();e.setPluginState({assemblies:fa({},n.assemblies,(r={},r[t.assembly_id]=t,r))}),e.uppy.emit("transloadit:complete",t)})},e.prototype.getPersistentData=function(t){var e,r=this.getPluginState(),n=r.assemblies,o=r.uploadsAssemblies,i=Object.keys(r.files),s=r.results.map(function(t){return t.id});t(((e={})[this.id]={assemblies:n,uploadsAssemblies:o,uploads:i,results:s},e))},e.prototype.emitEventsDiff=function(t){var e=this,r=this.opts,n=this.getPluginState();!function(){var o=Object.keys(n.files).filter(function(e){return!t.files.hasOwnProperty(e)}).map(function(t){return n.files[t]}),i=n.results.filter(function(e){return!t.results.some(function(t){return t.id===e.id})});e.uppy.log("[Transloadit] New fully uploaded files since restore:"),e.uppy.log(o),o.forEach(function(t){var r=t.assembly,n=t.uploadedFile;e.uppy.log("[Transloadit]  emitting transloadit:upload "+n.id),e.uppy.emit("transloadit:upload",n,e.getAssembly(r))}),e.uppy.log("[Transloadit] New results since restore:"),e.uppy.log(i),i.forEach(function(t){var r=t.assembly,n=t.stepName,o=t.result,i=t.id;e.uppy.log("[Transloadit]  emitting transloadit:result "+n+", "+i),e.uppy.emit("transloadit:result",n,o,e.getAssembly(r))});var s=n.assemblies,a=t.assemblies;e.uppy.log("[Transloadit] Current Assembly status after restore"),e.uppy.log(s),e.uppy.log("[Transloadit] Assembly status before restore"),e.uppy.log(a),Object.keys(s).forEach(function(t){var n,o,i=a[t];n=i,o=s[t],e.uppy.log("[Transloadit] Diff assemblies"),e.uppy.log(n),e.uppy.log(o),r.waitForEncoding&&"ASSEMBLY_COMPLETED"===o.ok&&"ASSEMBLY_COMPLETED"!==n.ok?(e.uppy.log("[Transloadit]  Emitting transloadit:complete for "+o.assembly_id),e.uppy.log(o),e.uppy.emit("transloadit:complete",o)):r.waitForMetadata&&o.upload_meta_data_extracted&&!n.upload_meta_data_extracted&&(e.uppy.log("[Transloadit]  Emitting transloadit:complete after metadata extraction for "+o.assembly_id),e.uppy.log(o),e.uppy.emit("transloadit:complete",o)),o.error&&!n.error&&(e.uppy.log("[Transloadit]  !!! Emitting transloadit:assembly-error for "+o.assembly_id),e.uppy.log(o),e.uppy.emit("transloadit:assembly-error",o,new Error(o.message)))})}()},e.prototype.onRestored=function(t){var e=this,r=t&&t[this.id]?t[this.id]:{},n=r.files||[],o=r.results||[],i=r.assemblies||{},s=r.uploadsAssemblies||{};0!==Object.keys(s).length&&(this.restored=Promise.resolve().then(function(){var t=[];return Object.keys(s).forEach(function(e){t.push.apply(t,s[e])}),Promise.all(t.map(function(t){var r="https://api2.transloadit.com/assemblies/"+t;return e.client.getAssemblyStatus(r)}))}).then(function(t){return function(t){var r={},n={},o=[];t.forEach(function(t){r[t.assembly_id]=t,t.uploads.forEach(function(r){var o=e.findFile(r);n[r.id]={id:o.id,assembly:t.assembly_id,uploadedFile:r}});var i=e.getPluginState();Object.keys(t.results).forEach(function(e){t.results[e].forEach(function(r){var n=i.files[r.original_id];r.localId=n?n.id:null,o.push({id:r.id,result:r,stepName:e,assembly:t.assembly_id})})})}),e.setPluginState({assemblies:r,files:n,results:o,uploadsAssemblies:s})}(t),function(t){return Promise.all(t.map(function(t){return"ASSEMBLY_COMPLETE"===t.ok?null:e.connectSocket(t)}))}(t)}).then(function(){var t=e.getPluginState(),r={};return n.forEach(function(e){r[e]=t.files[e]}),function(){return e.emitEventsDiff({assemblies:i,files:r,results:t.results.filter(function(t){var e=t.id;return-1!==o.indexOf(e)}),uploadsAssemblies:s})}}),this.restored.then(function(){e.restored=null}))},e.prototype.connectSocket=function(t){var e=this,r=new ks(t.websocket_url,t);return this.sockets[t.assembly_id]=r,r.on("upload",this.onFileUploadComplete.bind(this,t.assembly_id)),r.on("error",function(r){e.uppy.emit("transloadit:assembly-error",t,r)}),r.on("executing",function(){e.uppy.emit("transloadit:assembly-executing",t)}),this.opts.waitForEncoding&&r.on("result",this.onResult.bind(this,t.assembly_id)),this.opts.waitForEncoding?r.on("finished",function(){e.onAssemblyFinished(t.assembly_ssl_url)}):this.opts.waitForMetadata&&r.on("metadata",function(){e.onAssemblyFinished(t.assembly_ssl_url)}),new Promise(function(t,e){r.on("connect",t),r.on("error",e)}).then(function(){e.uppy.log("[Transloadit] Socket is ready")})},e.prototype.prepareUpload=function(t,e){var r,n=this;(t=t.filter(function(t){return!t.error})).forEach(function(t){var e=n.uppy.getFile(t);n.uppy.emit("preprocess-progress",e,{mode:"indeterminate",message:n.i18n("creatingAssembly")})});var o=function(t){var r=t.fileIDs,o=t.options;return n.createAssembly(r,e,o).then(function(t){if(n.opts.importFromUploadURLs)return n.reserveFiles(t,r)}).then(function(){r.forEach(function(t){var e=n.uppy.getFile(t);n.uppy.emit("preprocess-complete",e)})}).catch(function(t){throw r.forEach(function(e){var r=n.uppy.getFile(e);n.uppy.emit("preprocess-complete",r),n.uppy.emit("upload-error",r,t)}),t})},i=this.getPluginState(),s=fa({},i.uploadsAssemblies,((r={})[e]=[],r));this.setPluginState({uploadsAssemblies:s});var a=void 0;if(t.length>0)a=Promise.resolve(this.getAssemblyOptions(t)).then(function(t){return n.dedupeAssemblyOptions(t)});else{if(!this.opts.alwaysRunAssembly)return Promise.resolve();a=Promise.resolve(this.opts.getAssemblyOptions(null,this.opts)).then(function(e){return n.validateParams(e.params),[{fileIDs:t,options:e}]})}return a.then(function(t){return Promise.all(t.map(o))},function(e){throw t.forEach(function(t){var r=n.uppy.getFile(t);n.uppy.emit("preprocess-complete",r),n.uppy.emit("upload-error",r,e)}),e})},e.prototype.afterUpload=function(t,e){var r=this;t=t.filter(function(t){return!t.error});var n=this.getPluginState();if(this.restored)return this.restored.then(function(n){var o=r.afterUpload(t,e);return n(),o});var o=n.uploadsAssemblies[e];if(!this.shouldWait()){o.forEach(function(t){r.sockets[t].close()});var i=o.map(function(t){return r.getAssembly(t)});return this.uppy.addResultData(e,{transloadit:i}),Promise.resolve()}if(0===o.length)return this.uppy.addResultData(e,{transloadit:[]}),Promise.resolve();var s=0;return new Promise(function(n,i){t.forEach(function(t){var e=r.uppy.getFile(t);r.uppy.emit("postprocess-progress",e,{mode:"indeterminate",message:r.i18n("encoding")})});var a=function(t){-1!==o.indexOf(t.assembly_id)?(r.uppy.log("[Transloadit] afterUpload(): Got Assembly finish "+t.assembly_id),r.getAssemblyFiles(t.assembly_id).forEach(function(t){r.uppy.emit("postprocess-complete",t)}),p()):r.uppy.log("[Transloadit] afterUpload(): Ignoring finished Assembly "+t.assembly_id)},l=function(t,e){-1!==o.indexOf(t.assembly_id)?(r.uppy.log("[Transloadit] afterUpload(): Got Assembly error "+t.assembly_id),r.uppy.log(e),r.getAssemblyFiles(t.assembly_id).forEach(function(t){r.uppy.emit("upload-error",t,e),r.uppy.emit("postprocess-complete",t)}),p()):r.uppy.log("[Transloadit] afterUpload(): Ignoring errored Assembly "+t.assembly_id)},u=function(t,e,r){-1!==o.indexOf(t.assembly_id)&&l(t,r)},p=function(){if((s+=1)===o.length){c();var t=o.map(function(t){return r.getAssembly(t)});r.uppy.addResultData(e,{transloadit:t}),n()}},c=function(){r.uppy.off("transloadit:complete",a),r.uppy.off("transloadit:assembly-error",l),r.uppy.off("transloadit:import-error",u)};r.uppy.on("transloadit:complete",a),r.uppy.on("transloadit:assembly-error",l),r.uppy.on("transloadit:import-error",u)}).then(function(t){var n=r.getPluginState(),o=fa({},n.uploadsAssemblies);return delete o[e],r.setPluginState({uploadsAssemblies:o}),t})},e.prototype.handleError=function(t,e){var r=this;this.uppy.log("[Transloadit] handleError"),this.uppy.log(t),this.uppy.log(e),this.getPluginState().uploadsAssemblies[e].forEach(function(t){r.sockets[t]&&r.sockets[t].close()})},e.prototype.install=function(){this.uppy.addPreProcessor(this.prepareUpload),this.uppy.addPostProcessor(this.afterUpload),this.uppy.on("error",this.handleError),this.opts.importFromUploadURLs?this.uppy.on("upload-success",this.onFileUploadURLAvailable):this.uppy.use(ha,{resume:!1,useFastRemoteRetry:!1,metaFields:["assembly_url","filename","fieldname"]}),this.uppy.on("restore:get-data",this.getPersistentData),this.uppy.on("restored",this.onRestored),this.setPluginState({assemblies:{},uploadsAssemblies:{},files:{},results:[]})},e.prototype.uninstall=function(){this.uppy.removePreProcessor(this.prepareUpload),this.uppy.removePostProcessor(this.afterUpload),this.uppy.off("error",this.handleError),this.opts.importFromUploadURLs&&this.uppy.off("upload-success",this.onFileUploadURLAvailable)},e.prototype.getAssembly=function(t){return this.getPluginState().assemblies[t]},e.prototype.getAssemblyFiles=function(t){return this.uppy.getFiles().filter(function(e){return e&&e.transloadit&&e.transloadit.assembly===t})},e}(z.Plugin)).UPPY_SERVER="https://api2.transloadit.com/uppy-server";var ma=k.h,va=function(t){function e(r){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.handleKeyPress=n.handleKeyPress.bind(n),n.handleClick=n.handleClick.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this;this.input.value="",setTimeout(function(){t.input&&t.input.focus({preventScroll:!0})},150)},e.prototype.handleKeyPress=function(t){13===t.keyCode&&this.props.addFile(this.input.value)},e.prototype.handleClick=function(){this.props.addFile(this.input.value)},e.prototype.render=function(){var t=this;return ma("div",{class:"uppy-Url"},ma("input",{class:"uppy-c-textInput uppy-Url-input",type:"text",placeholder:this.props.i18n("enterUrlToImport"),onkeyup:this.handleKeyPress,ref:function(e){t.input=e}}),ma("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"button","aria-label":this.props.i18n("import"),onclick:this.handleClick},this.props.i18n("import")))},e}(k.Component),ba=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wa=z.Plugin,Sa=k.h,Pa=Z.RequestClient,ka=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.id=o.opts.id||"Url",o.title="Link",o.type="acquirer",o.icon=function(){return Sa("svg",{"aria-hidden":"true",class:"UppyIcon UppyModalTab-icon",width:"64",height:"64",viewBox:"0 0 64 64"},Sa("circle",{cx:"32",cy:"32",r:"31"}),Sa("g",{"fill-rule":"nonzero",fill:"#FFF"},Sa("path",{d:"M25.774 47.357a4.077 4.077 0 0 1-5.76 0L16.9 44.24a4.076 4.076 0 0 1 0-5.758l5.12-5.12-1.817-1.818-5.12 5.122a6.651 6.651 0 0 0 0 9.392l3.113 3.116a6.626 6.626 0 0 0 4.699 1.943c1.7 0 3.401-.649 4.697-1.943l10.241-10.243a6.591 6.591 0 0 0 1.947-4.696 6.599 6.599 0 0 0-1.947-4.696l-3.116-3.114-1.817 1.817 3.116 3.114a4.045 4.045 0 0 1 1.194 2.88 4.045 4.045 0 0 1-1.194 2.878L25.774 47.357z"}),Sa("path",{d:"M46.216 14.926a6.597 6.597 0 0 0-4.696-1.946h-.001a6.599 6.599 0 0 0-4.696 1.945L26.582 25.167a6.595 6.595 0 0 0-1.947 4.697 6.599 6.599 0 0 0 1.946 4.698l3.114 3.114 1.818-1.816-3.114-3.114a4.05 4.05 0 0 1-1.194-2.882c0-1.086.424-2.108 1.194-2.878L38.64 16.744a4.042 4.042 0 0 1 2.88-1.194c1.089 0 2.11.425 2.88 1.194l3.114 3.114a4.076 4.076 0 0 1 0 5.758l-5.12 5.12 1.818 1.817 5.12-5.122a6.649 6.649 0 0 0 0-9.393l-3.113-3.114-.003.002z"})))};var i={strings:{import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Uppy Server failed to fetch this URL, please make sure it\u2019s correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}},s={locale:i};if(o.opts=ba({},s,n),o.locale=ba({},i,o.opts.locale),o.locale.strings=ba({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.hostname=o.opts.serverUrl,!o.hostname)throw new Error("Uppy Server hostname is required, please consult https://uppy.io/docs/server");return o.getMeta=o.getMeta.bind(o),o.addFile=o.addFile.bind(o),o.handleDrop=o.handleDrop.bind(o),o.handleDragOver=o.handleDragOver.bind(o),o.handleDragLeave=o.handleDragLeave.bind(o),o.handlePaste=o.handlePaste.bind(o),o.client=new Pa(r,{serverUrl:o.opts.serverUrl,serverHeaders:o.opts.serverHeaders}),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getFileNameFromUrl=function(t){return t.substring(t.lastIndexOf("/")+1)},e.prototype.checkIfCorrectURL=function(t){if(!t)return!1;var e=t.match(/^([a-z0-9]+):\/\//)[1];return"http"===e||"https"===e},e.prototype.addProtocolToURL=function(t){return/^[a-z0-9]+:\/\//.test(t)?t:"http://"+t},e.prototype.getMeta=function(t){var e=this;return this.client.post("url/meta",{url:t}).then(function(t){if(t.error)throw e.uppy.log("[URL] Error:"),e.uppy.log(t.error),new Error("Failed to fetch the file");return t})},e.prototype.addFile=function(t){var e=this;return t=this.addProtocolToURL(t),this.checkIfCorrectURL(t)?this.getMeta(t).then(function(r){return{source:e.id,name:e.getFileNameFromUrl(t),type:r.type,data:{size:r.size},isRemote:!0,body:{url:t},remote:{serverUrl:e.opts.serverUrl,url:e.hostname+"/url/get",body:{fileId:t,url:t},providerOptions:e.client.opts}}}).then(function(t){e.uppy.log("[Url] Adding remote file");try{e.uppy.addFile(t)}catch(t){}}).then(function(){var t=e.uppy.getPlugin("Dashboard");t&&t.hideAllPanels()}).catch(function(t){e.uppy.log(t),e.uppy.info({message:e.i18n("failedToFetch"),details:t},"error",4e3)}):(this.uppy.log("[URL] Incorrect URL entered: "+t),void this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3))},e.prototype.handleDrop=function(t){var e=this;t.preventDefault(),t.dataTransfer.items&&tr(t.dataTransfer.items).forEach(function(t){"string"===t.kind&&"text/uri-list"===t.type&&t.getAsString(function(t){e.uppy.log("[URL] Adding file from dropped url: "+t),e.addFile(t)})})},e.prototype.handleDragOver=function(t){t.preventDefault(),this.el.classList.add("drag")},e.prototype.handleDragLeave=function(t){t.preventDefault(),this.el.classList.remove("drag")},e.prototype.handlePaste=function(t){var e=this;if(t.clipboardData.items){var r=tr(t.clipboardData.items);if(r.filter(function(t){return"file"===t.kind}).length>0)return;r.forEach(function(t){"string"===t.kind&&"text/plain"===t.type&&t.getAsString(function(t){e.uppy.log("[URL] Adding file from pasted url: "+t),e.addFile(t)})})}},e.prototype.render=function(t){return Sa(va,{i18n:this.i18n,addFile:this.addFile})},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this),this.el.addEventListener("drop",this.handleDrop),this.el.addEventListener("dragover",this.handleDragOver),this.el.addEventListener("dragleave",this.handleDragLeave),this.el.addEventListener("paste",this.handlePaste)},e.prototype.uninstall=function(){this.el.removeEventListener("drop",this.handleDrop),this.el.removeEventListener("dragover",this.handleDragOver),this.el.removeEventListener("dragleave",this.handleDragLeave),this.el.removeEventListener("paste",this.handlePaste),this.unmount()},e}(wa),_a={"video/ogg":"ogv","audio/ogg":"ogg","video/webm":"webm","audio/webm":"webm","video/mp4":"mp4","audio/mp3":"mp3"},Ea=k.h,Ca=function(t){return Ea("svg",{"aria-hidden":"true",class:"UppyIcon",width:"66",height:"55",viewBox:"0 0 66 55",xmlns:"http://www.w3.org/2000/svg"},Ea("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z","fill-rule":"evenodd"}))},Ua=k.h,Ta=k.h,Fa=k.h;function Oa(t,e){return-1!==t.indexOf(e)}var Aa=function(t){function e(){return function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){this.props.onFocus(),this.btnContainer.firstChild.focus()},e.prototype.componentWillUnmount=function(){this.props.onStop()},e.prototype.render=function(){var t,e,r,n=this,o=this.props.supportsRecording&&(Oa(this.props.modes,"video-only")||Oa(this.props.modes,"audio-only")||Oa(this.props.modes,"video-audio")),i=Oa(this.props.modes,"picture");return Fa("div",{class:"uppy uppy-Webcam-container"},Fa("div",{class:"uppy-Webcam-videoContainer"},Fa("video",{class:"uppy-Webcam-video  "+(this.props.mirror?"uppy-Webcam-video--mirrored":""),autoplay:!0,muted:!0,playsinline:!0,srcObject:this.props.src||""})),Fa("div",{class:"uppy-Webcam-buttonContainer",ref:function(t){n.btnContainer=t}},i?(t=this.props,e=t.onSnapshot,r=t.i18n,Ta("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:r("takePicture"),"aria-label":r("takePicture"),onclick:e},Ca())):null," ",o?function(t){var e=t.recording,r=t.onStartRecording,n=t.onStopRecording,o=t.i18n;return console.log("is recording",e),e?Ua("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:o("stopRecording"),"aria-label":o("stopRecording"),onclick:n},Ua("svg",{"aria-hidden":"true",class:"UppyIcon",width:"100",height:"100",viewBox:"0 0 100 100"},Ua("rect",{x:"15",y:"15",width:"70",height:"70"}))):Ua("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:o("startRecording"),"aria-label":o("startRecording"),onclick:r},Ua("svg",{"aria-hidden":"true",class:"UppyIcon",width:"100",height:"100",viewBox:"0 0 100 100"},Ua("circle",{cx:"50",cy:"50",r:"40"})))}(this.props):null))},e}(k.Component),xa=k.h,Ra=function(t){return xa("div",{class:"uppy-Webcam-permissons"},xa("div",{class:"uppy-Webcam-permissonsIcon"},t.icon()),xa("h1",{class:"uppy-Webcam-Title"},"Please allow access to your camera"),xa("p",null,"You have been prompted to allow camera access from this site.",xa("br",null),"In order to take pictures with your camera you must approve this request."))},Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ia=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ba=k.h,ja=function(t){function e(r,n){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));o.mediaDevices=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices;var t=navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return t?{getUserMedia:function(e){return new Promise(function(r,n){t.call(navigator,e,r,n)})}}:null}(),o.supportsUserMedia=!!o.mediaDevices,o.protocol=location.protocol.match(/https/i)?"https":"http",o.id=o.opts.id||"Webcam",o.title="Camera",o.type="acquirer",o.icon=Ca;var i={strings:{smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording"}},s={onBeforeSnapshot:function(){return Promise.resolve()},countdown:!1,locale:i,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,facingMode:"user"};return o.opts=Ia({},s,n),o.locale=Ia({},i,o.opts.locale),o.locale.strings=Ia({},i.strings,o.opts.locale.strings),o.translator=new I({locale:o.locale}),o.i18n=o.translator.translate.bind(o.translator),o.install=o.install.bind(o),o.setPluginState=o.setPluginState.bind(o),o.render=o.render.bind(o),o.start=o.start.bind(o),o.stop=o.stop.bind(o),o.takeSnapshot=o.takeSnapshot.bind(o),o.startRecording=o.startRecording.bind(o),o.stopRecording=o.stopRecording.bind(o),o.oneTwoThreeSmile=o.oneTwoThreeSmile.bind(o),o.focus=o.focus.bind(o),o.webcamActive=!1,o.opts.countdown&&(o.opts.onBeforeSnapshot=o.oneTwoThreeSmile),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.isSupported=function(){return!!this.mediaDevices},e.prototype.getConstraints=function(){return{audio:-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),video:!(-1===this.opts.modes.indexOf("video-audio")&&-1===this.opts.modes.indexOf("video-only")&&-1===this.opts.modes.indexOf("picture"))&&{facingMode:this.opts.facingMode}}},e.prototype.start=function(){var t=this;if(!this.isSupported())return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0;var e=this.getConstraints();return this.mediaDevices.getUserMedia(e).then(function(e){t.stream=e,t.setPluginState({cameraReady:!0})}).catch(function(e){t.setPluginState({cameraError:e})})},e.prototype.startRecording=function(){var t=this;this.recorder=new MediaRecorder(this.stream),this.recordingChunks=[],this.recorder.addEventListener("dataavailable",function(e){t.recordingChunks.push(e.data)}),this.recorder.start(),this.setPluginState({isRecording:!0})},e.prototype.stopRecording=function(){var t=this;return new Promise(function(e,r){t.recorder.addEventListener("stop",function(){e()}),t.recorder.stop()}).then(function(){return t.setPluginState({isRecording:!1}),t.getVideo()}).then(function(e){try{t.uppy.addFile(e)}catch(t){}}).then(function(){t.recordingChunks=null,t.recorder=null;var e=t.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},function(e){throw t.recordingChunks=null,t.recorder=null,e})},e.prototype.stop=function(){this.stream.getAudioTracks().forEach(function(t){t.stop()}),this.stream.getVideoTracks().forEach(function(t){t.stop()}),this.webcamActive=!1,this.stream=null},e.prototype.getVideoElement=function(){return this.el.querySelector(".uppy-Webcam-video")},e.prototype.oneTwoThreeSmile=function(){var t=this;return new Promise(function(e,r){var n=t.opts.countdown,o=setInterval(function(){if(!t.webcamActive)return clearInterval(o),t.captureInProgress=!1,r(new Error("Webcam is not active"));n>0?(t.uppy.info(n+"...","warning",800),n--):(clearInterval(o),t.uppy.info(t.i18n("smile"),"success",1500),setTimeout(function(){return e()},1500))},1e3)})},e.prototype.takeSnapshot=function(){var t=this;this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch(function(e){var r="object"===(void 0===e?"undefined":Da(e))?e.message:e;return t.uppy.info(r,"error",5e3),Promise.reject(new Error("onBeforeSnapshot: "+r))}).then(function(){return t.getImage()}).then(function(e){t.captureInProgress=!1;var r=t.uppy.getPlugin("Dashboard");r&&r.hideAllPanels();try{t.uppy.addFile(e)}catch(t){}},function(e){throw t.captureInProgress=!1,e}))},e.prototype.getImage=function(){var t=this,e=this.getVideoElement();if(!e)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));var r="webcam-"+Date.now()+".jpg",n=e.videoWidth,o=e.videoHeight,i=document.createElement("canvas");return i.width=n,i.height=o,i.getContext("2d").drawImage(e,0,0),function(t,e,r){return t.toBlob?new Promise(function(n){t.toBlob(n,e,r)}):Promise.resolve().then(function(){return Ke(t.toDataURL(e,r),{})})}(i,"image/jpeg").then(function(e){return{source:t.id,name:r,data:new File([e],r,{type:"image/jpeg"}),type:"image/jpeg"}})},e.prototype.getVideo=function(){var t=this.recordingChunks[0].type,e=function(t){return _a[t]||null}(t);if(!e)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'+t+'"'));var r="webcam-"+Date.now()+"."+e,n=new Blob(this.recordingChunks,{type:t}),o={source:this.id,name:r,data:new File([n],r,{type:t}),type:t};return Promise.resolve(o)},e.prototype.focus=function(){var t=this;this.opts.countdown||setTimeout(function(){t.uppy.info(t.i18n("smile"),"success",1500)},1e3)},e.prototype.render=function(t){this.webcamActive||this.start();var e=this.getPluginState();return e.cameraReady?Ba(Aa,Ia({},e,{onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,supportsRecording:"function"==typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"==typeof MediaRecorder.prototype.start,recording:e.isRecording,mirror:this.opts.mirror,src:this.stream})):Ba(Ra,{icon:Ca})},e.prototype.install=function(){this.setPluginState({cameraReady:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.stream&&this.stop(),this.unmount()},e}(z.Plugin),Ma={};return Ma.Core=z,Ma.server=Z,Ma.views={ProviderView:Br},Ma.DefaultStore=R,Ma.ReduxStore=Cn,Ma.Dashboard=or,Ma.DragDrop=lr,Ma.FileInput=Xr,Ma.Informer=Ue,Ma.ProgressBar=qn,Ma.StatusBar=Ge,Ma.Dropbox=zr,Ma.GoogleDrive=Rn,Ma.Instagram=Mn,Ma.Url=ka,Ma.Webcam=ja,Ma.AwsS3=_t,Ma.AwsS3Multipart=pt,Ma.Transloadit=da,Ma.Tus=ha,Ma.XHRUpload=mt,Ma.Form=sn,Ma.GoldenRetriever=Tn,Ma.ReduxDevTools=Wn,Ma.ThumbnailGenerator=$e,Ma});
//# sourceMappingURL=uppy.min.js.map