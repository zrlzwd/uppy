




<!DOCTYPE html>
<html lang="en">
  <head>
    <title>XHR Upload — Uppy File Uploader</title>
    <meta charset="utf-8">
    <meta name="title" content="XHR Upload — Uppy File Uploader">
    <meta name="description" content="Sleek, modular file uploader that integrates seamlessly with any framework. It fetches files from local disk, Google Drive, Dropbox, Instagram, remote URLs, cameras and other exciting locations, and then uploads them to the final destination. It’s fast, easy to use and let&#39;s you worry about more important problems than building a file uploader.
">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@uppy_io">
    <meta name="twitter:creator" content="@uppy_io">
    <meta property="og:url" content="https://uppy.io/docs/xhr-upload/index.html">
    <meta property="og:title" content="XHR Upload — Uppy File Uploader">
    <meta name="twitter:title" content="XHR Upload — Uppy File Uploader">
    <meta name="twitter:description" content="Sleek, modular file uploader that integrates seamlessly with any framework. It fetches files from local disk, Google Drive, Dropbox, Instagram, remote URLs, cameras and other exciting locations, and then uploads them to the final destination. It’s fast, easy to use and let's you worry about more important problems than building a file uploader.
">
    <meta property="og:image" content="http://uppy.io/images/uppy-social.jpg">
    <meta name="twitter:image" content="http://uppy.io/images/uppy-social.jpg">

    <link rel="icon" href="/images/logos/uppy-dog-head-arrow.png" type="image/x-icon">
    <link rel="alternate" type="application/rss+xml" title="Uppy File Uploader" href="/atom.xml">

    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto+Mono" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Poiret+One:400" rel="stylesheet">
    <script>
      window.PAGE_TYPE = "docs"
    </script>
    <link rel="stylesheet" href="/css/main.css">
  </head>
  <body class="page-inner">
    <div class="page">
      <header id="header" class="MainHeader js-MainHeader">
        <button class="MainHeader-menuBtn js-MenuBtn"></button>

        <a id="logo" class="MainLogo" href="/">
          <img class="MainLogo-img" src="/images/logos/uppy-dog-head-arrow.svg">
          <span class="MainLogo-text">Uppy File Uploader</span>
        </a>

        <nav>
          <ul id="nav" class="MainMenu">
            <!-- @todo uncomment search input when we get our own swifttype -->
<!-- <li>
  <form id="search-form" class="MainMenu-search">
    <input type="text" id="search-query" class="MainMenu-searchQuery st-default-search-input">
  </form>
</li> -->
<!--li><a href="/guide/" class="nav-link">Guide</a></li-->
<li><a href="/docs/" class="nav-link current">Docs</a></li>
<li><a href="/examples/dashboard/" class="nav-link">Examples</a></li>
<!--li><a href="/stats/" class="nav-link">Stats</a></li-->
<li><a href="/blog/" class="nav-link">Blog</a></li>
<li><a href="https://github.com/transloadit/uppy" class="nav-link">Github</a></li>

          </ul>
        </nav>

        <a href="https://github.com/transloadit/uppy" class="github-corner" aria-label="View source on Github"><svg width="67" height="67" viewBox="0 0 250 250" style="fill:#e02177; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
      </header>

      <main class="MainContent js-MainContent" id="main">
        
          
    
<div class="Sidebar js-Sidebar">
  <ul class="main-menu">
    <!-- @todo uncomment search input when we get our own swifttype -->
<!-- <li>
  <form id="search-form" class="MainMenu-search">
    <input type="text" id="search-query" class="MainMenu-searchQuery st-default-search-input">
  </form>
</li> -->
<!--li><a href="/guide/" class="nav-link">Guide</a></li-->
<li><a href="/docs/" class="nav-link current">Docs</a></li>
<li><a href="/examples/dashboard/" class="nav-link">Examples</a></li>
<!--li><a href="/stats/" class="nav-link">Stats</a></li-->
<li><a href="/blog/" class="nav-link">Blog</a></li>
<li><a href="https://github.com/transloadit/uppy" class="nav-link">Github</a></li>

  </ul>
  <div class="list">
    <h2>
      
        <a href="/docs">Docs</a>
      
    </h2>
    <ul class="menu-root">
      
        
        
        
        
          <li>
            <a href="/docs/" class="sidebar-link">Getting Started</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/uppy/" class="sidebar-link">Uppy</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/server/" class="sidebar-link">Uppy Server</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/stores/" class="sidebar-link">Custom Stores</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/contributing.html" class="sidebar-link">Contributing</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/stats/" class="sidebar-link">Stats</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3><a href="/docs/plugins/">Plugins</a></h3>
            
          </li>
          <li>
            <a href="/docs/plugins/" class="sidebar-link">List & Common Options</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/writing-plugins/" class="sidebar-link">Writing Plugins</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3>Local Sources</h3>
            
          </li>
          <li>
            <a href="/docs/dashboard/" class="sidebar-link">Dashboard</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/drag-drop/" class="sidebar-link">Drag & Drop</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/file-input/" class="sidebar-link">File Input</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/webcam/" class="sidebar-link">Webcam</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3><a href="/docs/providers/">Remote Providers</a></h3>
            
          </li>
          <li>
            <a href="/docs/providers/" class="sidebar-link">Provider Plugins</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/dropbox/" class="sidebar-link">Dropbox</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/google-drive/" class="sidebar-link">Google Drive</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/instagram/" class="sidebar-link">Instagram</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/url/" class="sidebar-link">Import From URL</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3>Uploaders</h3>
            
          </li>
          <li>
            <a href="/docs/tus/" class="sidebar-link">Tus</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/xhr-upload/" class="sidebar-link current">XHR Upload</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/aws-s3/" class="sidebar-link">AWS S3</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/aws-s3-multipart/" class="sidebar-link">AWS S3 Multipart</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3>UI Elements</h3>
            
          </li>
          <li>
            <a href="/docs/status-bar/" class="sidebar-link">Status Bar</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/progress-bar/" class="sidebar-link">Progress Bar</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/informer/" class="sidebar-link">Informer</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3>File Processing</h3>
            
          </li>
          <li>
            <a href="/docs/transloadit/" class="sidebar-link">Transloadit</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3>Miscellaneous</h3>
            
          </li>
          <li>
            <a href="/docs/form/" class="sidebar-link">Form</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/golden-retriever/" class="sidebar-link">Golden Retriever</a>
          </li>
        
      
        
        
        
        
          <li>
            
              <h3><a href="/docs/react/">React Components</a></h3>
            
          </li>
          <li>
            <a href="/docs/react/" class="sidebar-link">Introduction</a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/react/status-bar/" class="sidebar-link">&lt;StatusBar /></a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/react/drag-drop/" class="sidebar-link">&lt;DragDrop /></a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/react/progress-bar/" class="sidebar-link">&lt;ProgressBar /></a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/react/dashboard/" class="sidebar-link">&lt;Dashboard /></a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/react/dashboard-modal/" class="sidebar-link">&lt;DashboardModal /></a>
          </li>
        
      
        
        
        
        
          <li>
            <a href="/docs/redux.html" class="sidebar-link">Redux</a>
          </li>
        
      
    </ul>
    <ul class="Social">
  <li><a href="https://twitter.com/uppy_io" class="twitter-follow-button" data-show-count="false" data-dnt="true">Follow @uppy_io</a></li>
  <li><iframe src="https://ghbtns.com/github-btn.html?user=transloadit&repo=uppy&type=watch&count=true"
allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe></li>
  <!-- to regenerate you can use this link: https://img.shields.io/badge/community-forum-d8006a.svg -->
  <li><a href="https://community.transloadit.com/c/uppy"><img src="/images/community-forum-d8006a.svg" /> </a></li>
  <li class="BuildBadge">
   <span class="wrapper">
     <a href="https://travis-ci.org/transloadit/uppy"><img src="https://travis-ci.org/transloadit/uppy.svg?branch=master" alt="Build Status"></a>
   </span>
  </li>
  <li class="SauceBadge">
   <span class="wrapper">
     <a href="https://saucelabs.com/u/transloadit-uppy">
       <img src="https://saucelabs.com/buildstatus/transloadit-uppy" alt="Sauce Test Status"/>
     </a>
   </span>
  </li>
</ul>

  </div>
</div>


<div class="Content js-Content docs with-sidebar">
    <h1>XHR Upload</h1>
    <p>The <code>@uppy/xhr-upload</code> plugin handles classic HTML multipart form uploads, as well as uploads using the HTTP <code>PUT</code> method.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="token keyword">const</span> XHRUpload <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@uppy/xhr-upload'</span><span class="token punctuation">)</span>

uppy<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>XHRUpload<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  endpoint<span class="token punctuation">:</span> <span class="token string">'http://my-website.org/upload'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<p><a href="/examples/xhrupload/">Try it live</a></p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>This plugin is published as the <code>@uppy/xhr-upload</code> package.</p>
<p>Install from NPM:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre>npm install @uppy/xhr-upload
</pre></td></tr></table></figure>
<p>In the <a href="/docs/#With-a-script-tag">CDN package</a>, it is available on the <code>Uppy</code> global object:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="token keyword">const</span> XHRUpload <span class="token operator">=</span> Uppy<span class="token punctuation">.</span>XHRUpload
</pre></td></tr></table></figure>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><p>The XHRUpload plugin has the following configurable options:</p>
<h3 id="id-39-XHRUpload-39"><a href="#id-39-XHRUpload-39" class="headerlink" title="id: &#39;XHRUpload&#39;"></a><code>id: &#39;XHRUpload&#39;</code></h3><p>A unique identifier for this plugin. It defaults to <code>&#39;XHRUpload&#39;</code>.</p>
<h3 id="endpoint-39-39"><a href="#endpoint-39-39" class="headerlink" title="endpoint: &#39;&#39;"></a><code>endpoint: &#39;&#39;</code></h3><p>The destination URL for your uploads.</p>
<h3 id="method-39-post-39"><a href="#method-39-post-39" class="headerlink" title="method: &#39;post&#39;"></a><code>method: &#39;post&#39;</code></h3><p>Configures which HTTP method to use for the upload.</p>
<h3 id="formData-true"><a href="#formData-true" class="headerlink" title="formData: true"></a><code>formData: true</code></h3><p>Configures whether or not to use a multipart form upload, using <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData" target="_blank" rel="noopener">FormData</a>.<br>This works similarly to using a <code>&lt;form&gt;</code> element with an <code>&lt;input type=&quot;file&quot;&gt;</code> for uploads.<br>When set to <code>true</code>, file metadata is also sent to the endpoint as separate form fields.<br>When set to <code>false</code>, only the file contents are sent.</p>
<h3 id="fieldName-39-files-39"><a href="#fieldName-39-files-39" class="headerlink" title="fieldName: &#39;files[]&#39;"></a><code>fieldName: &#39;files[]&#39;</code></h3><p>When <code>formData</code> is set to true, this is used as the form field name for the file to be uploaded.</p>
<h3 id="metaFields-null"><a href="#metaFields-null" class="headerlink" title="metaFields: null"></a><code>metaFields: null</code></h3><p>Pass an array of field names to limit the metadata fields that will be sent to the endpoint as form fields.<br>For example, <code>metaFields: [&#39;name&#39;]</code> will only send the <code>name</code> field.<br>Setting this to <code>null</code> (the default) will send <em>all</em> metadata fields.</p>
<p>If the <code>formData</code> option is set to false, <code>metaFields</code> has no effect.</p>
<h3 id="headers"><a href="#headers" class="headerlink" title="headers: {}"></a><code>headers: {}</code></h3><p>An object containing HTTP headers to use for the upload request.<br>Keys are header names, values are header values.</p>
<figure class="highlight js"><table><tr><td class="code"><pre>headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">'authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span><span class="token function">getCurrentUserToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
<span class="token punctuation">}</span>
</pre></td></tr></table></figure>
<h3 id="bundle-false"><a href="#bundle-false" class="headerlink" title="bundle: false"></a><code>bundle: false</code></h3><p>Send all files in a single multipart request. When <code>bundle</code> is set to <code>true</code>, <code>formData</code> must also be set to <code>true</code>.</p>
<blockquote>
<p>Note: When <code>bundle</code> is set to <code>true</code>, file metadata is <strong>not</strong> sent to the endpoint. This is because it is not obvious how metadata should be sent when there are multiple files in a single request. If you need this, please open an issue and we will try to figure it out together.</p>
</blockquote>
<p>All files will be appended to the provided <code>fieldName</code> field in the request. To upload files on different fields, use <a href="/docs/uppy#uppy-setFileState-fileID-state"><code>uppy.setFileState()</code></a> to set the <code>xhrUpload.fieldName</code> property on the file:</p>
<figure class="highlight js"><table><tr><td class="code"><pre>uppy<span class="token punctuation">.</span><span class="token function">setFileState</span><span class="token punctuation">(</span>fileID<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  xhrUpload<span class="token punctuation">:</span> <span class="token punctuation">{</span> fieldName<span class="token punctuation">:</span> <span class="token string">'pic0'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
uppy<span class="token punctuation">.</span><span class="token function">setFileState</span><span class="token punctuation">(</span>otherFileID<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  xhrUpload<span class="token punctuation">:</span> <span class="token punctuation">{</span> fieldName<span class="token punctuation">:</span> <span class="token string">'pic1'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<h3 id="getResponseData-responseText-response"><a href="#getResponseData-responseText-response" class="headerlink" title="getResponseData(responseText, response)"></a><code>getResponseData(responseText, response)</code></h3><p>When an upload has completed, Uppy will extract response data from the upload endpoint. This response data will be available on the file’s <code>.response</code> property, and be emitted in the <code>upload-success</code> event:</p>
<figure class="highlight js"><table><tr><td class="code"><pre>uppy<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span><span class="token punctuation">.</span>response
<span class="token comment">// { status: HTTP status code,</span>
<span class="token comment">//   body: extracted response data }</span>

uppy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'upload-success'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>file<span class="token punctuation">,</span> body<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// do something with extracted response data</span>
  <span class="token comment">// (`body` is equivalent to `file.response.body` or `uppy.getFile(fileID).response.body`)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<p>By default, Uppy assumes the endpoint will return JSON. So, if <code>POST /upload</code> responds with:</p>
<figure class="highlight json"><table><tr><td class="code"><pre>{
  "url": "https://public.url/to/file",
  "whatever": "beep boop"
}
</pre></td></tr></table></figure>
<p>That object will be emitted in the <code>upload-success</code> event. Not all endpoints respond with JSON. Providing a <code>getResponseData</code> function overrides this behavior. The <code>response</code> parameter is the <code>XMLHttpRequest</code> instance used to upload the file.</p>
<p>For example, an endpoint that responds with an XML document:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="token function">getResponseData</span> <span class="token punctuation">(</span>responseText<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> responseText<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/&lt;Location>(.*?)&lt;\/Location>/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></td></tr></table></figure>
<p>The <code>responseText</code> is the XHR endpoint response as a string. For uploads from the user’s device, <code>response</code> is the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener">XMLHttpRequest</a> object.</p>
<p>When uploading files from remote providers such as Dropbox or Instagram, Uppy Server sends upload response data to the client. This is made available in the <code>getResponseData()</code> function as well. The <code>response</code> object from Uppy Server contains some properties named after their <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener">XMLHttpRequest</a> counterparts:</p>
<ul>
<li><code>response.responseText</code> - the XHR endpoint response as a string;</li>
<li><code>response.status</code> - the HTTP status code;</li>
<li><code>response.statusText</code> - the HTTP status text;</li>
<li><code>response.headers</code> - an object mapping lowercase header names to their values.</li>
</ul>
<h3 id="getResponseError-responseText-response"><a href="#getResponseError-responseText-response" class="headerlink" title="getResponseError(responseText, response)"></a><code>getResponseError(responseText, response)</code></h3><p>If the upload endpoint responds with a non-2xx status code, the upload is assumed to have failed. The endpoint might have responded with some information about the error, though.</p>
<p>Pass in a <code>getResponseError</code> function to extract error data from the <code>XMLHttpRequest</code> instance used for the upload.</p>
<p>For example, if the endpoint responds with a JSON object containing a <code>{ message }</code> property, this would show that message to the user:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="token function">getResponseError</span> <span class="token punctuation">(</span>responseText<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>responseText<span class="token punctuation">)</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre></td></tr></table></figure>
<h3 id="responseUrlFieldName-39-url-39"><a href="#responseUrlFieldName-39-url-39" class="headerlink" title="responseUrlFieldName: &#39;url&#39;"></a><code>responseUrlFieldName: &#39;url&#39;</code></h3><p>The field name containing a publically accessible location of the uploaded file in the response data returned by <code>getResponseData(xhr.responseText, xhr)</code>.</p>
<h3 id="timeout-30-1000"><a href="#timeout-30-1000" class="headerlink" title="timeout: 30 * 1000"></a><code>timeout: 30 * 1000</code></h3><p>When no upload progress events have been received for this amount of milliseconds, assume the connection has an issue and abort the upload.<br>Note that unlike the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout" target="_blank" rel="noopener"><code>XMLHttpRequest.timeout</code></a> property, this is a timer between progress events: the total upload can take longer than this value.<br>Set to <code>0</code> to disable this check.</p>
<p>The default for the timeout is 30 seconds.</p>
<h3 id="limit-0"><a href="#limit-0" class="headerlink" title="limit: 0"></a><code>limit: 0</code></h3><p>Limit the amount of uploads going on at the same time. Setting this to <code>0</code> means there is no limit on concurrent uploads.</p>
<h3 id="withCredentials-false"><a href="#withCredentials-false" class="headerlink" title="withCredentials: false"></a><code>withCredentials: false</code></h3><p>Indicates whether or not cross-site Access-Control requests should be made using credentials.</p>
<h3 id="locale"><a href="#locale" class="headerlink" title="locale: {}"></a><code>locale: {}</code></h3><p>Localize text that is shown to the user.</p>
<p>The default English strings are:</p>
<figure class="highlight js"><table><tr><td class="code"><pre>strings<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// Shown in the Informer if an upload is being canceled because it stalled for too long.</span>
  timedOut<span class="token punctuation">:</span> <span class="token string">'Upload stalled for %{seconds} seconds, aborting.'</span>
<span class="token punctuation">}</span>
</pre></td></tr></table></figure>
<h2 id="POST-Parameters-Form-Fields"><a href="#POST-Parameters-Form-Fields" class="headerlink" title="POST Parameters / Form Fields"></a>POST Parameters / Form Fields</h2><p>When using XHRUpload with <code>formData: true</code>, file metadata is sent along with each upload request. You can set metadata for a file using <a href="/docs/uppy#uppy-setFileMeta-fileID-data"><code>uppy.setFileMeta(fileID, data)</code></a>, or for all files simultaneously using <a href="/docs/uppy#uppy-setMeta-data"><code>uppy.setMeta(data)</code></a>.</p>
<p>It may be useful to set metadata depending on some file properties, such as the size. You can use the <a href="/docs/uppy/#file-added"><code>file-added</code></a> event and  the <a href="/docs/uppy#uppy-setFileMeta-fileID-data"><code>uppy.setFileMeta(fileID, data)</code></a> method to do this:</p>
<figure class="highlight js"><table><tr><td class="code"><pre>uppy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'file-added'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  uppy<span class="token punctuation">.</span><span class="token function">setFileMeta</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> file<span class="token punctuation">.</span>size
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<p>Now, a form field named <code>size</code> will be sent along to the <a href="#endpoint-39-39"><code>endpoint</code></a> once the upload starts.</p>
<p>By default, all metadata is sent, including Uppy’s default <code>name</code> and <code>type</code> metadata. If you do not want the <code>name</code> and <code>type</code> metadata properties to be sent to your upload endpoint, you can use the <a href="#metaFields-null"><code>metaFields</code></a> option to restrict the field names that should be sent.</p>
<figure class="highlight js"><table><tr><td class="code"><pre>uppy<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>XHRUpload<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// Only send our own `size` metadata field.</span>
  metaFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'size'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<h2 id="Uploading-to-a-PHP-Server"><a href="#Uploading-to-a-PHP-Server" class="headerlink" title="Uploading to a PHP Server"></a>Uploading to a PHP Server</h2><p>The XHRUpload plugin works similarly to a <code>&lt;form&gt;</code> upload. You can use the <code>$_FILES</code> variable on the server to work with uploaded files. See the PHP documentation on <a href="https://secure.php.net/manual/en/features.file-upload.php" target="_blank" rel="noopener">Handling file uploads</a>.</p>
<p>The default form field for file uploads is <code>files[]</code>, which means you have to access the <code>$_FILES</code> array as described in <a href="https://secure.php.net/manual/en/features.file-upload.multiple.php" target="_blank" rel="noopener">Uploading multiple files</a>:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><?php
// upload.php
$files = $_FILES['files'];
$file_path = $files['tmp_name'][0]; // temporary upload path of the first file
$file_name = $_POST['name']; // desired name of the file
move_uploaded_file($file_path, './img/' . basename($file_name)); // save the file in `img/`
</pre></td></tr></table></figure>
<p>Note how we are using <code>$_POST[&#39;name&#39;]</code> instead of <code>$my_file[&#39;name&#39;]</code>. <code>$my_file[&#39;name&#39;]</code> contains the original name of the file on the user’s device. <code>$_POST[&#39;name&#39;]</code> contains the <code>name</code> metadata value for the uploaded file, which can be edited by the user using the <a href="/docs/dashboard">Dashboard</a>.</p>
<p>Set a custom <code>fieldName</code> to make working with the <code>$_FILES</code> array a bit less convoluted:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="token comment">// app.js</span>
uppy<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>XHRUpload<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  endpoint<span class="token punctuation">:</span> <span class="token string">'/upload.php'</span><span class="token punctuation">,</span>
  fieldName<span class="token punctuation">:</span> <span class="token string">'my_file'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><?php
// upload.php
$my_file = $_FILES['my_file'];
$file_path = $my_file['tmp_name']; // temporary upload path of the file
$file_name = $_POST['name']; // desired name of the file
move_uploaded_file($file_path, './img/' . basename($file_name)); // save the file at `img/FILE_NAME`
</pre></td></tr></table></figure>

    
    <div class="footer">Caught a mistake or want to contribute to the documentation?
       <a href="https://github.com/transloadit/uppy/blob/master/website/src/docs/xhrupload.md" rel="noreferrer noopener" target="_blank">Edit/fork this page directly on Github</a>!
    </div>
</div>

        
      </main>

      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63083-12', 'uppy.io');
  ga('send', 'pageview');
</script>


      
        <script src="/js/smooth-scroll.min.js"></script>
      
      <script src="/js/common.js"></script>

      <!-- Twitter follow button script -->
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

      <!--script src="//ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
      <script>
        WebFont.load({
          google: {
            families: ['Source Sans Pro:400,600', 'Roboto Mono', 'Poiret One:400']
          }
        });
      </script-->
    </div>
  </body>
</html>
